Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,247 | train size = 997 | val size = 250 | test size = 311
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = 0.027254
Epoch 1
Validation r2 = 0.060030
Epoch 2
Validation r2 = -0.060163
Epoch 3
Validation r2 = -0.003044
Epoch 4
Validation r2 = 0.128891
Epoch 5
Validation r2 = 0.140251
Epoch 6
Validation r2 = 0.031499
Epoch 7
Validation r2 = 0.228431
Epoch 8
Validation r2 = 0.232893
Epoch 9
Validation r2 = 0.198567
Epoch 10
Validation r2 = 0.327972
Epoch 11
Validation r2 = 0.380660
Epoch 12
Validation r2 = 0.457700
Epoch 13
Validation r2 = 0.425534
Epoch 14
Validation r2 = 0.466539
Epoch 15
Validation r2 = 0.493342
Epoch 16
Validation r2 = 0.459451
Epoch 17
Validation r2 = 0.542623
Epoch 18
Validation r2 = 0.544796
Epoch 19
Validation r2 = 0.556274
Epoch 20
Validation r2 = 0.536842
Epoch 21
Validation r2 = 0.538471
Epoch 22
Validation r2 = 0.574132
Epoch 23
Validation r2 = 0.545246
Epoch 24
Validation r2 = 0.507405
Epoch 25
Validation r2 = 0.511974
Epoch 26
Validation r2 = 0.513781
Epoch 27
Validation r2 = 0.563680
Epoch 28
Validation r2 = 0.520075
Epoch 29
Validation r2 = 0.548598
Epoch 30
Validation r2 = 0.595274
Epoch 31
Validation r2 = 0.616140
Epoch 32
Validation r2 = 0.593185
Epoch 33
Validation r2 = 0.594640
Epoch 34
Validation r2 = 0.558120
Epoch 35
Validation r2 = 0.580825
Epoch 36
Validation r2 = 0.578514
Epoch 37
Validation r2 = 0.600011
Epoch 38
Validation r2 = 0.622259
Epoch 39
Validation r2 = 0.637042
Epoch 40
Validation r2 = 0.601270
Epoch 41
Validation r2 = 0.615836
Epoch 42
Validation r2 = 0.544908
Epoch 43
Validation r2 = 0.552402
Epoch 44
Validation r2 = 0.610983
Epoch 45
Validation r2 = 0.642595
Epoch 46
Validation r2 = 0.625884
Epoch 47
Validation r2 = 0.659667
Epoch 48
Validation r2 = 0.638587
Epoch 49
Validation r2 = 0.651377
Epoch 50
Validation r2 = 0.682520
Epoch 51
Validation r2 = 0.653719
Epoch 52
Validation r2 = 0.664750
Epoch 53
Validation r2 = 0.668121
Epoch 54
Validation r2 = 0.648831
Epoch 55
Validation r2 = 0.666610
Epoch 56
Validation r2 = 0.664976
Epoch 57
Validation r2 = 0.672627
Epoch 58
Validation r2 = 0.674207
Epoch 59
Validation r2 = 0.673467
Epoch 60
Validation r2 = 0.655489
Epoch 61
Validation r2 = 0.686661
Epoch 62
Validation r2 = 0.671702
Epoch 63
Validation r2 = 0.658704
Epoch 64
Validation r2 = 0.681208
Epoch 65
Validation r2 = 0.670672
Epoch 66
Validation r2 = 0.702199
Epoch 67
Validation r2 = 0.667880
Epoch 68
Validation r2 = 0.682684
Epoch 69
Validation r2 = 0.667686
Epoch 70
Validation r2 = 0.666844
Epoch 71
Validation r2 = 0.684238
Epoch 72
Validation r2 = 0.672307
Epoch 73
Validation r2 = 0.688198
Epoch 74
Validation r2 = 0.672288
Epoch 75
Validation r2 = 0.675700
Epoch 76
Validation r2 = 0.678492
Epoch 77
Validation r2 = 0.676638
Epoch 78
Validation r2 = 0.668929
Epoch 79
Validation r2 = 0.662261
Epoch 80
Validation r2 = 0.667116
Epoch 81
Validation r2 = 0.677067
Epoch 82
Validation r2 = 0.658582
Epoch 83
Validation r2 = 0.654219
Epoch 84
Validation r2 = 0.663982
Epoch 85
Validation r2 = 0.652686
Epoch 86
Validation r2 = 0.674877
Epoch 87
Validation r2 = 0.662407
Epoch 88
Validation r2 = 0.677190
Epoch 89
Validation r2 = 0.653839
Epoch 90
Validation r2 = 0.667635
Epoch 91
Validation r2 = 0.664961
Epoch 92
Validation r2 = 0.666086
Epoch 93
Validation r2 = 0.641987
Epoch 94
Validation r2 = 0.668384
Epoch 95
Validation r2 = 0.653474
Epoch 96
Validation r2 = 0.661112
Epoch 97
Validation r2 = 0.651321
Epoch 98
Validation r2 = 0.653621
Epoch 99
Validation r2 = 0.626344
Model 0 best validation r2 = 0.702199 on epoch 66
Moving model to cuda
Model 0 test mae = 0.401819
Model 0 test mse = 0.371989
Model 0 test r2 = 0.669999
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.025544
Epoch 1
Validation r2 = -0.065491
Epoch 2
Validation r2 = 0.009601
Epoch 3
Validation r2 = 0.035670
Epoch 4
Validation r2 = 0.015636
Epoch 5
Validation r2 = 0.043220
Epoch 6
Validation r2 = 0.136512
Epoch 7
Validation r2 = 0.071751
Epoch 8
Validation r2 = 0.157211
Epoch 9
Validation r2 = 0.280192
Epoch 10
Validation r2 = 0.290887
Epoch 11
Validation r2 = 0.286581
Epoch 12
Validation r2 = 0.395683
Epoch 13
Validation r2 = 0.433699
Epoch 14
Validation r2 = 0.248359
Epoch 15
Validation r2 = 0.465725
Epoch 16
Validation r2 = 0.380375
Epoch 17
Validation r2 = 0.511826
Epoch 18
Validation r2 = 0.517205
Epoch 19
Validation r2 = 0.522336
Epoch 20
Validation r2 = 0.505327
Epoch 21
Validation r2 = 0.552037
Epoch 22
Validation r2 = 0.557801
Epoch 23
Validation r2 = 0.566517
Epoch 24
Validation r2 = 0.583934
Epoch 25
Validation r2 = 0.589274
Epoch 26
Validation r2 = 0.590335
Epoch 27
Validation r2 = 0.621911
Epoch 28
Validation r2 = 0.553652
Epoch 29
Validation r2 = 0.602495
Epoch 30
Validation r2 = 0.594212
Epoch 31
Validation r2 = 0.592309
Epoch 32
Validation r2 = 0.637429
Epoch 33
Validation r2 = 0.604731
Epoch 34
Validation r2 = 0.596115
Epoch 35
Validation r2 = 0.630132
Epoch 36
Validation r2 = 0.621278
Epoch 37
Validation r2 = 0.621023
Epoch 38
Validation r2 = 0.650386
Epoch 39
Validation r2 = 0.619489
Epoch 40
Validation r2 = 0.632031
Epoch 41
Validation r2 = 0.639349
Epoch 42
Validation r2 = 0.650529
Epoch 43
Validation r2 = 0.636732
Epoch 44
Validation r2 = 0.647260
Epoch 45
Validation r2 = 0.662329
Epoch 46
Validation r2 = 0.637155
Epoch 47
Validation r2 = 0.636003
Epoch 48
Validation r2 = 0.653089
Epoch 49
Validation r2 = 0.659970
Epoch 50
Validation r2 = 0.655172
Epoch 51
Validation r2 = 0.649017
Epoch 52
Validation r2 = 0.649235
Epoch 53
Validation r2 = 0.671184
Epoch 54
Validation r2 = 0.653569
Epoch 55
Validation r2 = 0.659419
Epoch 56
Validation r2 = 0.664543
Epoch 57
Validation r2 = 0.649384
Epoch 58
Validation r2 = 0.653260
Epoch 59
Validation r2 = 0.678093
Epoch 60
Validation r2 = 0.673017
Epoch 61
Validation r2 = 0.671782
Epoch 62
Validation r2 = 0.662734
Epoch 63
Validation r2 = 0.661411
Epoch 64
Validation r2 = 0.660040
Epoch 65
Validation r2 = 0.667237
Epoch 66
Validation r2 = 0.669103
Epoch 67
Validation r2 = 0.653712
Epoch 68
Validation r2 = 0.657045
Epoch 69
Validation r2 = 0.652671
Epoch 70
Validation r2 = 0.656245
Epoch 71
Validation r2 = 0.665436
Epoch 72
Validation r2 = 0.656813
Epoch 73
Validation r2 = 0.652925
Epoch 74
Validation r2 = 0.633622
Epoch 75
Validation r2 = 0.664540
Epoch 76
Validation r2 = 0.653650
Epoch 77
Validation r2 = 0.660430
Epoch 78
Validation r2 = 0.652422
Epoch 79
Validation r2 = 0.648043
Epoch 80
Validation r2 = 0.661176
Epoch 81
Validation r2 = 0.642238
Epoch 82
Validation r2 = 0.639155
Epoch 83
Validation r2 = 0.629141
Epoch 84
Validation r2 = 0.634934
Epoch 85
Validation r2 = 0.639914
Epoch 86
Validation r2 = 0.645022
Epoch 87
Validation r2 = 0.631030
Epoch 88
Validation r2 = 0.637186
Epoch 89
Validation r2 = 0.644329
Epoch 90
Validation r2 = 0.620624
Epoch 91
Validation r2 = 0.646109
Epoch 92
Validation r2 = 0.644178
Epoch 93
Validation r2 = 0.640642
Epoch 94
Validation r2 = 0.643766
Epoch 95
Validation r2 = 0.611273
Epoch 96
Validation r2 = 0.639096
Epoch 97
Validation r2 = 0.646565
Epoch 98
Validation r2 = 0.637065
Epoch 99
Validation r2 = 0.645233
Model 1 best validation r2 = 0.678093 on epoch 59
Moving model to cuda
Model 1 test mae = 0.404551
Model 1 test mse = 0.369247
Model 1 test r2 = 0.672432
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = 0.008511
Epoch 1
Validation r2 = -0.017429
Epoch 2
Validation r2 = -0.062965
Epoch 3
Validation r2 = 0.076084
Epoch 4
Validation r2 = 0.075010
Epoch 5
Validation r2 = 0.087813
Epoch 6
Validation r2 = 0.157256
Epoch 7
Validation r2 = 0.178334
Epoch 8
Validation r2 = 0.231683
Epoch 9
Validation r2 = 0.230596
Epoch 10
Validation r2 = 0.378328
Epoch 11
Validation r2 = 0.334507
Epoch 12
Validation r2 = 0.376413
Epoch 13
Validation r2 = 0.335521
Epoch 14
Validation r2 = 0.422281
Epoch 15
Validation r2 = 0.456978
Epoch 16
Validation r2 = 0.449766
Epoch 17
Validation r2 = 0.495614
Epoch 18
Validation r2 = 0.486531
Epoch 19
Validation r2 = 0.488393
Epoch 20
Validation r2 = 0.509050
Epoch 21
Validation r2 = 0.513097
Epoch 22
Validation r2 = 0.548037
Epoch 23
Validation r2 = 0.560214
Epoch 24
Validation r2 = 0.556116
Epoch 25
Validation r2 = 0.527571
Epoch 26
Validation r2 = 0.561709
Epoch 27
Validation r2 = 0.529093
Epoch 28
Validation r2 = 0.535606
Epoch 29
Validation r2 = 0.562282
Epoch 30
Validation r2 = 0.597020
Epoch 31
Validation r2 = 0.596332
Epoch 32
Validation r2 = 0.620646
Epoch 33
Validation r2 = 0.585715
Epoch 34
Validation r2 = 0.572447
Epoch 35
Validation r2 = 0.601204
Epoch 36
Validation r2 = 0.603214
Epoch 37
Validation r2 = 0.615778
Epoch 38
Validation r2 = 0.633812
Epoch 39
Validation r2 = 0.602616
Epoch 40
Validation r2 = 0.637922
Epoch 41
Validation r2 = 0.652439
Epoch 42
Validation r2 = 0.645443
Epoch 43
Validation r2 = 0.638446
Epoch 44
Validation r2 = 0.670266
Epoch 45
Validation r2 = 0.648452
Epoch 46
Validation r2 = 0.654266
Epoch 47
Validation r2 = 0.623913
Epoch 48
Validation r2 = 0.606316
Epoch 49
Validation r2 = 0.667773
Epoch 50
Validation r2 = 0.669713
Epoch 51
Validation r2 = 0.668771
Epoch 52
Validation r2 = 0.665498
Epoch 53
Validation r2 = 0.663971
Epoch 54
Validation r2 = 0.657179
Epoch 55
Validation r2 = 0.656813
Epoch 56
Validation r2 = 0.658751
Epoch 57
Validation r2 = 0.628632
Epoch 58
Validation r2 = 0.664986
Epoch 59
Validation r2 = 0.646495
Epoch 60
Validation r2 = 0.679638
Epoch 61
Validation r2 = 0.677274
Epoch 62
Validation r2 = 0.687608
Epoch 63
Validation r2 = 0.668667
Epoch 64
Validation r2 = 0.677826
Epoch 65
Validation r2 = 0.664022
Epoch 66
Validation r2 = 0.679780
Epoch 67
Validation r2 = 0.680238
Epoch 68
Validation r2 = 0.670697
Epoch 69
Validation r2 = 0.677122
Epoch 70
Validation r2 = 0.668458
Epoch 71
Validation r2 = 0.681075
Epoch 72
Validation r2 = 0.675503
Epoch 73
Validation r2 = 0.667144
Epoch 74
Validation r2 = 0.683638
Epoch 75
Validation r2 = 0.656882
Epoch 76
Validation r2 = 0.681590
Epoch 77
Validation r2 = 0.668695
Epoch 78
Validation r2 = 0.665503
Epoch 79
Validation r2 = 0.672492
Epoch 80
Validation r2 = 0.667709
Epoch 81
Validation r2 = 0.681449
Epoch 82
Validation r2 = 0.668410
Epoch 83
Validation r2 = 0.674359
Epoch 84
Validation r2 = 0.683562
Epoch 85
Validation r2 = 0.671637
Epoch 86
Validation r2 = 0.673048
Epoch 87
Validation r2 = 0.671496
Epoch 88
Validation r2 = 0.668042
Epoch 89
Validation r2 = 0.665872
Epoch 90
Validation r2 = 0.677630
Epoch 91
Validation r2 = 0.659695
Epoch 92
Validation r2 = 0.676038
Epoch 93
Validation r2 = 0.670021
Epoch 94
Validation r2 = 0.646660
Epoch 95
Validation r2 = 0.673677
Epoch 96
Validation r2 = 0.661803
Epoch 97
Validation r2 = 0.670669
Epoch 98
Validation r2 = 0.658212
Epoch 99
Validation r2 = 0.661931
Model 2 best validation r2 = 0.687608 on epoch 62
Moving model to cuda
Model 2 test mae = 0.420973
Model 2 test mse = 0.380342
Model 2 test r2 = 0.662589
Ensemble test mae = 0.402642
Ensemble test mse = 0.365431
Ensemble test r2 = 0.675817
1-fold cross validation
Seed 0 ==> test r2 = 0.675817
Overall test r2 = 0.675817 +/- 0.000000
