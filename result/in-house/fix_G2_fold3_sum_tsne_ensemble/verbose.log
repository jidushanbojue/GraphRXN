Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 335 | train size = 268 | val size = 67 | test size = 84
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.009960
Epoch 1
Validation r2 = -0.074660
Epoch 2
Validation r2 = -0.131089
Epoch 3
Validation r2 = -0.004018
Epoch 4
Validation r2 = 0.008325
Epoch 5
Validation r2 = -0.026521
Epoch 6
Validation r2 = 0.007119
Epoch 7
Validation r2 = 0.011256
Epoch 8
Validation r2 = 0.021188
Epoch 9
Validation r2 = 0.026605
Epoch 10
Validation r2 = 0.043512
Epoch 11
Validation r2 = 0.052727
Epoch 12
Validation r2 = 0.021619
Epoch 13
Validation r2 = 0.074572
Epoch 14
Validation r2 = 0.088530
Epoch 15
Validation r2 = 0.112196
Epoch 16
Validation r2 = 0.110537
Epoch 17
Validation r2 = 0.062844
Epoch 18
Validation r2 = 0.150919
Epoch 19
Validation r2 = 0.118081
Epoch 20
Validation r2 = 0.194586
Epoch 21
Validation r2 = 0.197885
Epoch 22
Validation r2 = 0.242410
Epoch 23
Validation r2 = 0.300382
Epoch 24
Validation r2 = 0.380936
Epoch 25
Validation r2 = 0.404882
Epoch 26
Validation r2 = 0.353944
Epoch 27
Validation r2 = 0.363558
Epoch 28
Validation r2 = 0.389543
Epoch 29
Validation r2 = 0.375140
Epoch 30
Validation r2 = 0.438145
Epoch 31
Validation r2 = 0.473951
Epoch 32
Validation r2 = 0.446520
Epoch 33
Validation r2 = 0.499696
Epoch 34
Validation r2 = 0.459569
Epoch 35
Validation r2 = 0.525104
Epoch 36
Validation r2 = 0.520017
Epoch 37
Validation r2 = 0.514599
Epoch 38
Validation r2 = 0.536835
Epoch 39
Validation r2 = 0.514438
Epoch 40
Validation r2 = 0.554949
Epoch 41
Validation r2 = 0.559862
Epoch 42
Validation r2 = 0.552121
Epoch 43
Validation r2 = 0.590795
Epoch 44
Validation r2 = 0.594552
Epoch 45
Validation r2 = 0.490935
Epoch 46
Validation r2 = 0.588464
Epoch 47
Validation r2 = 0.547119
Epoch 48
Validation r2 = 0.608385
Epoch 49
Validation r2 = 0.615236
Epoch 50
Validation r2 = 0.590931
Epoch 51
Validation r2 = 0.609214
Epoch 52
Validation r2 = 0.568686
Epoch 53
Validation r2 = 0.636493
Epoch 54
Validation r2 = 0.571311
Epoch 55
Validation r2 = 0.647094
Epoch 56
Validation r2 = 0.652281
Epoch 57
Validation r2 = 0.647988
Epoch 58
Validation r2 = 0.656514
Epoch 59
Validation r2 = 0.637799
Epoch 60
Validation r2 = 0.661858
Epoch 61
Validation r2 = 0.661215
Epoch 62
Validation r2 = 0.631189
Epoch 63
Validation r2 = 0.649631
Epoch 64
Validation r2 = 0.594565
Epoch 65
Validation r2 = 0.674384
Epoch 66
Validation r2 = 0.677480
Epoch 67
Validation r2 = 0.663362
Epoch 68
Validation r2 = 0.679665
Epoch 69
Validation r2 = 0.671969
Epoch 70
Validation r2 = 0.685800
Epoch 71
Validation r2 = 0.687339
Epoch 72
Validation r2 = 0.666532
Epoch 73
Validation r2 = 0.689900
Epoch 74
Validation r2 = 0.682892
Epoch 75
Validation r2 = 0.690835
Epoch 76
Validation r2 = 0.693784
Epoch 77
Validation r2 = 0.685838
Epoch 78
Validation r2 = 0.693228
Epoch 79
Validation r2 = 0.680113
Epoch 80
Validation r2 = 0.689821
Epoch 81
Validation r2 = 0.688309
Epoch 82
Validation r2 = 0.670639
Epoch 83
Validation r2 = 0.691443
Epoch 84
Validation r2 = 0.697827
Epoch 85
Validation r2 = 0.692954
Epoch 86
Validation r2 = 0.696679
Epoch 87
Validation r2 = 0.698935
Epoch 88
Validation r2 = 0.682197
Epoch 89
Validation r2 = 0.699995
Epoch 90
Validation r2 = 0.699037
Epoch 91
Validation r2 = 0.677472
Epoch 92
Validation r2 = 0.700828
Epoch 93
Validation r2 = 0.696115
Epoch 94
Validation r2 = 0.672444
Epoch 95
Validation r2 = 0.702713
Epoch 96
Validation r2 = 0.704545
Epoch 97
Validation r2 = 0.697309
Epoch 98
Validation r2 = 0.696824
Epoch 99
Validation r2 = 0.706267
Model 0 best validation r2 = 0.706267 on epoch 99
Moving model to cuda
Model 0 test mae = 0.518873
Model 0 test mse = 0.457797
Model 0 test r2 = 0.545091
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.005526
Epoch 1
Validation r2 = 0.008307
Epoch 2
Validation r2 = -0.047039
Epoch 3
Validation r2 = 0.012362
Epoch 4
Validation r2 = 0.000133
Epoch 5
Validation r2 = -0.060318
Epoch 6
Validation r2 = 0.020035
Epoch 7
Validation r2 = 0.013764
Epoch 8
Validation r2 = 0.013311
Epoch 9
Validation r2 = 0.023358
Epoch 10
Validation r2 = 0.043561
Epoch 11
Validation r2 = 0.050365
Epoch 12
Validation r2 = 0.052198
Epoch 13
Validation r2 = 0.081570
Epoch 14
Validation r2 = 0.096744
Epoch 15
Validation r2 = 0.112885
Epoch 16
Validation r2 = 0.150434
Epoch 17
Validation r2 = 0.173566
Epoch 18
Validation r2 = 0.176635
Epoch 19
Validation r2 = 0.211339
Epoch 20
Validation r2 = 0.280445
Epoch 21
Validation r2 = 0.342047
Epoch 22
Validation r2 = 0.387064
Epoch 23
Validation r2 = 0.452057
Epoch 24
Validation r2 = 0.439025
Epoch 25
Validation r2 = 0.473454
Epoch 26
Validation r2 = 0.460330
Epoch 27
Validation r2 = 0.360849
Epoch 28
Validation r2 = 0.393240
Epoch 29
Validation r2 = 0.429769
Epoch 30
Validation r2 = 0.380930
Epoch 31
Validation r2 = 0.469581
Epoch 32
Validation r2 = 0.487805
Epoch 33
Validation r2 = 0.467016
Epoch 34
Validation r2 = 0.540018
Epoch 35
Validation r2 = 0.555161
Epoch 36
Validation r2 = 0.484844
Epoch 37
Validation r2 = 0.562606
Epoch 38
Validation r2 = 0.563659
Epoch 39
Validation r2 = 0.540348
Epoch 40
Validation r2 = 0.571164
Epoch 41
Validation r2 = 0.553978
Epoch 42
Validation r2 = 0.574874
Epoch 43
Validation r2 = 0.584625
Epoch 44
Validation r2 = 0.543815
Epoch 45
Validation r2 = 0.583158
Epoch 46
Validation r2 = 0.541456
Epoch 47
Validation r2 = 0.603060
Epoch 48
Validation r2 = 0.607094
Epoch 49
Validation r2 = 0.596336
Epoch 50
Validation r2 = 0.616967
Epoch 51
Validation r2 = 0.612819
Epoch 52
Validation r2 = 0.622775
Epoch 53
Validation r2 = 0.626176
Epoch 54
Validation r2 = 0.635125
Epoch 55
Validation r2 = 0.650577
Epoch 56
Validation r2 = 0.652539
Epoch 57
Validation r2 = 0.662933
Epoch 58
Validation r2 = 0.670546
Epoch 59
Validation r2 = 0.574958
Epoch 60
Validation r2 = 0.586482
Epoch 61
Validation r2 = 0.542097
Epoch 62
Validation r2 = 0.686065
Epoch 63
Validation r2 = 0.684981
Epoch 64
Validation r2 = 0.662782
Epoch 65
Validation r2 = 0.693422
Epoch 66
Validation r2 = 0.670568
Epoch 67
Validation r2 = 0.698540
Epoch 68
Validation r2 = 0.699289
Epoch 69
Validation r2 = 0.686469
Epoch 70
Validation r2 = 0.699024
Epoch 71
Validation r2 = 0.699138
Epoch 72
Validation r2 = 0.707264
Epoch 73
Validation r2 = 0.711507
Epoch 74
Validation r2 = 0.698403
Epoch 75
Validation r2 = 0.705499
Epoch 76
Validation r2 = 0.708153
Epoch 77
Validation r2 = 0.694361
Epoch 78
Validation r2 = 0.711475
Epoch 79
Validation r2 = 0.711291
Epoch 80
Validation r2 = 0.701419
Epoch 81
Validation r2 = 0.715068
Epoch 82
Validation r2 = 0.713275
Epoch 83
Validation r2 = 0.714459
Epoch 84
Validation r2 = 0.701768
Epoch 85
Validation r2 = 0.714397
Epoch 86
Validation r2 = 0.705484
Epoch 87
Validation r2 = 0.711511
Epoch 88
Validation r2 = 0.716546
Epoch 89
Validation r2 = 0.714695
Epoch 90
Validation r2 = 0.708407
Epoch 91
Validation r2 = 0.718118
Epoch 92
Validation r2 = 0.700825
Epoch 93
Validation r2 = 0.717007
Epoch 94
Validation r2 = 0.718510
Epoch 95
Validation r2 = 0.708554
Epoch 96
Validation r2 = 0.719337
Epoch 97
Validation r2 = 0.713587
Epoch 98
Validation r2 = 0.715336
Epoch 99
Validation r2 = 0.717574
Model 1 best validation r2 = 0.719337 on epoch 96
Moving model to cuda
Model 1 test mae = 0.494510
Model 1 test mse = 0.426295
Model 1 test r2 = 0.576395
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.020943
Epoch 1
Validation r2 = -0.016024
Epoch 2
Validation r2 = 0.003522
Epoch 3
Validation r2 = -0.046579
Epoch 4
Validation r2 = -0.065099
Epoch 5
Validation r2 = 0.009279
Epoch 6
Validation r2 = 0.027421
Epoch 7
Validation r2 = -0.005687
Epoch 8
Validation r2 = 0.036862
Epoch 9
Validation r2 = 0.055672
Epoch 10
Validation r2 = 0.038680
Epoch 11
Validation r2 = 0.082828
Epoch 12
Validation r2 = 0.122920
Epoch 13
Validation r2 = 0.165084
Epoch 14
Validation r2 = 0.167060
Epoch 15
Validation r2 = 0.193644
Epoch 16
Validation r2 = 0.260583
Epoch 17
Validation r2 = 0.320483
Epoch 18
Validation r2 = 0.367535
Epoch 19
Validation r2 = 0.388489
Epoch 20
Validation r2 = 0.331226
Epoch 21
Validation r2 = 0.344134
Epoch 22
Validation r2 = 0.306975
Epoch 23
Validation r2 = 0.383095
Epoch 24
Validation r2 = 0.441304
Epoch 25
Validation r2 = 0.405110
Epoch 26
Validation r2 = 0.360802
Epoch 27
Validation r2 = 0.452198
Epoch 28
Validation r2 = 0.438585
Epoch 29
Validation r2 = 0.398507
Epoch 30
Validation r2 = 0.494701
Epoch 31
Validation r2 = 0.508477
Epoch 32
Validation r2 = 0.498932
Epoch 33
Validation r2 = 0.539855
Epoch 34
Validation r2 = 0.552904
Epoch 35
Validation r2 = 0.520038
Epoch 36
Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 335 | train size = 268 | val size = 67 | test size = 84
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.022911
Epoch 1
Validation r2 = 0.001738
Epoch 2
Validation r2 = 0.002377
Epoch 3
Validation r2 = -0.048255
Epoch 4
Validation r2 = -0.015648
Epoch 5
Validation r2 = 0.009953
Epoch 6
Validation r2 = -0.024520
Epoch 7
Validation r2 = 0.010482
Epoch 8
Validation r2 = 0.005920
Epoch 9
Validation r2 = 0.021710
Epoch 10
Validation r2 = 0.004167
Epoch 11
Validation r2 = 0.021677
Epoch 12
Validation r2 = 0.033033
Epoch 13
Validation r2 = 0.039976
Epoch 14
Validation r2 = 0.047925
Epoch 15
Validation r2 = 0.050668
Epoch 16
Validation r2 = 0.077195
Epoch 17
Validation r2 = 0.098214
Epoch 18
Validation r2 = 0.112066
Epoch 19
Validation r2 = 0.146017
Epoch 20
Validation r2 = 0.188070
Epoch 21
Validation r2 = 0.183385
Epoch 22
Validation r2 = 0.228157
Epoch 23
Validation r2 = 0.291653
Epoch 24
Validation r2 = 0.331123
Epoch 25
Validation r2 = 0.355666
Epoch 26
Validation r2 = 0.302560
Epoch 27
Validation r2 = 0.388238
Epoch 28
Validation r2 = 0.392756
Epoch 29
Validation r2 = 0.354793
Epoch 30
Validation r2 = 0.433771
Epoch 31
Validation r2 = 0.439358
Epoch 32
Validation r2 = 0.404775
Epoch 33
Validation r2 = 0.490715
Epoch 34
Validation r2 = 0.505989
Epoch 35
Validation r2 = 0.482196
Epoch 36
Validation r2 = 0.507060
Epoch 37
Validation r2 = 0.476990
Epoch 38
Validation r2 = 0.540446
Epoch 39
Validation r2 = 0.548422
Epoch 40
Validation r2 = 0.442179
Epoch 41
Validation r2 = 0.524802
Epoch 42
Validation r2 = 0.501167
Epoch 43
Validation r2 = 0.551575
Epoch 44
Validation r2 = 0.567647
Epoch 45
Validation r2 = 0.532695
Epoch 46
Validation r2 = 0.581630
Epoch 47
Validation r2 = 0.604165
Epoch 48
Validation r2 = 0.524468
Epoch 49
Validation r2 = 0.606462
Epoch 50
Validation r2 = 0.578530
Epoch 51
Validation r2 = 0.629720
Epoch 52
Validation r2 = 0.631487
Epoch 53
Validation r2 = 0.592049
Epoch 54
Validation r2 = 0.643726
Epoch 55
Validation r2 = 0.544709
Epoch 56
Validation r2 = 0.648648
Epoch 57
Validation r2 = 0.650929
Epoch 58
Validation r2 = 0.576478
Epoch 59
Validation r2 = 0.643872
Epoch 60
Validation r2 = 0.622322
Epoch 61
Validation r2 = 0.651606
Epoch 62
Validation r2 = 0.667422
Epoch 63
Validation r2 = 0.654096
Epoch 64
Validation r2 = 0.665398
Epoch 65
Validation r2 = 0.661667
Epoch 66
Validation r2 = 0.672996
Epoch 67
Validation r2 = 0.682186
Epoch 68
Validation r2 = 0.678228
Epoch 69
Validation r2 = 0.686239
Epoch 70
Validation r2 = 0.691783
Epoch 71
Validation r2 = 0.684173
Epoch 72
Validation r2 = 0.687246
Epoch 73
Validation r2 = 0.687514
Epoch 74
Validation r2 = 0.682106
Epoch 75
Validation r2 = 0.693116
Epoch 76
Validation r2 = 0.690190
Epoch 77
Validation r2 = 0.693203
Epoch 78
Validation r2 = 0.697735
Epoch 79
Validation r2 = 0.675324
Epoch 80
Validation r2 = 0.696208
Epoch 81
Validation r2 = 0.695830
Epoch 82
Validation r2 = 0.668457
Epoch 83
Validation r2 = 0.694172
Epoch 84
Validation r2 = 0.698206
Epoch 85
Validation r2 = 0.692403
Epoch 86
Validation r2 = 0.698116
Epoch 87
Validation r2 = 0.697820
Epoch 88
Validation r2 = 0.682671
Epoch 89
Validation r2 = 0.700065
Epoch 90
Validation r2 = 0.700602
Epoch 91
Validation r2 = 0.678835
Epoch 92
Validation r2 = 0.700193
Epoch 93
Validation r2 = 0.698900
Epoch 94
Validation r2 = 0.667410
Epoch 95
Validation r2 = 0.702755
Epoch 96
Validation r2 = 0.705504
Epoch 97
Validation r2 = 0.693430
Epoch 98
Validation r2 = 0.699589
Epoch 99
Validation r2 = 0.707264
Model 0 best validation r2 = 0.707264 on epoch 99
Moving model to cuda
Model 0 test mae = 0.511127
Model 0 test mse = 0.432349
Model 0 test r2 = 0.570379
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -1.291130
Epoch 1
Validation r2 = -0.441883
Epoch 2
Validation r2 = -0.092607
Epoch 3
Validation r2 = -0.012929
Epoch 4
Validation r2 = 0.003117
Epoch 5
Validation r2 = 0.007764
Epoch 6
Validation r2 = -0.001746
Epoch 7
Validation r2 = 0.020251
Epoch 8
Validation r2 = 0.029746
Epoch 9
Validation r2 = 0.023716
Epoch 10
Validation r2 = 0.052257
Epoch 11
Validation r2 = 0.050542
Epoch 12
Validation r2 = 0.036015
Epoch 13
Validation r2 = 0.083701
Epoch 14
Validation r2 = 0.097313
Epoch 15
Validation r2 = 0.131673
Epoch 16
Validation r2 = 0.157449
Epoch 17
Validation r2 = 0.178151
Epoch 18
Validation r2 = 0.193833
Epoch 19
Validation r2 = 0.275630
Epoch 20
Validation r2 = 0.332375
Epoch 21
Validation r2 = 0.348474
Epoch 22
Validation r2 = 0.395280
Epoch 23
Validation r2 = 0.396755
Epoch 24
Validation r2 = 0.474766
Epoch 25
Validation r2 = 0.481564
Epoch 26
Validation r2 = 0.475641
Epoch 27
Validation r2 = 0.366463
Epoch 28
Validation r2 = 0.455050
Epoch 29
Validation r2 = 0.475730
Epoch 30
Validation r2 = 0.463593
Epoch 31
Validation r2 = 0.521992
Epoch 32
Validation r2 = 0.484424
Epoch 33
Validation r2 = 0.563392
Epoch 34
Validation r2 = 0.563024
Epoch 35
Validation r2 = 0.562471
Epoch 36
Validation r2 = 0.550842
Epoch 37
Validation r2 = 0.579564
Epoch 38
Validation r2 = 0.589346
Epoch 39
Validation r2 = 0.572051
Epoch 40
Validation r2 = 0.570830
Epoch 41
Validation r2 = 0.475438
Epoch 42
Validation r2 = 0.551112
Epoch 43
Validation r2 = 0.528541
Epoch 44
Validation r2 = 0.601206
Epoch 45
Validation r2 = 0.591220
Epoch 46
Validation r2 = 0.550322
Epoch 47
Validation r2 = 0.628533
Epoch 48
Validation r2 = 0.626142
Epoch 49
Validation r2 = 0.599387
Epoch 50
Validation r2 = 0.653099
Epoch 51
Validation r2 = 0.658295
Epoch 52
Validation r2 = 0.608258
Epoch 53
Validation r2 = 0.669998
Epoch 54
Validation r2 = 0.668592
Epoch 55
Validation r2 = 0.662866
Epoch 56
Validation r2 = 0.681568
Epoch 57
Validation r2 = 0.675890
Epoch 58
Validation r2 = 0.682356
Epoch 59
Validation r2 = 0.689171
Epoch 60
Validation r2 = 0.664794
Epoch 61
Validation r2 = 0.689278
Epoch 62
Validation r2 = 0.683309
Epoch 63
Validation r2 = 0.671476
Epoch 64
Validation r2 = 0.685253
Epoch 65
Validation r2 = 0.676894
Epoch 66
Validation r2 = 0.686150
Epoch 67
Validation r2 = 0.689612
Epoch 68
Validation r2 = 0.692434
Epoch 69
Validation r2 = 0.693432
Epoch 70
Validation r2 = 0.698330
Epoch 71
Validation r2 = 0.699558
Epoch 72
Validation r2 = 0.694431
Epoch 73
Validation r2 = 0.702154
Epoch 74
Validation r2 = 0.701811
Epoch 75
Validation r2 = 0.682105
Epoch 76
Validation r2 = 0.702034
Epoch 77
Validation r2 = 0.705180
Epoch 78
Validation r2 = 0.693454
Epoch 79
Validation r2 = 0.707754
Epoch 80
Validation r2 = 0.708884
Epoch 81
Validation r2 = 0.701416
Epoch 82
Validation r2 = 0.708640
Epoch 83
Validation r2 = 0.706646
Epoch 84
Validation r2 = 0.685471
Epoch 85
Validation r2 = 0.706097
Epoch 86
Validation r2 = 0.704699
Epoch 87
Validation r2 = 0.696427
Epoch 88
Validation r2 = 0.697483
Epoch 89
Validation r2 = 0.703165
Epoch 90
Validation r2 = 0.702485
Epoch 91
Validation r2 = 0.699228
Epoch 92
Validation r2 = 0.705807
Epoch 93
Validation r2 = 0.705962
Epoch 94
Validation r2 = 0.702688
Epoch 95
Validation r2 = 0.704663
Epoch 96
Validation r2 = 0.707854
Epoch 97
Validation r2 = 0.702539
Epoch 98
Validation r2 = 0.704382
Epoch 99
Validation r2 = 0.706511
Model 1 best validation r2 = 0.708884 on epoch 80
Moving model to cuda
Model 1 test mae = 0.511937
Model 1 test mse = 0.445377
Model 1 test r2 = 0.557433
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.014680
Epoch 1
Validation r2 = -0.015340
Epoch 2
Validation r2 = -0.027991
Epoch 3
Validation r2 = -0.026850
Epoch 4
Validation r2 = 0.032123
Epoch 5
Validation r2 = 0.034885
Epoch 6
Validation r2 = 0.050239
Epoch 7
Validation r2 = 0.031890
Epoch 8
Validation r2 = 0.072997
Epoch 9
Validation r2 = 0.098441
Epoch 10
Validation r2 = 0.096643
Epoch 11
Validation r2 = 0.135674
Epoch 12
Validation r2 = 0.191285
Epoch 13
Validation r2 = 0.226056
Epoch 14
Validation r2 = 0.242109
Epoch 15
Validation r2 = 0.106586
Epoch 16
Validation r2 = 0.204693
Epoch 17
Validation r2 = 0.304300
Epoch 18
Validation r2 = 0.338136
Epoch 19
Validation r2 = 0.364380
Epoch 20
Validation r2 = 0.381237
Epoch 21
Validation r2 = 0.324666
Epoch 22
Validation r2 = 0.348214
Epoch 23
Validation r2 = 0.420132
Epoch 24
Validation r2 = 0.460709
Epoch 25
Validation r2 = 0.459733
Epoch 26
Validation r2 = 0.403612
Epoch 27
Validation r2 = 0.448297
Epoch 28
Validation r2 = 0.485741
Epoch 29
Validation r2 = 0.465341
Epoch 30
Validation r2 = 0.504355
Epoch 31
Validation r2 = 0.447136
Epoch 32
Validation r2 = 0.519054
Epoch 33
Validation r2 = 0.517958
Epoch 34
Validation r2 = 0.549966
Epoch 35
Validation r2 = 0.547323
Epoch 36
Validation r2 = 0.560191
Epoch 37
Validation r2 = 0.570773
Epoch 38
Validation r2 = 0.555018
Epoch 39
Validation r2 = 0.564508
Epoch 40
Validation r2 = 0.579503
Epoch 41
Validation r2 = 0.554186
Epoch 42
Validation r2 = 0.594598
Epoch 43
Validation r2 = 0.587474
Epoch 44
Validation r2 = 0.608258
Epoch 45
Validation r2 = 0.563030
Epoch 46
Validation r2 = 0.598011
Epoch 47
Validation r2 = 0.606673
Epoch 48
Validation r2 = 0.490811
Epoch 49
Validation r2 = 0.619558
Epoch 50
Validation r2 = 0.583928
Epoch 51
Validation r2 = 0.620584
Epoch 52
Validation r2 = 0.621568
Epoch 53
Validation r2 = 0.623500
Epoch 54
Validation r2 = 0.584964
Epoch 55
Validation r2 = 0.602379
Epoch 56
Validation r2 = 0.507640
Epoch 57
Validation r2 = 0.629098
Epoch 58
Validation r2 = 0.630744
Epoch 59
Validation r2 = 0.564953
Epoch 60
Validation r2 = 0.615894
Epoch 61
Validation r2 = 0.604965
Epoch 62
Validation r2 = 0.617215
Epoch 63
Validation r2 = 0.636091
Epoch 64
Validation r2 = 0.617720
Epoch 65
Validation r2 = 0.642291
Epoch 66
Validation r2 = 0.638967
Epoch 67
Validation r2 = 0.624646
Epoch 68
Validation r2 = 0.646565
Epoch 69
Validation r2 = 0.635106
Epoch 70
Validation r2 = 0.646716
Epoch 71
Validation r2 = 0.642164
Epoch 72
Validation r2 = 0.647691
Epoch 73
Validation r2 = 0.641701
Epoch 74
Validation r2 = 0.648622
Epoch 75
Validation r2 = 0.631345
Epoch 76
Validation r2 = 0.650714
Epoch 77
Validation r2 = 0.632884
Epoch 78
Validation r2 = 0.646909
Epoch 79
Validation r2 = 0.642168
Epoch 80
Validation r2 = 0.652058
Epoch 81
Validation r2 = 0.637333
Epoch 82
Validation r2 = 0.653332
Epoch 83
Validation r2 = 0.650616
Epoch 84
Validation r2 = 0.641380
Epoch 85
Validation r2 = 0.654885
Epoch 86
Validation r2 = 0.654961
Epoch 87
Validation r2 = 0.638490
Epoch 88
Validation r2 = 0.655181
Epoch 89
Validation r2 = 0.654606
Epoch 90
Validation r2 = 0.638321
Epoch 91
Validation r2 = 0.653340
Epoch 92
Validation r2 = 0.643114
Epoch 93
Validation r2 = 0.642009
Epoch 94
Validation r2 = 0.652729
Epoch 95
Validation r2 = 0.645483
Epoch 96
Validation r2 = 0.649368
Epoch 97
Validation r2 = 0.652543
Epoch 98
Validation r2 = 0.636839
Epoch 99
Validation r2 = 0.647780
Model 2 best validation r2 = 0.655181 on epoch 88
Moving model to cuda
Model 2 test mae = 0.525954
Model 2 test mse = 0.457115
Model 2 test r2 = 0.545769
Ensemble test mae = 0.510556
Ensemble test mse = 0.440144
Ensemble test r2 = 0.562632
1-fold cross validation
Seed 0 ==> test r2 = 0.562632
Overall test r2 = 0.562632 +/- 0.000000
