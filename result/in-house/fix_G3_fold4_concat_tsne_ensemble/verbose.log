Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 321 | train size = 256 | val size = 65 | test size = 80
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.011978
Epoch 1
Validation r2 = 0.020514
Epoch 2
Validation r2 = 0.042975
Epoch 3
Validation r2 = 0.112295
Epoch 4
Validation r2 = 0.259612
Epoch 5
Validation r2 = 0.044626
Epoch 6
Validation r2 = 0.265719
Epoch 7
Validation r2 = 0.326620
Epoch 8
Validation r2 = 0.385063
Epoch 9
Validation r2 = 0.464680
Epoch 10
Validation r2 = 0.548708
Epoch 11
Validation r2 = 0.512106
Epoch 12
Validation r2 = 0.632163
Epoch 13
Validation r2 = 0.633321
Epoch 14
Validation r2 = 0.637558
Epoch 15
Validation r2 = 0.624656
Epoch 16
Validation r2 = 0.668284
Epoch 17
Validation r2 = 0.648403
Epoch 18
Validation r2 = 0.614889
Epoch 19
Validation r2 = 0.651247
Epoch 20
Validation r2 = 0.633416
Epoch 21
Validation r2 = 0.626658
Epoch 22
Validation r2 = 0.636234
Epoch 23
Validation r2 = 0.638064
Epoch 24
Validation r2 = 0.650602
Epoch 25
Validation r2 = 0.645558
Epoch 26
Validation r2 = 0.665729
Epoch 27
Validation r2 = 0.676435
Epoch 28
Validation r2 = 0.676767
Epoch 29
Validation r2 = 0.702595
Epoch 30
Validation r2 = 0.689488
Epoch 31
Validation r2 = 0.706068
Epoch 32
Validation r2 = 0.707730
Epoch 33
Validation r2 = 0.707836
Epoch 34
Validation r2 = 0.718954
Epoch 35
Validation r2 = 0.736932
Epoch 36
Validation r2 = 0.723319
Epoch 37
Validation r2 = 0.744248
Epoch 38
Validation r2 = 0.711612
Epoch 39
Validation r2 = 0.740042
Epoch 40
Validation r2 = 0.744479
Epoch 41
Validation r2 = 0.739218
Epoch 42
Validation r2 = 0.757592
Epoch 43
Validation r2 = 0.745058
Epoch 44
Validation r2 = 0.755602
Epoch 45
Validation r2 = 0.763090
Epoch 46
Validation r2 = 0.760033
Epoch 47
Validation r2 = 0.779174
Epoch 48
Validation r2 = 0.784571
Epoch 49
Validation r2 = 0.769886
Epoch 50
Validation r2 = 0.780480
Epoch 51
Validation r2 = 0.781577
Epoch 52
Validation r2 = 0.788901
Epoch 53
Validation r2 = 0.787800
Epoch 54
Validation r2 = 0.788150
Epoch 55
Validation r2 = 0.784416
Epoch 56
Validation r2 = 0.791609
Epoch 57
Validation r2 = 0.794059
Epoch 58
Validation r2 = 0.795128
Epoch 59
Validation r2 = 0.802492
Epoch 60
Validation r2 = 0.794504
Epoch 61
Validation r2 = 0.795542
Epoch 62
Validation r2 = 0.797746
Epoch 63
Validation r2 = 0.797516
Epoch 64
Validation r2 = 0.802315
Epoch 65
Validation r2 = 0.808394
Epoch 66
Validation r2 = 0.803685
Epoch 67
Validation r2 = 0.802406
Epoch 68
Validation r2 = 0.798226
Epoch 69
Validation r2 = 0.797900
Epoch 70
Validation r2 = 0.807905
Epoch 71
Validation r2 = 0.798725
Epoch 72
Validation r2 = 0.794241
Epoch 73
Validation r2 = 0.795200
Epoch 74
Validation r2 = 0.794088
Epoch 75
Validation r2 = 0.800300
Epoch 76
Validation r2 = 0.803811
Epoch 77
Validation r2 = 0.795924
Epoch 78
Validation r2 = 0.797125
Epoch 79
Validation r2 = 0.792281
Epoch 80
Validation r2 = 0.789578
Epoch 81
Validation r2 = 0.795775
Epoch 82
Validation r2 = 0.798819
Epoch 83
Validation r2 = 0.795420
Epoch 84
Validation r2 = 0.795476
Epoch 85
Validation r2 = 0.793052
Epoch 86
Validation r2 = 0.794391
Epoch 87
Validation r2 = 0.793757
Epoch 88
Validation r2 = 0.786729
Epoch 89
Validation r2 = 0.782408
Epoch 90
Validation r2 = 0.785483
Epoch 91
Validation r2 = 0.788429
Epoch 92
Validation r2 = 0.785424
Epoch 93
Validation r2 = 0.780058
Epoch 94
Validation r2 = 0.781165
Epoch 95
Validation r2 = 0.787880
Epoch 96
Validation r2 = 0.791614
Epoch 97
Validation r2 = 0.782758
Epoch 98
Validation r2 = 0.782599
Epoch 99
Validation r2 = 0.779186
Model 0 best validation r2 = 0.808394 on epoch 65
Moving model to cuda
Model 0 test mae = 0.332583
Model 0 test mse = 0.192171
Model 0 test r2 = 0.807569
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.015496
Epoch 1
Validation r2 = 0.031909
Epoch 2
Validation r2 = 0.050900
Epoch 3
Validation r2 = 0.100880
Epoch 4
Validation r2 = 0.164793
Epoch 5
Validation r2 = 0.192368
Epoch 6
Validation r2 = 0.217820
Epoch 7
Validation r2 = 0.309931
Epoch 8
Validation r2 = 0.417246
Epoch 9
Validation r2 = 0.392035
Epoch 10
Validation r2 = 0.530479
Epoch 11
Validation r2 = 0.583257
Epoch 12
Validation r2 = 0.512731
Epoch 13
Validation r2 = 0.619400
Epoch 14
Validation r2 = 0.634469
Epoch 15
Validation r2 = 0.640682
Epoch 16
Validation r2 = 0.615250
Epoch 17
Validation r2 = 0.671029
Epoch 18
Validation r2 = 0.642326
Epoch 19
Validation r2 = 0.637125
Epoch 20
Validation r2 = 0.655805
Epoch 21
Validation r2 = 0.653301
Epoch 22
Validation r2 = 0.620554
Epoch 23
Validation r2 = 0.650501
Epoch 24
Validation r2 = 0.670543
Epoch 25
Validation r2 = 0.652235
Epoch 26
Validation r2 = 0.678811
Epoch 27
Validation r2 = 0.699422
Epoch 28
Validation r2 = 0.680860
Epoch 29
Validation r2 = 0.707270
Epoch 30
Validation r2 = 0.726143
Epoch 31
Validation r2 = 0.721006
Epoch 32
Validation r2 = 0.722211
Epoch 33
Validation r2 = 0.735388
Epoch 34
Validation r2 = 0.724034
Epoch 35
Validation r2 = 0.721478
Epoch 36
Validation r2 = 0.742708
Epoch 37
Validation r2 = 0.742056
Epoch 38
Validation r2 = 0.742295
Epoch 39
Validation r2 = 0.745334
Epoch 40
Validation r2 = 0.739672
Epoch 41
Validation r2 = 0.742453
Epoch 42
Validation r2 = 0.755961
Epoch 43
Validation r2 = 0.756975
Epoch 44
Validation r2 = 0.754288
Epoch 45
Validation r2 = 0.759809
Epoch 46
Validation r2 = 0.761607
Epoch 47
Validation r2 = 0.760375
Epoch 48
Validation r2 = 0.765403
Epoch 49
Validation r2 = 0.768856
Epoch 50
Validation r2 = 0.755739
Epoch 51
Validation r2 = 0.770238
Epoch 52
Validation r2 = 0.779624
Epoch 53
Validation r2 = 0.763919
Epoch 54
Validation r2 = 0.777246
Epoch 55
Validation r2 = 0.777302
Epoch 56
Validation r2 = 0.748420
Epoch 57
Validation r2 = 0.766839
Epoch 58
Validation r2 = 0.776292
Epoch 59
Validation r2 = 0.768656
Epoch 60
Validation r2 = 0.782631
Epoch 61
Validation r2 = 0.780956
Epoch 62
Validation r2 = 0.763905
Epoch 63
Validation r2 = 0.770354
Epoch 64
Validation r2 = 0.781254
Epoch 65
Validation r2 = 0.776300
Epoch 66
Validation r2 = 0.769137
Epoch 67
Validation r2 = 0.780235
Epoch 68
Validation r2 = 0.786206
Epoch 69
Validation r2 = 0.774178
Epoch 70
Validation r2 = 0.777869
Epoch 71
Validation r2 = 0.783570
Epoch 72
Validation r2 = 0.778647
Epoch 73
Validation r2 = 0.769572
Epoch 74
Validation r2 = 0.768334
Epoch 75
Validation r2 = 0.772307
Epoch 76
Validation r2 = 0.773173
Epoch 77
Validation r2 = 0.780579
Epoch 78
Validation r2 = 0.777271
Epoch 79
Validation r2 = 0.769596
Epoch 80
Validation r2 = 0.772916
Epoch 81
Validation r2 = 0.780201
Epoch 82
Validation r2 = 0.777273
Epoch 83
Validation r2 = 0.775703
Epoch 84
Validation r2 = 0.762569
Epoch 85
Validation r2 = 0.765023
Epoch 86
Validation r2 = 0.770189
Epoch 87
Validation r2 = 0.774021
Epoch 88
Validation r2 = 0.770566
Epoch 89
Validation r2 = 0.760158
Epoch 90
Validation r2 = 0.760717
Epoch 91
Validation r2 = 0.765077
Epoch 92
Validation r2 = 0.765364
Epoch 93
Validation r2 = 0.763929
Epoch 94
Validation r2 = 0.763255
Epoch 95
Validation r2 = 0.766880
Epoch 96
Validation r2 = 0.766013
Epoch 97
Validation r2 = 0.755239
Epoch 98
Validation r2 = 0.755483
Epoch 99
Validation r2 = 0.761310
Model 1 best validation r2 = 0.786206 on epoch 68
Moving model to cuda
Model 1 test mae = 0.342542
Model 1 test mse = 0.194214
Model 1 test r2 = 0.805523
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.039672
Epoch 1
Validation r2 = 0.028997
Epoch 2
Validation r2 = 0.071835
Epoch 3
Validation r2 = 0.126162
Epoch 4
Validation r2 = 0.213276
Epoch 5
Validation r2 = 0.308682
Epoch 6
Validation r2 = 0.395411
Epoch 7
Validation r2 = 0.444785
Epoch 8
Validation r2 = 0.473306
Epoch 9
Validation r2 = 0.632393
Epoch 10
Validation r2 = 0.668612
Epoch 11
Validation r2 = 0.609572
Epoch 12
Validation r2 = 0.656459
Epoch 13
Validation r2 = 0.670769
Epoch 14
Validation r2 = 0.647919
Epoch 15
Validation r2 = 0.667718
Epoch 16
Validation r2 = 0.618389
Epoch 17
Validation r2 = 0.655586
Epoch 18
Validation r2 = 0.643176
Epoch 19
Validation r2 = 0.635534
Epoch 20
Validation r2 = 0.669455
Epoch 21
Validation r2 = 0.664669
Epoch 22
Validation r2 = 0.613710
Epoch 23
Validation r2 = 0.695209
Epoch 24
Validation r2 = 0.703195
Epoch 25
Validation r2 = 0.666749
Epoch 26
Validation r2 = 0.708018
Epoch 27
Validation r2 = 0.724539
Epoch 28
Validation r2 = 0.711226
Epoch 29
Validation r2 = 0.727187
Epoch 30
Validation r2 = 0.741167
Epoch 31
Validation r2 = 0.731598
Epoch 32
Validation r2 = 0.739150
Epoch 33
Validation r2 = 0.749012
Epoch 34
Validation r2 = 0.751533
Epoch 35
Validation r2 = 0.750491
Epoch 36
Validation r2 = 0.752498
Epoch 37
Validation r2 = 0.766026
Epoch 38
Validation r2 = 0.750666
Epoch 39
Validation r2 = 0.768859
Epoch 40
Validation r2 = 0.770187
Epoch 41
Validation r2 = 0.732768
Epoch 42
Validation r2 = 0.760184
Epoch 43
Validation r2 = 0.771301
Epoch 44
Validation r2 = 0.759164
Epoch 45
Validation r2 = 0.780205
Epoch 46
Validation r2 = 0.782809
Epoch 47
Validation r2 = 0.770448
Epoch 48
Validation r2 = 0.779862
Epoch 49
Validation r2 = 0.781368
Epoch 50
Validation r2 = 0.781048
Epoch 51
Validation r2 = 0.780877
Epoch 52
Validation r2 = 0.782414
Epoch 53
Validation r2 = 0.786342
Epoch 54
Validation r2 = 0.771864
Epoch 55
Validation r2 = 0.785705
Epoch 56
Validation r2 = 0.784985
Epoch 57
Validation r2 = 0.778516
Epoch 58
Validation r2 = 0.783074
Epoch 59
Validation r2 = 0.788200
Epoch 60
Validation r2 = 0.785846
Epoch 61
Validation r2 = 0.791385
Epoch 62
Validation r2 = 0.788508
Epoch 63
Validation r2 = 0.785053
Epoch 64
Validation r2 = 0.791554
Epoch 65
Validation r2 = 0.785208
Epoch 66
Validation r2 = 0.779796
Epoch 67
Validation r2 = 0.787518
Epoch 68
Validation r2 = 0.783127
Epoch 69
Validation r2 = 0.784312
Epoch 70
Validation r2 = 0.791333
Epoch 71
Validation r2 = 0.772324
Epoch 72
Validation r2 = 0.775303
Epoch 73
Validation r2 = 0.785053
Epoch 74
Validation r2 = 0.785599
Epoch 75
Validation r2 = 0.783755
Epoch 76
Validation r2 = 0.779672
Epoch 77
Validation r2 = 0.781420
Epoch 78
Validation r2 = 0.776213
Epoch 79
Validation r2 = 0.776975
Epoch 80
Validation r2 = 0.783340
Epoch 81
Validation r2 = 0.784512
Epoch 82
Validation r2 = 0.767042
Epoch 83
Validation r2 = 0.780118
Epoch 84
Validation r2 = 0.786591
Epoch 85
Validation r2 = 0.770147
Epoch 86
Validation r2 = 0.780156
Epoch 87
Validation r2 = 0.775008
Epoch 88
Validation r2 = 0.765611
Epoch 89
Validation r2 = 0.772511
Epoch 90
Validation r2 = 0.782141
Epoch 91
Validation r2 = 0.775055
Epoch 92
Validation r2 = 0.770373
Epoch 93
Validation r2 = 0.772264
Epoch 94
Validation r2 = 0.776857
Epoch 95
Validation r2 = 0.770063
Epoch 96
Validation r2 = 0.777869
Epoch 97
Validation r2 = 0.781438
Epoch 98
Validation r2 = 0.774890
Epoch 99
Validation r2 = 0.772898
Model 2 best validation r2 = 0.791554 on epoch 64
Moving model to cuda
Model 2 test mae = 0.328296
Model 2 test mse = 0.185048
Model 2 test r2 = 0.814702
Ensemble test mae = 0.332685
Ensemble test mse = 0.188268
Ensemble test r2 = 0.811477
1-fold cross validation
Seed 0 ==> test r2 = 0.811477
Overall test r2 = 0.811477 +/- 0.000000
