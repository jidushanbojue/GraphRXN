Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,247 | train size = 997 | val size = 250 | test size = 311
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.030323
Epoch 1
Validation r2 = 0.008384
Epoch 2
Validation r2 = 0.006022
Epoch 3
Validation r2 = 0.063632
Epoch 4
Validation r2 = 0.074649
Epoch 5
Validation r2 = 0.136070
Epoch 6
Validation r2 = 0.273909
Epoch 7
Validation r2 = 0.222103
Epoch 8
Validation r2 = 0.369279
Epoch 9
Validation r2 = 0.452635
Epoch 10
Validation r2 = 0.425368
Epoch 11
Validation r2 = 0.446862
Epoch 12
Validation r2 = 0.507943
Epoch 13
Validation r2 = 0.484957
Epoch 14
Validation r2 = 0.446237
Epoch 15
Validation r2 = 0.516120
Epoch 16
Validation r2 = 0.485742
Epoch 17
Validation r2 = 0.523519
Epoch 18
Validation r2 = 0.508302
Epoch 19
Validation r2 = 0.520053
Epoch 20
Validation r2 = 0.523894
Epoch 21
Validation r2 = 0.512945
Epoch 22
Validation r2 = 0.536851
Epoch 23
Validation r2 = 0.497516
Epoch 24
Validation r2 = 0.545474
Epoch 25
Validation r2 = 0.556467
Epoch 26
Validation r2 = 0.548762
Epoch 27
Validation r2 = 0.594336
Epoch 28
Validation r2 = 0.584564
Epoch 29
Validation r2 = 0.545587
Epoch 30
Validation r2 = 0.575980
Epoch 31
Validation r2 = 0.624712
Epoch 32
Validation r2 = 0.586367
Epoch 33
Validation r2 = 0.600490
Epoch 34
Validation r2 = 0.617821
Epoch 35
Validation r2 = 0.628885
Epoch 36
Validation r2 = 0.620477
Epoch 37
Validation r2 = 0.604724
Epoch 38
Validation r2 = 0.636042
Epoch 39
Validation r2 = 0.605160
Epoch 40
Validation r2 = 0.565370
Epoch 41
Validation r2 = 0.613106
Epoch 42
Validation r2 = 0.601435
Epoch 43
Validation r2 = 0.596242
Epoch 44
Validation r2 = 0.637612
Epoch 45
Validation r2 = 0.639972
Epoch 46
Validation r2 = 0.626948
Epoch 47
Validation r2 = 0.622568
Epoch 48
Validation r2 = 0.620945
Epoch 49
Validation r2 = 0.602624
Epoch 50
Validation r2 = 0.619907
Epoch 51
Validation r2 = 0.604222
Epoch 52
Validation r2 = 0.619653
Epoch 53
Validation r2 = 0.614818
Epoch 54
Validation r2 = 0.606854
Epoch 55
Validation r2 = 0.600254
Epoch 56
Validation r2 = 0.590800
Epoch 57
Validation r2 = 0.605532
Epoch 58
Validation r2 = 0.595256
Epoch 59
Validation r2 = 0.591488
Epoch 60
Validation r2 = 0.587822
Epoch 61
Validation r2 = 0.592895
Epoch 62
Validation r2 = 0.569867
Epoch 63
Validation r2 = 0.577608
Epoch 64
Validation r2 = 0.582199
Epoch 65
Validation r2 = 0.580107
Epoch 66
Validation r2 = 0.582965
Epoch 67
Validation r2 = 0.586155
Epoch 68
Validation r2 = 0.568268
Epoch 69
Validation r2 = 0.570935
Epoch 70
Validation r2 = 0.563173
Epoch 71
Validation r2 = 0.554801
Epoch 72
Validation r2 = 0.565494
Epoch 73
Validation r2 = 0.562696
Epoch 74
Validation r2 = 0.567021
Epoch 75
Validation r2 = 0.569942
Epoch 76
Validation r2 = 0.559937
Epoch 77
Validation r2 = 0.560391
Epoch 78
Validation r2 = 0.557113
Epoch 79
Validation r2 = 0.552423
Epoch 80
Validation r2 = 0.568832
Epoch 81
Validation r2 = 0.560958
Epoch 82
Validation r2 = 0.563573
Epoch 83
Validation r2 = 0.554966
Epoch 84
Validation r2 = 0.554227
Epoch 85
Validation r2 = 0.555745
Epoch 86
Validation r2 = 0.553732
Epoch 87
Validation r2 = 0.555598
Epoch 88
Validation r2 = 0.556890
Epoch 89
Validation r2 = 0.553487
Epoch 90
Validation r2 = 0.551637
Epoch 91
Validation r2 = 0.549713
Epoch 92
Validation r2 = 0.550439
Epoch 93
Validation r2 = 0.556606
Epoch 94
Validation r2 = 0.551305
Epoch 95
Validation r2 = 0.557680
Epoch 96
Validation r2 = 0.549694
Epoch 97
Validation r2 = 0.549127
Epoch 98
Validation r2 = 0.547720
Epoch 99
Validation r2 = 0.545963
Model 0 best validation r2 = 0.639972 on epoch 45
Moving model to cuda
Model 0 test mae = 0.434955
Model 0 test mse = 0.396148
Model 0 test r2 = 0.648567
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.041310
Epoch 1
Validation r2 = -0.043708
Epoch 2
Validation r2 = 0.026288
Epoch 3
Validation r2 = 0.003116
Epoch 4
Validation r2 = 0.103420
Epoch 5
Validation r2 = 0.244675
Epoch 6
Validation r2 = 0.356405
Epoch 7
Validation r2 = 0.355978
Epoch 8
Validation r2 = 0.471590
Epoch 9
Validation r2 = 0.497577
Epoch 10
Validation r2 = 0.428743
Epoch 11
Validation r2 = 0.515210
Epoch 12
Validation r2 = 0.453972
Epoch 13
Validation r2 = 0.520291
Epoch 14
Validation r2 = 0.443032
Epoch 15
Validation r2 = 0.559258
Epoch 16
Validation r2 = 0.492978
Epoch 17
Validation r2 = 0.542440
Epoch 18
Validation r2 = 0.530651
Epoch 19
Validation r2 = 0.511342
Epoch 20
Validation r2 = 0.547149
Epoch 21
Validation r2 = 0.555099
Epoch 22
Validation r2 = 0.547065
Epoch 23
Validation r2 = 0.507696
Epoch 24
Validation r2 = 0.586017
Epoch 25
Validation r2 = 0.603420
Epoch 26
Validation r2 = 0.574760
Epoch 27
Validation r2 = 0.590654
Epoch 28
Validation r2 = 0.571812
Epoch 29
Validation r2 = 0.591106
Epoch 30
Validation r2 = 0.608001
Epoch 31
Validation r2 = 0.587329
Epoch 32
Validation r2 = 0.626918
Epoch 33
Validation r2 = 0.618524
Epoch 34
Validation r2 = 0.609994
Epoch 35
Validation r2 = 0.629225
Epoch 36
Validation r2 = 0.629233
Epoch 37
Validation r2 = 0.589658
Epoch 38
Validation r2 = 0.630420
Epoch 39
Validation r2 = 0.641763
Epoch 40
Validation r2 = 0.633131
Epoch 41
Validation r2 = 0.631202
Epoch 42
Validation r2 = 0.625848
Epoch 43
Validation r2 = 0.624014
Epoch 44
Validation r2 = 0.634076
Epoch 45
Validation r2 = 0.636191
Epoch 46
Validation r2 = 0.607351
Epoch 47
Validation r2 = 0.619586
Epoch 48
Validation r2 = 0.629751
Epoch 49
Validation r2 = 0.622200
Epoch 50
Validation r2 = 0.618899
Epoch 51
Validation r2 = 0.615043
Epoch 52
Validation r2 = 0.627525
Epoch 53
Validation r2 = 0.631268
Epoch 54
Validation r2 = 0.604016
Epoch 55
Validation r2 = 0.625061
Epoch 56
Validation r2 = 0.594582
Epoch 57
Validation r2 = 0.629875
Epoch 58
Validation r2 = 0.602802
Epoch 59
Validation r2 = 0.613542
Epoch 60
Validation r2 = 0.608724
Epoch 61
Validation r2 = 0.606363
Epoch 62
Validation r2 = 0.595210
Epoch 63
Validation r2 = 0.599511
Epoch 64
Validation r2 = 0.589457
Epoch 65
Validation r2 = 0.603288
Epoch 66
Validation r2 = 0.620613
Epoch 67
Validation r2 = 0.590512
Epoch 68
Validation r2 = 0.589320
Epoch 69
Validation r2 = 0.594309
Epoch 70
Validation r2 = 0.600145
Epoch 71
Validation r2 = 0.579348
Epoch 72
Validation r2 = 0.595522
Epoch 73
Validation r2 = 0.578223
Epoch 74
Validation r2 = 0.589087
Epoch 75
Validation r2 = 0.597299
Epoch 76
Validation r2 = 0.585653
Epoch 77
Validation r2 = 0.577584
Epoch 78
Validation r2 = 0.580298
Epoch 79
Validation r2 = 0.586888
Epoch 80
Validation r2 = 0.577504
Epoch 81
Validation r2 = 0.565360
Epoch 82
Validation r2 = 0.575955
Epoch 83
Validation r2 = 0.572010
Epoch 84
Validation r2 = 0.571413
Epoch 85
Validation r2 = 0.575347
Epoch 86
Validation r2 = 0.570824
Epoch 87
Validation r2 = 0.583300
Epoch 88
Validation r2 = 0.572769
Epoch 89
Validation r2 = 0.576826
Epoch 90
Validation r2 = 0.568259
Epoch 91
Validation r2 = 0.564346
Epoch 92
Validation r2 = 0.566460
Epoch 93
Validation r2 = 0.564292
Epoch 94
Validation r2 = 0.574685
Epoch 95
Validation r2 = 0.561893
Epoch 96
Validation r2 = 0.565968
Epoch 97
Validation r2 = 0.566351
Epoch 98
Validation r2 = 0.567157
Epoch 99
Validation r2 = 0.565152
Model 1 best validation r2 = 0.641763 on epoch 39
Moving model to cuda
Model 1 test mae = 0.424983
Model 1 test mse = 0.389935
Model 1 test r2 = 0.654079
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.038484
Epoch 1
Validation r2 = 0.018888
Epoch 2
Validation r2 = -0.052338
Epoch 3
Validation r2 = -0.007397
Epoch 4
Validation r2 = 0.095939
Epoch 5
Validation r2 = 0.170806
Epoch 6
Validation r2 = 0.237914
Epoch 7
Validation r2 = 0.370103
Epoch 8
Validation r2 = 0.368123
Epoch 9
Validation r2 = 0.465263
Epoch 10
Validation r2 = 0.524982
Epoch 11
Validation r2 = 0.363687
Epoch 12
Validation r2 = 0.489597
Epoch 13
Validation r2 = 0.507997
Epoch 14
Validation r2 = 0.515787
Epoch 15
Validation r2 = 0.549449
Epoch 16
Validation r2 = 0.542121
Epoch 17
Validation r2 = 0.564413
Epoch 18
Validation r2 = 0.565673
Epoch 19
Validation r2 = 0.559893
Epoch 20
Validation r2 = 0.564830
Epoch 21
Validation r2 = 0.602384
Epoch 22
Validation r2 = 0.592519
Epoch 23
Validation r2 = 0.592262
Epoch 24
Validation r2 = 0.609293
Epoch 25
Validation r2 = 0.553274
Epoch 26
Validation r2 = 0.625731
Epoch 27
Validation r2 = 0.650977
Epoch 28
Validation r2 = 0.625556
Epoch 29
Validation r2 = 0.654637
Epoch 30
Validation r2 = 0.638905
Epoch 31
Validation r2 = 0.637568
Epoch 32
Validation r2 = 0.637918
Epoch 33
Validation r2 = 0.631722
Epoch 34
Validation r2 = 0.657483
Epoch 35
Validation r2 = 0.658729
Epoch 36
Validation r2 = 0.666000
Epoch 37
Validation r2 = 0.631195
Epoch 38
Validation r2 = 0.662107
Epoch 39
Validation r2 = 0.618082
Epoch 40
Validation r2 = 0.656500
Epoch 41
Validation r2 = 0.657206
Epoch 42
Validation r2 = 0.645048
Epoch 43
Validation r2 = 0.668833
Epoch 44
Validation r2 = 0.663295
Epoch 45
Validation r2 = 0.666911
Epoch 46
Validation r2 = 0.656031
Epoch 47
Validation r2 = 0.644756
Epoch 48
Validation r2 = 0.648323
Epoch 49
Validation r2 = 0.653230
Epoch 50
Validation r2 = 0.647504
Epoch 51
Validation r2 = 0.649995
Epoch 52
Validation r2 = 0.657490
Epoch 53
Validation r2 = 0.658998
Epoch 54
Validation r2 = 0.642499
Epoch 55
Validation r2 = 0.662210
Epoch 56
Validation r2 = 0.634507
Epoch 57
Validation r2 = 0.641196
Epoch 58
Validation r2 = 0.654083
Epoch 59
Validation r2 = 0.645713
Epoch 60
Validation r2 = 0.636588
Epoch 61
Validation r2 = 0.641808
Epoch 62
Validation r2 = 0.632744
Epoch 63
Validation r2 = 0.640759
Epoch 64
Validation r2 = 0.635165
Epoch 65
Validation r2 = 0.635185
Epoch 66
Validation r2 = 0.621388
Epoch 67
Validation r2 = 0.618405
Epoch 68
Validation r2 = 0.622940
Epoch 69
Validation r2 = 0.631096
Epoch 70
Validation r2 = 0.619525
Epoch 71
Validation r2 = 0.626510
Epoch 72
Validation r2 = 0.621602
Epoch 73
Validation r2 = 0.619227
Epoch 74
Validation r2 = 0.618666
Epoch 75
Validation r2 = 0.618533
Epoch 76
Validation r2 = 0.615291
Epoch 77
Validation r2 = 0.615145
Epoch 78
Validation r2 = 0.615291
Epoch 79
Validation r2 = 0.619000
Epoch 80
Validation r2 = 0.609793
Epoch 81
Validation r2 = 0.609848
Epoch 82
Validation r2 = 0.611451
Epoch 83
Validation r2 = 0.608047
Epoch 84
Validation r2 = 0.606750
Epoch 85
Validation r2 = 0.609216
Epoch 86
Validation r2 = 0.609656
Epoch 87
Validation r2 = 0.609945
Epoch 88
Validation r2 = 0.606861
Epoch 89
Validation r2 = 0.599999
Epoch 90
Validation r2 = 0.606009
Epoch 91
Validation r2 = 0.602963
Epoch 92
Validation r2 = 0.608114
Epoch 93
Validation r2 = 0.604561
Epoch 94
Validation r2 = 0.604442
Epoch 95
Validation r2 = 0.605235
Epoch 96
Validation r2 = 0.601748
Epoch 97
Validation r2 = 0.604986
Epoch 98
Validation r2 = 0.601760
Epoch 99
Validation r2 = 0.599221
Model 2 best validation r2 = 0.668833 on epoch 43
Moving model to cuda
Model 2 test mae = 0.413146
Model 2 test mse = 0.384413
Model 2 test r2 = 0.658978
Ensemble test mae = 0.410230
Ensemble test mse = 0.367658
Ensemble test r2 = 0.673841
1-fold cross validation
Seed 0 ==> test r2 = 0.673841
Overall test r2 = 0.673841 +/- 0.000000
