Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 320 | train size = 256 | val size = 64 | test size = 81
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.007961
Epoch 1
Validation r2 = -0.036986
Epoch 2
Validation r2 = 0.020010
Epoch 3
Validation r2 = -0.014242
Epoch 4
Validation r2 = 0.067792
Epoch 5
Validation r2 = 0.097916
Epoch 6
Validation r2 = 0.173623
Epoch 7
Validation r2 = 0.238171
Epoch 8
Validation r2 = 0.144923
Epoch 9
Validation r2 = 0.300064
Epoch 10
Validation r2 = 0.216191
Epoch 11
Validation r2 = 0.323925
Epoch 12
Validation r2 = 0.398135
Epoch 13
Validation r2 = 0.286892
Epoch 14
Validation r2 = 0.430041
Epoch 15
Validation r2 = 0.475555
Epoch 16
Validation r2 = 0.483886
Epoch 17
Validation r2 = 0.589072
Epoch 18
Validation r2 = 0.626326
Epoch 19
Validation r2 = 0.647958
Epoch 20
Validation r2 = 0.651827
Epoch 21
Validation r2 = 0.688887
Epoch 22
Validation r2 = 0.701844
Epoch 23
Validation r2 = 0.686300
Epoch 24
Validation r2 = 0.700583
Epoch 25
Validation r2 = 0.706359
Epoch 26
Validation r2 = 0.683903
Epoch 27
Validation r2 = 0.697954
Epoch 28
Validation r2 = 0.706217
Epoch 29
Validation r2 = 0.707283
Epoch 30
Validation r2 = 0.711898
Epoch 31
Validation r2 = 0.691127
Epoch 32
Validation r2 = 0.707759
Epoch 33
Validation r2 = 0.703935
Epoch 34
Validation r2 = 0.718119
Epoch 35
Validation r2 = 0.711139
Epoch 36
Validation r2 = 0.698410
Epoch 37
Validation r2 = 0.704045
Epoch 38
Validation r2 = 0.677087
Epoch 39
Validation r2 = 0.693885
Epoch 40
Validation r2 = 0.695190
Epoch 41
Validation r2 = 0.703593
Epoch 42
Validation r2 = 0.702403
Epoch 43
Validation r2 = 0.698835
Epoch 44
Validation r2 = 0.709253
Epoch 45
Validation r2 = 0.705808
Epoch 46
Validation r2 = 0.708602
Epoch 47
Validation r2 = 0.693321
Epoch 48
Validation r2 = 0.709176
Epoch 49
Validation r2 = 0.716363
Epoch 50
Validation r2 = 0.726339
Epoch 51
Validation r2 = 0.723417
Epoch 52
Validation r2 = 0.730315
Epoch 53
Validation r2 = 0.709069
Epoch 54
Validation r2 = 0.728858
Epoch 55
Validation r2 = 0.733543
Epoch 56
Validation r2 = 0.725432
Epoch 57
Validation r2 = 0.731070
Epoch 58
Validation r2 = 0.729099
Epoch 59
Validation r2 = 0.744212
Epoch 60
Validation r2 = 0.747053
Epoch 61
Validation r2 = 0.725809
Epoch 62
Validation r2 = 0.752473
Epoch 63
Validation r2 = 0.751684
Epoch 64
Validation r2 = 0.756033
Epoch 65
Validation r2 = 0.759483
Epoch 66
Validation r2 = 0.754546
Epoch 67
Validation r2 = 0.750635
Epoch 68
Validation r2 = 0.753373
Epoch 69
Validation r2 = 0.766679
Epoch 70
Validation r2 = 0.768232
Epoch 71
Validation r2 = 0.757150
Epoch 72
Validation r2 = 0.770918
Epoch 73
Validation r2 = 0.773962
Epoch 74
Validation r2 = 0.773546
Epoch 75
Validation r2 = 0.777286
Epoch 76
Validation r2 = 0.772566
Epoch 77
Validation r2 = 0.779949
Epoch 78
Validation r2 = 0.779653
Epoch 79
Validation r2 = 0.780696
Epoch 80
Validation r2 = 0.778791
Epoch 81
Validation r2 = 0.775626
Epoch 82
Validation r2 = 0.782011
Epoch 83
Validation r2 = 0.783040
Epoch 84
Validation r2 = 0.784176
Epoch 85
Validation r2 = 0.783998
Epoch 86
Validation r2 = 0.789389
Epoch 87
Validation r2 = 0.789937
Epoch 88
Validation r2 = 0.789482
Epoch 89
Validation r2 = 0.789805
Epoch 90
Validation r2 = 0.774460
Epoch 91
Validation r2 = 0.789473
Epoch 92
Validation r2 = 0.791781
Epoch 93
Validation r2 = 0.791984
Epoch 94
Validation r2 = 0.796310
Epoch 95
Validation r2 = 0.793571
Epoch 96
Validation r2 = 0.796844
Epoch 97
Validation r2 = 0.798341
Epoch 98
Validation r2 = 0.794440
Epoch 99
Validation r2 = 0.802254
Model 0 best validation r2 = 0.802254 on epoch 99
Moving model to cuda
Model 0 test mae = 0.346169
Model 0 test mse = 0.232906
Model 0 test r2 = 0.787154
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.142007
Epoch 1
Validation r2 = -0.000915
Epoch 2
Validation r2 = -0.058988
Epoch 3
Validation r2 = 0.041911
Epoch 4
Validation r2 = 0.049887
Epoch 5
Validation r2 = 0.041436
Epoch 6
Validation r2 = 0.133029
Epoch 7
Validation r2 = 0.152666
Epoch 8
Validation r2 = 0.133383
Epoch 9
Validation r2 = 0.258307
Epoch 10
Validation r2 = 0.319493
Epoch 11
Validation r2 = 0.377603
Epoch 12
Validation r2 = 0.389404
Epoch 13
Validation r2 = 0.375390
Epoch 14
Validation r2 = 0.440020
Epoch 15
Validation r2 = 0.483270
Epoch 16
Validation r2 = 0.492314
Epoch 17
Validation r2 = 0.586261
Epoch 18
Validation r2 = 0.630231
Epoch 19
Validation r2 = 0.634995
Epoch 20
Validation r2 = 0.690737
Epoch 21
Validation r2 = 0.689996
Epoch 22
Validation r2 = 0.713118
Epoch 23
Validation r2 = 0.713757
Epoch 24
Validation r2 = 0.710074
Epoch 25
Validation r2 = 0.697197
Epoch 26
Validation r2 = 0.676942
Epoch 27
Validation r2 = 0.695348
Epoch 28
Validation r2 = 0.696119
Epoch 29
Validation r2 = 0.664513
Epoch 30
Validation r2 = 0.680485
Epoch 31
Validation r2 = 0.682778
Epoch 32
Validation r2 = 0.682543
Epoch 33
Validation r2 = 0.655086
Epoch 34
Validation r2 = 0.702499
Epoch 35
Validation r2 = 0.697663
Epoch 36
Validation r2 = 0.636861
Epoch 37
Validation r2 = 0.702530
Epoch 38
Validation r2 = 0.712128
Epoch 39
Validation r2 = 0.710252
Epoch 40
Validation r2 = 0.709630
Epoch 41
Validation r2 = 0.708763
Epoch 42
Validation r2 = 0.698156
Epoch 43
Validation r2 = 0.703699
Epoch 44
Validation r2 = 0.696287
Epoch 45
Validation r2 = 0.697727
Epoch 46
Validation r2 = 0.701355
Epoch 47
Validation r2 = 0.698748
Epoch 48
Validation r2 = 0.702918
Epoch 49
Validation r2 = 0.701931
Epoch 50
Validation r2 = 0.710458
Epoch 51
Validation r2 = 0.710518
Epoch 52
Validation r2 = 0.707545
Epoch 53
Validation r2 = 0.712565
Epoch 54
Validation r2 = 0.705619
Epoch 55
Validation r2 = 0.716653
Epoch 56
Validation r2 = 0.715359
Epoch 57
Validation r2 = 0.711993
Epoch 58
Validation r2 = 0.723039
Epoch 59
Validation r2 = 0.722449
Epoch 60
Validation r2 = 0.726291
Epoch 61
Validation r2 = 0.725202
Epoch 62
Validation r2 = 0.731454
Epoch 63
Validation r2 = 0.734771
Epoch 64
Validation r2 = 0.724923
Epoch 65
Validation r2 = 0.732465
Epoch 66
Validation r2 = 0.718847
Epoch 67
Validation r2 = 0.738308
Epoch 68
Validation r2 = 0.738999
Epoch 69
Validation r2 = 0.733915
Epoch 70
Validation r2 = 0.742682
Epoch 71
Validation r2 = 0.738896
Epoch 72
Validation r2 = 0.746378
Epoch 73
Validation r2 = 0.715304
Epoch 74
Validation r2 = 0.731940
Epoch 75
Validation r2 = 0.732510
Epoch 76
Validation r2 = 0.748958
Epoch 77
Validation r2 = 0.743395
Epoch 78
Validation r2 = 0.743555
Epoch 79
Validation r2 = 0.752722
Epoch 80
Validation r2 = 0.752961
Epoch 81
Validation r2 = 0.745569
Epoch 82
Validation r2 = 0.756258
Epoch 83
Validation r2 = 0.754801
Epoch 84
Validation r2 = 0.744250
Epoch 85
Validation r2 = 0.756723
Epoch 86
Validation r2 = 0.757685
Epoch 87
Validation r2 = 0.749388
Epoch 88
Validation r2 = 0.755344
Epoch 89
Validation r2 = 0.758144
Epoch 90
Validation r2 = 0.758017
Epoch 91
Validation r2 = 0.758935
Epoch 92
Validation r2 = 0.760244
Epoch 93
Validation r2 = 0.763156
Epoch 94
Validation r2 = 0.763765
Epoch 95
Validation r2 = 0.763245
Epoch 96
Validation r2 = 0.766537
Epoch 97
Validation r2 = 0.765414
Epoch 98
Validation r2 = 0.765618
Epoch 99
Validation r2 = 0.768721
Model 1 best validation r2 = 0.768721 on epoch 99
Moving model to cuda
Model 1 test mae = 0.360760
Model 1 test mse = 0.242852
Model 1 test r2 = 0.778065
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.896672
Epoch 1
Validation r2 = -0.005187
Epoch 2
Validation r2 = -0.075864
Epoch 3
Validation r2 = 0.015528
Epoch 4
Validation r2 = 0.042069
Epoch 5
Validation r2 = 0.083089
Epoch 6
Validation r2 = 0.088932
Epoch 7
Validation r2 = 0.175098
Epoch 8
Validation r2 = 0.220577
Epoch 9
Validation r2 = 0.344304
Epoch 10
Validation r2 = 0.229708
Epoch 11
Validation r2 = 0.294477
Epoch 12
Validation r2 = 0.306412
Epoch 13
Validation r2 = 0.304736
Epoch 14
Validation r2 = 0.395294
Epoch 15
Validation r2 = 0.364406
Epoch 16
Validation r2 = 0.485764
Epoch 17
Validation r2 = 0.525695
Epoch 18
Validation r2 = 0.583817
Epoch 19
Validation r2 = 0.586792
Epoch 20
Validation r2 = 0.645236
Epoch 21
Validation r2 = 0.658672
Epoch 22
Validation r2 = 0.648981
Epoch 23
Validation r2 = 0.662257
Epoch 24
Validation r2 = 0.677838
Epoch 25
Validation r2 = 0.680630
Epoch 26
Validation r2 = 0.684927
Epoch 27
Validation r2 = 0.694983
Epoch 28
Validation r2 = 0.700861
Epoch 29
Validation r2 = 0.693115
Epoch 30
Validation r2 = 0.702414
Epoch 31
Validation r2 = 0.698159
Epoch 32
Validation r2 = 0.687344
Epoch 33
Validation r2 = 0.692817
Epoch 34
Validation r2 = 0.672726
Epoch 35
Validation r2 = 0.697252
Epoch 36
Validation r2 = 0.696830
Epoch 37
Validation r2 = 0.696548
Epoch 38
Validation r2 = 0.704647
Epoch 39
Validation r2 = 0.686383
Epoch 40
Validation r2 = 0.699466
Epoch 41
Validation r2 = 0.692342
Epoch 42
Validation r2 = 0.694833
Epoch 43
Validation r2 = 0.699656
Epoch 44
Validation r2 = 0.688684
Epoch 45
Validation r2 = 0.705559
Epoch 46
Validation r2 = 0.693092
Epoch 47
Validation r2 = 0.707338
Epoch 48
Validation r2 = 0.711668
Epoch 49
Validation r2 = 0.667186
Epoch 50
Validation r2 = 0.719567
Epoch 51
Validation r2 = 0.722527
Epoch 52
Validation r2 = 0.704537
Epoch 53
Validation r2 = 0.724597
Epoch 54
Validation r2 = 0.725396
Epoch 55
Validation r2 = 0.713716
Epoch 56
Validation r2 = 0.725719
Epoch 57
Validation r2 = 0.728605
Epoch 58
Validation r2 = 0.714644
Epoch 59
Validation r2 = 0.729403
Epoch 60
Validation r2 = 0.722561
Epoch 61
Validation r2 = 0.729941
Epoch 62
Validation r2 = 0.735786
Epoch 63
Validation r2 = 0.725434
Epoch 64
Validation r2 = 0.738540
Epoch 65
Validation r2 = 0.723452
Epoch 66
Validation r2 = 0.738631
Epoch 67
Validation r2 = 0.745811
Epoch 68
Validation r2 = 0.720949
Epoch 69
Validation r2 = 0.749221
Epoch 70
Validation r2 = 0.747843
Epoch 71
Validation r2 = 0.742899
Epoch 72
Validation r2 = 0.750877
Epoch 73
Validation r2 = 0.752494
Epoch 74
Validation r2 = 0.746121
Epoch 75
Validation r2 = 0.753783
Epoch 76
Validation r2 = 0.752895
Epoch 77
Validation r2 = 0.759768
Epoch 78
Validation r2 = 0.736805
Epoch 79
Validation r2 = 0.761145
Epoch 80
Validation r2 = 0.758500
Epoch 81
Validation r2 = 0.758931
Epoch 82
Validation r2 = 0.765403
Epoch 83
Validation r2 = 0.760373
Epoch 84
Validation r2 = 0.756936
Epoch 85
Validation r2 = 0.767925
Epoch 86
Validation r2 = 0.762789
Epoch 87
Validation r2 = 0.764949
Epoch 88
Validation r2 = 0.771578
Epoch 89
Validation r2 = 0.757327
Epoch 90
Validation r2 = 0.774449
Epoch 91
Validation r2 = 0.772739
Epoch 92
Validation r2 = 0.752545
Epoch 93
Validation r2 = 0.775785
Epoch 94
Validation r2 = 0.776504
Epoch 95
Validation r2 = 0.750230
Epoch 96
Validation r2 = 0.774798
Epoch 97
Validation r2 = 0.774269
Epoch 98
Validation r2 = 0.764251
Epoch 99
Validation r2 = 0.775095
Model 2 best validation r2 = 0.776504 on epoch 94
Moving model to cuda
Model 2 test mae = 0.372720
Model 2 test mse = 0.260532
Model 2 test r2 = 0.761908
Ensemble test mae = 0.358323
Ensemble test mse = 0.241208
Ensemble test r2 = 0.779567
1-fold cross validation
Seed 0 ==> test r2 = 0.779567
Overall test r2 = 0.779567 +/- 0.000000
