Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,247 | train size = 997 | val size = 250 | test size = 312
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.040978
Epoch 1
Validation r2 = 0.079782
Epoch 2
Validation r2 = 0.150055
Epoch 3
Validation r2 = 0.193191
Epoch 4
Validation r2 = 0.321013
Epoch 5
Validation r2 = 0.432904
Epoch 6
Validation r2 = 0.468762
Epoch 7
Validation r2 = 0.483197
Epoch 8
Validation r2 = 0.550259
Epoch 9
Validation r2 = 0.573434
Epoch 10
Validation r2 = 0.599081
Epoch 11
Validation r2 = 0.632853
Epoch 12
Validation r2 = 0.511591
Epoch 13
Validation r2 = 0.549093
Epoch 14
Validation r2 = 0.504456
Epoch 15
Validation r2 = 0.553582
Epoch 16
Validation r2 = 0.502028
Epoch 17
Validation r2 = 0.617281
Epoch 18
Validation r2 = 0.605728
Epoch 19
Validation r2 = 0.571511
Epoch 20
Validation r2 = 0.578596
Epoch 21
Validation r2 = 0.608329
Epoch 22
Validation r2 = 0.575253
Epoch 23
Validation r2 = 0.600406
Epoch 24
Validation r2 = 0.603629
Epoch 25
Validation r2 = 0.613573
Epoch 26
Validation r2 = 0.627449
Epoch 27
Validation r2 = 0.608758
Epoch 28
Validation r2 = 0.612638
Epoch 29
Validation r2 = 0.627731
Epoch 30
Validation r2 = 0.612946
Epoch 31
Validation r2 = 0.644513
Epoch 32
Validation r2 = 0.650089
Epoch 33
Validation r2 = 0.645865
Epoch 34
Validation r2 = 0.644451
Epoch 35
Validation r2 = 0.649426
Epoch 36
Validation r2 = 0.662586
Epoch 37
Validation r2 = 0.661806
Epoch 38
Validation r2 = 0.651561
Epoch 39
Validation r2 = 0.650489
Epoch 40
Validation r2 = 0.668998
Epoch 41
Validation r2 = 0.674387
Epoch 42
Validation r2 = 0.672113
Epoch 43
Validation r2 = 0.658166
Epoch 44
Validation r2 = 0.680235
Epoch 45
Validation r2 = 0.679877
Epoch 46
Validation r2 = 0.665581
Epoch 47
Validation r2 = 0.676106
Epoch 48
Validation r2 = 0.688430
Epoch 49
Validation r2 = 0.682914
Epoch 50
Validation r2 = 0.680336
Epoch 51
Validation r2 = 0.669480
Epoch 52
Validation r2 = 0.673341
Epoch 53
Validation r2 = 0.685027
Epoch 54
Validation r2 = 0.687588
Epoch 55
Validation r2 = 0.674805
Epoch 56
Validation r2 = 0.679162
Epoch 57
Validation r2 = 0.677900
Epoch 58
Validation r2 = 0.683958
Epoch 59
Validation r2 = 0.677710
Epoch 60
Validation r2 = 0.683564
Epoch 61
Validation r2 = 0.682753
Epoch 62
Validation r2 = 0.659211
Epoch 63
Validation r2 = 0.666884
Epoch 64
Validation r2 = 0.678901
Epoch 65
Validation r2 = 0.672991
Epoch 66
Validation r2 = 0.674777
Epoch 67
Validation r2 = 0.672795
Epoch 68
Validation r2 = 0.678479
Epoch 69
Validation r2 = 0.679648
Epoch 70
Validation r2 = 0.683578
Epoch 71
Validation r2 = 0.679056
Epoch 72
Validation r2 = 0.678184
Epoch 73
Validation r2 = 0.675131
Epoch 74
Validation r2 = 0.679395
Epoch 75
Validation r2 = 0.675864
Epoch 76
Validation r2 = 0.673323
Epoch 77
Validation r2 = 0.669324
Epoch 78
Validation r2 = 0.678696
Epoch 79
Validation r2 = 0.672862
Epoch 80
Validation r2 = 0.677783
Epoch 81
Validation r2 = 0.672519
Epoch 82
Validation r2 = 0.673987
Epoch 83
Validation r2 = 0.673531
Epoch 84
Validation r2 = 0.672500
Epoch 85
Validation r2 = 0.674851
Epoch 86
Validation r2 = 0.674538
Epoch 87
Validation r2 = 0.671473
Epoch 88
Validation r2 = 0.673343
Epoch 89
Validation r2 = 0.670297
Epoch 90
Validation r2 = 0.674400
Epoch 91
Validation r2 = 0.673628
Epoch 92
Validation r2 = 0.676372
Epoch 93
Validation r2 = 0.675370
Epoch 94
Validation r2 = 0.674461
Epoch 95
Validation r2 = 0.669589
Epoch 96
Validation r2 = 0.669294
Epoch 97
Validation r2 = 0.669759
Epoch 98
Validation r2 = 0.672449
Epoch 99
Validation r2 = 0.671827
Model 0 best validation r2 = 0.688430 on epoch 48
Moving model to cuda
Model 0 test mae = 0.375010
Model 0 test mse = 0.271143
Model 0 test r2 = 0.663014
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.028215
Epoch 1
Validation r2 = 0.002999
Epoch 2
Validation r2 = 0.021152
Epoch 3
Validation r2 = 0.099710
Epoch 4
Validation r2 = 0.175792
Epoch 5
Validation r2 = 0.312861
Epoch 6
Validation r2 = 0.288014
Epoch 7
Validation r2 = 0.395122
Epoch 8
Validation r2 = 0.553965
Epoch 9
Validation r2 = 0.584827
Epoch 10
Validation r2 = 0.539600
Epoch 11
Validation r2 = 0.619531
Epoch 12
Validation r2 = 0.572959
Epoch 13
Validation r2 = 0.579329
Epoch 14
Validation r2 = 0.606128
Epoch 15
Validation r2 = 0.528113
Epoch 16
Validation r2 = 0.618675
Epoch 17
Validation r2 = 0.590465
Epoch 18
Validation r2 = 0.577735
Epoch 19
Validation r2 = 0.596897
Epoch 20
Validation r2 = 0.608643
Epoch 21
Validation r2 = 0.625779
Epoch 22
Validation r2 = 0.608250
Epoch 23
Validation r2 = 0.678921
Epoch 24
Validation r2 = 0.643641
Epoch 25
Validation r2 = 0.668242
Epoch 26
Validation r2 = 0.651962
Epoch 27
Validation r2 = 0.668378
Epoch 28
Validation r2 = 0.655715
Epoch 29
Validation r2 = 0.687924
Epoch 30
Validation r2 = 0.674236
Epoch 31
Validation r2 = 0.671121
Epoch 32
Validation r2 = 0.669204
Epoch 33
Validation r2 = 0.684444
Epoch 34
Validation r2 = 0.705794
Epoch 35
Validation r2 = 0.678325
Epoch 36
Validation r2 = 0.688569
Epoch 37
Validation r2 = 0.693613
Epoch 38
Validation r2 = 0.707554
Epoch 39
Validation r2 = 0.680993
Epoch 40
Validation r2 = 0.685781
Epoch 41
Validation r2 = 0.692283
Epoch 42
Validation r2 = 0.687174
Epoch 43
Validation r2 = 0.667289
Epoch 44
Validation r2 = 0.692497
Epoch 45
Validation r2 = 0.704951
Epoch 46
Validation r2 = 0.684552
Epoch 47
Validation r2 = 0.705727
Epoch 48
Validation r2 = 0.696934
Epoch 49
Validation r2 = 0.690836
Epoch 50
Validation r2 = 0.692943
Epoch 51
Validation r2 = 0.689608
Epoch 52
Validation r2 = 0.701048
Epoch 53
Validation r2 = 0.696228
Epoch 54
Validation r2 = 0.702781
Epoch 55
Validation r2 = 0.688062
Epoch 56
Validation r2 = 0.699732
Epoch 57
Validation r2 = 0.698295
Epoch 58
Validation r2 = 0.691310
Epoch 59
Validation r2 = 0.683265
Epoch 60
Validation r2 = 0.684343
Epoch 61
Validation r2 = 0.686024
Epoch 62
Validation r2 = 0.703896
Epoch 63
Validation r2 = 0.692904
Epoch 64
Validation r2 = 0.689954
Epoch 65
Validation r2 = 0.696731
Epoch 66
Validation r2 = 0.691498
Epoch 67
Validation r2 = 0.692596
Epoch 68
Validation r2 = 0.688894
Epoch 69
Validation r2 = 0.698878
Epoch 70
Validation r2 = 0.691846
Epoch 71
Validation r2 = 0.690108
Epoch 72
Validation r2 = 0.688106
Epoch 73
Validation r2 = 0.688012
Epoch 74
Validation r2 = 0.696574
Epoch 75
Validation r2 = 0.681929
Epoch 76
Validation r2 = 0.691183
Epoch 77
Validation r2 = 0.692139
Epoch 78
Validation r2 = 0.687763
Epoch 79
Validation r2 = 0.687602
Epoch 80
Validation r2 = 0.689935
Epoch 81
Validation r2 = 0.686213
Epoch 82
Validation r2 = 0.687728
Epoch 83
Validation r2 = 0.686061
Epoch 84
Validation r2 = 0.687048
Epoch 85
Validation r2 = 0.684505
Epoch 86
Validation r2 = 0.688497
Epoch 87
Validation r2 = 0.684209
Epoch 88
Validation r2 = 0.685962
Epoch 89
Validation r2 = 0.684608
Epoch 90
Validation r2 = 0.683062
Epoch 91
Validation r2 = 0.684770
Epoch 92
Validation r2 = 0.687063
Epoch 93
Validation r2 = 0.684342
Epoch 94
Validation r2 = 0.684461
Epoch 95
Validation r2 = 0.685228
Epoch 96
Validation r2 = 0.684221
Epoch 97
Validation r2 = 0.683929
Epoch 98
Validation r2 = 0.683216
Epoch 99
Validation r2 = 0.682643
Model 1 best validation r2 = 0.707554 on epoch 38
Moving model to cuda
Model 1 test mae = 0.373972
Model 1 test mse = 0.262585
Model 1 test r2 = 0.673650
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.024482
Epoch 1
Validation r2 = 0.059184
Epoch 2
Validation r2 = 0.069702
Epoch 3
Validation r2 = 0.182828
Epoch 4
Validation r2 = 0.267366
Epoch 5
Validation r2 = 0.425852
Epoch 6
Validation r2 = 0.471444
Epoch 7
Validation r2 = 0.550322
Epoch 8
Validation r2 = 0.557590
Epoch 9
Validation r2 = 0.583623
Epoch 10
Validation r2 = 0.583779
Epoch 11
Validation r2 = 0.568794
Epoch 12
Validation r2 = 0.570756
Epoch 13
Validation r2 = 0.585199
Epoch 14
Validation r2 = 0.615370
Epoch 15
Validation r2 = 0.576395
Epoch 16
Validation r2 = 0.617320
Epoch 17
Validation r2 = 0.573494
Epoch 18
Validation r2 = 0.632815
Epoch 19
Validation r2 = 0.602330
Epoch 20
Validation r2 = 0.614765
Epoch 21
Validation r2 = 0.624387
Epoch 22
Validation r2 = 0.588453
Epoch 23
Validation r2 = 0.638958
Epoch 24
Validation r2 = 0.612015
Epoch 25
Validation r2 = 0.599300
Epoch 26
Validation r2 = 0.646265
Epoch 27
Validation r2 = 0.653297
Epoch 28
Validation r2 = 0.662210
Epoch 29
Validation r2 = 0.669292
Epoch 30
Validation r2 = 0.663031
Epoch 31
Validation r2 = 0.619177
Epoch 32
Validation r2 = 0.611132
Epoch 33
Validation r2 = 0.670463
Epoch 34
Validation r2 = 0.653377
Epoch 35
Validation r2 = 0.657561
Epoch 36
Validation r2 = 0.677830
Epoch 37
Validation r2 = 0.681086
Epoch 38
Validation r2 = 0.644521
Epoch 39
Validation r2 = 0.667061
Epoch 40
Validation r2 = 0.664365
Epoch 41
Validation r2 = 0.682803
Epoch 42
Validation r2 = 0.678073
Epoch 43
Validation r2 = 0.643073
Epoch 44
Validation r2 = 0.670987
Epoch 45
Validation r2 = 0.657566
Epoch 46
Validation r2 = 0.652043
Epoch 47
Validation r2 = 0.655918
Epoch 48
Validation r2 = 0.648960
Epoch 49
Validation r2 = 0.654683
Epoch 50
Validation r2 = 0.631241
Epoch 51
Validation r2 = 0.659707
Epoch 52
Validation r2 = 0.658929
Epoch 53
Validation r2 = 0.657559
Epoch 54
Validation r2 = 0.639409
Epoch 55
Validation r2 = 0.660734
Epoch 56
Validation r2 = 0.650403
Epoch 57
Validation r2 = 0.651551
Epoch 58
Validation r2 = 0.658141
Epoch 59
Validation r2 = 0.654759
Epoch 60
Validation r2 = 0.635753
Epoch 61
Validation r2 = 0.645957
Epoch 62
Validation r2 = 0.655885
Epoch 63
Validation r2 = 0.647873
Epoch 64
Validation r2 = 0.641967
Epoch 65
Validation r2 = 0.656515
Epoch 66
Validation r2 = 0.640684
Epoch 67
Validation r2 = 0.652864
Epoch 68
Validation r2 = 0.626235
Epoch 69
Validation r2 = 0.650140
Epoch 70
Validation r2 = 0.649419
Epoch 71
Validation r2 = 0.650392
Epoch 72
Validation r2 = 0.637105
Epoch 73
Validation r2 = 0.634739
Epoch 74
Validation r2 = 0.655557
Epoch 75
Validation r2 = 0.648198
Epoch 76
Validation r2 = 0.641716
Epoch 77
Validation r2 = 0.640986
Epoch 78
Validation r2 = 0.647897
Epoch 79
Validation r2 = 0.641997
Epoch 80
Validation r2 = 0.642321
Epoch 81
Validation r2 = 0.631285
Epoch 82
Validation r2 = 0.641127
Epoch 83
Validation r2 = 0.644000
Epoch 84
Validation r2 = 0.639414
Epoch 85
Validation r2 = 0.642683
Epoch 86
Validation r2 = 0.639765
Epoch 87
Validation r2 = 0.637760
Epoch 88
Validation r2 = 0.642966
Epoch 89
Validation r2 = 0.640866
Epoch 90
Validation r2 = 0.634885
Epoch 91
Validation r2 = 0.642068
Epoch 92
Validation r2 = 0.641231
Epoch 93
Validation r2 = 0.637120
Epoch 94
Validation r2 = 0.632580
Epoch 95
Validation r2 = 0.633945
Epoch 96
Validation r2 = 0.637151
Epoch 97
Validation r2 = 0.640879
Epoch 98
Validation r2 = 0.637815
Epoch 99
Validation r2 = 0.635685
Model 2 best validation r2 = 0.682803 on epoch 41
Moving model to cuda
Model 2 test mae = 0.371971
Model 2 test mse = 0.258858
Model 2 test r2 = 0.678282
Ensemble test mae = 0.352516
Ensemble test mse = 0.241054
Ensemble test r2 = 0.700409
1-fold cross validation
Seed 0 ==> test r2 = 0.700409
Overall test r2 = 0.700409 +/- 0.000000
