Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 254 | train size = 203 | val size = 51 | test size = 63
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.367866
Epoch 1
Validation r2 = -0.150078
Epoch 2
Validation r2 = -0.026703
Epoch 3
Validation r2 = 0.015306
Epoch 4
Validation r2 = 0.028073
Epoch 5
Validation r2 = 0.001648
Epoch 6
Validation r2 = -0.002828
Epoch 7
Validation r2 = 0.076113
Epoch 8
Validation r2 = 0.096883
Epoch 9
Validation r2 = 0.086691
Epoch 10
Validation r2 = 0.113596
Epoch 11
Validation r2 = 0.211795
Epoch 12
Validation r2 = 0.252112
Epoch 13
Validation r2 = 0.256661
Epoch 14
Validation r2 = 0.234220
Epoch 15
Validation r2 = 0.356991
Epoch 16
Validation r2 = 0.093865
Epoch 17
Validation r2 = 0.361417
Epoch 18
Validation r2 = 0.199493
Epoch 19
Validation r2 = 0.337036
Epoch 20
Validation r2 = 0.263931
Epoch 21
Validation r2 = 0.205465
Epoch 22
Validation r2 = 0.274831
Epoch 23
Validation r2 = 0.308824
Epoch 24
Validation r2 = 0.285408
Epoch 25
Validation r2 = 0.305941
Epoch 26
Validation r2 = 0.299392
Epoch 27
Validation r2 = 0.249481
Epoch 28
Validation r2 = 0.231947
Epoch 29
Validation r2 = 0.286211
Epoch 30
Validation r2 = 0.361982
Epoch 31
Validation r2 = 0.405185
Epoch 32
Validation r2 = 0.415837
Epoch 33
Validation r2 = 0.427399
Epoch 34
Validation r2 = 0.427547
Epoch 35
Validation r2 = 0.429917
Epoch 36
Validation r2 = 0.432153
Epoch 37
Validation r2 = 0.437658
Epoch 38
Validation r2 = 0.445942
Epoch 39
Validation r2 = 0.445076
Epoch 40
Validation r2 = 0.440878
Epoch 41
Validation r2 = 0.423036
Epoch 42
Validation r2 = 0.405633
Epoch 43
Validation r2 = 0.406681
Epoch 44
Validation r2 = 0.428714
Epoch 45
Validation r2 = 0.428289
Epoch 46
Validation r2 = 0.437062
Epoch 47
Validation r2 = 0.424872
Epoch 48
Validation r2 = 0.426335
Epoch 49
Validation r2 = 0.448071
Epoch 50
Validation r2 = 0.465029
Epoch 51
Validation r2 = 0.470447
Epoch 52
Validation r2 = 0.470568
Epoch 53
Validation r2 = 0.463053
Epoch 54
Validation r2 = 0.450664
Epoch 55
Validation r2 = 0.461145
Epoch 56
Validation r2 = 0.483913
Epoch 57
Validation r2 = 0.490830
Epoch 58
Validation r2 = 0.493245
Epoch 59
Validation r2 = 0.493430
Epoch 60
Validation r2 = 0.493840
Epoch 61
Validation r2 = 0.497718
Epoch 62
Validation r2 = 0.502920
Epoch 63
Validation r2 = 0.512020
Epoch 64
Validation r2 = 0.515653
Epoch 65
Validation r2 = 0.522650
Epoch 66
Validation r2 = 0.534589
Epoch 67
Validation r2 = 0.546019
Epoch 68
Validation r2 = 0.554323
Epoch 69
Validation r2 = 0.555390
Epoch 70
Validation r2 = 0.560923
Epoch 71
Validation r2 = 0.571827
Epoch 72
Validation r2 = 0.576157
Epoch 73
Validation r2 = 0.574522
Epoch 74
Validation r2 = 0.581630
Epoch 75
Validation r2 = 0.583198
Epoch 76
Validation r2 = 0.577336
Epoch 77
Validation r2 = 0.584007
Epoch 78
Validation r2 = 0.596649
Epoch 79
Validation r2 = 0.606891
Epoch 80
Validation r2 = 0.607375
Epoch 81
Validation r2 = 0.611284
Epoch 82
Validation r2 = 0.620743
Epoch 83
Validation r2 = 0.620612
Epoch 84
Validation r2 = 0.617674
Epoch 85
Validation r2 = 0.615233
Epoch 86
Validation r2 = 0.620989
Epoch 87
Validation r2 = 0.624772
Epoch 88
Validation r2 = 0.625570
Epoch 89
Validation r2 = 0.627076
Epoch 90
Validation r2 = 0.630366
Epoch 91
Validation r2 = 0.634384
Epoch 92
Validation r2 = 0.633378
Epoch 93
Validation r2 = 0.631766
Epoch 94
Validation r2 = 0.636242
Epoch 95
Validation r2 = 0.644533
Epoch 96
Validation r2 = 0.651701
Epoch 97
Validation r2 = 0.652640
Epoch 98
Validation r2 = 0.652925
Epoch 99
Validation r2 = 0.658035
Model 0 best validation r2 = 0.658035 on epoch 99
Moving model to cuda
Model 0 test mae = 0.507899
Model 0 test mse = 0.485554
Model 0 test r2 = 0.449072
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.587437
Epoch 1
Validation r2 = -0.093236
Epoch 2
Validation r2 = -0.020457
Epoch 3
Validation r2 = 0.008756
Epoch 4
Validation r2 = 0.025362
Epoch 5
Validation r2 = 0.033822
Epoch 6
Validation r2 = -0.100153
Epoch 7
Validation r2 = 0.064141
Epoch 8
Validation r2 = 0.047959
Epoch 9
Validation r2 = 0.088586
Epoch 10
Validation r2 = 0.043557
Epoch 11
Validation r2 = 0.038052
Epoch 12
Validation r2 = 0.106718
Epoch 13
Validation r2 = 0.157903
Epoch 14
Validation r2 = 0.176883
Epoch 15
Validation r2 = 0.216259
Epoch 16
Validation r2 = 0.211909
Epoch 17
Validation r2 = 0.277021
Epoch 18
Validation r2 = 0.306173
Epoch 19
Validation r2 = 0.297856
Epoch 20
Validation r2 = 0.366709
Epoch 21
Validation r2 = 0.356208
Epoch 22
Validation r2 = 0.410322
Epoch 23
Validation r2 = 0.241825
Epoch 24
Validation r2 = 0.429826
Epoch 25
Validation r2 = 0.358883
Epoch 26
Validation r2 = 0.406897
Epoch 27
Validation r2 = 0.307322
Epoch 28
Validation r2 = 0.380177
Epoch 29
Validation r2 = 0.404456
Epoch 30
Validation r2 = 0.398337
Epoch 31
Validation r2 = 0.409411
Epoch 32
Validation r2 = 0.379060
Epoch 33
Validation r2 = 0.422480
Epoch 34
Validation r2 = 0.423276
Epoch 35
Validation r2 = 0.409262
Epoch 36
Validation r2 = 0.397156
Epoch 37
Validation r2 = 0.430037
Epoch 38
Validation r2 = 0.432195
Epoch 39
Validation r2 = 0.429120
Epoch 40
Validation r2 = 0.412373
Epoch 41
Validation r2 = 0.420344
Epoch 42
Validation r2 = 0.424946
Epoch 43
Validation r2 = 0.431676
Epoch 44
Validation r2 = 0.431838
Epoch 45
Validation r2 = 0.437252
Epoch 46
Validation r2 = 0.433894
Epoch 47
Validation r2 = 0.441611
Epoch 48
Validation r2 = 0.443738
Epoch 49
Validation r2 = 0.442411
Epoch 50
Validation r2 = 0.446806
Epoch 51
Validation r2 = 0.466283
Epoch 52
Validation r2 = 0.473343
Epoch 53
Validation r2 = 0.478677
Epoch 54
Validation r2 = 0.484986
Epoch 55
Validation r2 = 0.494689
Epoch 56
Validation r2 = 0.512911
Epoch 57
Validation r2 = 0.518043
Epoch 58
Validation r2 = 0.523187
Epoch 59
Validation r2 = 0.522485
Epoch 60
Validation r2 = 0.534638
Epoch 61
Validation r2 = 0.555084
Epoch 62
Validation r2 = 0.557892
Epoch 63
Validation r2 = 0.558370
Epoch 64
Validation r2 = 0.555156
Epoch 65
Validation r2 = 0.530519
Epoch 66
Validation r2 = 0.530198
Epoch 67
Validation r2 = 0.558011
Epoch 68
Validation r2 = 0.567308
Epoch 69
Validation r2 = 0.560755
Epoch 70
Validation r2 = 0.561149
Epoch 71
Validation r2 = 0.566555
Epoch 72
Validation r2 = 0.569473
Epoch 73
Validation r2 = 0.568783
Epoch 74
Validation r2 = 0.577085
Epoch 75
Validation r2 = 0.590099
Epoch 76
Validation r2 = 0.601799
Epoch 77
Validation r2 = 0.612817
Epoch 78
Validation r2 = 0.621096
Epoch 79
Validation r2 = 0.630611
Epoch 80
Validation r2 = 0.643551
Epoch 81
Validation r2 = 0.648016
Epoch 82
Validation r2 = 0.652202
Epoch 83
Validation r2 = 0.655429
Epoch 84
Validation r2 = 0.663345
Epoch 85
Validation r2 = 0.667960
Epoch 86
Validation r2 = 0.672615
Epoch 87
Validation r2 = 0.675834
Epoch 88
Validation r2 = 0.676919
Epoch 89
Validation r2 = 0.674178
Epoch 90
Validation r2 = 0.675624
Epoch 91
Validation r2 = 0.677973
Epoch 92
Validation r2 = 0.677862
Epoch 93
Validation r2 = 0.678600
Epoch 94
Validation r2 = 0.679183
Epoch 95
Validation r2 = 0.675269
Epoch 96
Validation r2 = 0.679943
Epoch 97
Validation r2 = 0.687294
Epoch 98
Validation r2 = 0.693610
Epoch 99
Validation r2 = 0.699678
Model 1 best validation r2 = 0.699678 on epoch 99
Moving model to cuda
Model 1 test mae = 0.495927
Model 1 test mse = 0.471490
Model 1 test r2 = 0.465030
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.142779
Epoch 1
Validation r2 = -0.383870
Epoch 2
Validation r2 = 0.010272
Epoch 3
Validation r2 = -0.002578
Epoch 4
Validation r2 = 0.034862
Epoch 5
Validation r2 = -0.018841
Epoch 6
Validation r2 = 0.002215
Epoch 7
Validation r2 = 0.064928
Epoch 8
Validation r2 = 0.084558
Epoch 9
Validation r2 = 0.103488
Epoch 10
Validation r2 = 0.107800
Epoch 11
Validation r2 = 0.140127
Epoch 12
Validation r2 = 0.195734
Epoch 13
Validation r2 = 0.217698
Epoch 14
Validation r2 = 0.283834
Epoch 15
Validation r2 = 0.247872
Epoch 16
Validation r2 = 0.319009
Epoch 17
Validation r2 = 0.280537
Epoch 18
Validation r2 = 0.342935
Epoch 19
Validation r2 = 0.157150
Epoch 20
Validation r2 = 0.227414
Epoch 21
Validation r2 = 0.339660
Epoch 22
Validation r2 = 0.280939
Epoch 23
Validation r2 = 0.323261
Epoch 24
Validation r2 = 0.257784
Epoch 25
Validation r2 = 0.152359
Epoch 26
Validation r2 = 0.251971
Epoch 27
Validation r2 = 0.341940
Epoch 28
Validation r2 = 0.353413
Epoch 29
Validation r2 = 0.368453
Epoch 30
Validation r2 = 0.364669
Epoch 31
Validation r2 = 0.350239
Epoch 32
Validation r2 = 0.365592
Epoch 33
Validation r2 = 0.406443
Epoch 34
Validation r2 = 0.412870
Epoch 35
Validation r2 = 0.408863
Epoch 36
Validation r2 = 0.417093
Epoch 37
Validation r2 = 0.403580
Epoch 38
Validation r2 = 0.391511
Epoch 39
Validation r2 = 0.394539
Epoch 40
Validation r2 = 0.423584
Epoch 41
Validation r2 = 0.431552
Epoch 42
Validation r2 = 0.434751
Epoch 43
Validation r2 = 0.422023
Epoch 44
Validation r2 = 0.418596
Epoch 45
Validation r2 = 0.445346
Epoch 46
Validation r2 = 0.469095
Epoch 47
Validation r2 = 0.480094
Epoch 48
Validation r2 = 0.490270
Epoch 49
Validation r2 = 0.498157
Epoch 50
Validation r2 = 0.485035
Epoch 51
Validation r2 = 0.465875
Epoch 52
Validation r2 = 0.496364
Epoch 53
Validation r2 = 0.521513
Epoch 54
Validation r2 = 0.523878
Epoch 55
Validation r2 = 0.527483
Epoch 56
Validation r2 = 0.522102
Epoch 57
Validation r2 = 0.526395
Epoch 58
Validation r2 = 0.529672
Epoch 59
Validation r2 = 0.540921
Epoch 60
Validation r2 = 0.562660
Epoch 61
Validation r2 = 0.578382
Epoch 62
Validation r2 = 0.589971
Epoch 63
Validation r2 = 0.595472
Epoch 64
Validation r2 = 0.600015
Epoch 65
Validation r2 = 0.601765
Epoch 66
Validation r2 = 0.604718
Epoch 67
Validation r2 = 0.611939
Epoch 68
Validation r2 = 0.630105
Epoch 69
Validation r2 = 0.633670
Epoch 70
Validation r2 = 0.635801
Epoch 71
Validation r2 = 0.645011
Epoch 72
Validation r2 = 0.646220
Epoch 73
Validation r2 = 0.643036
Epoch 74
Validation r2 = 0.644207
Epoch 75
Validation r2 = 0.642904
Epoch 76
Validation r2 = 0.641512
Epoch 77
Validation r2 = 0.656674
Epoch 78
Validation r2 = 0.668718
Epoch 79
Validation r2 = 0.673288
Epoch 80
Validation r2 = 0.686814
Epoch 81
Validation r2 = 0.701989
Epoch 82
Validation r2 = 0.704116
Epoch 83
Validation r2 = 0.705826
Epoch 84
Validation r2 = 0.704263
Epoch 85
Validation r2 = 0.701271
Epoch 86
Validation r2 = 0.711904
Epoch 87
Validation r2 = 0.723296
Epoch 88
Validation r2 = 0.725351
Epoch 89
Validation r2 = 0.725297
Epoch 90
Validation r2 = 0.729311
Epoch 91
Validation r2 = 0.727094
Epoch 92
Validation r2 = 0.716780
Epoch 93
Validation r2 = 0.713934
Epoch 94
Validation r2 = 0.719519
Epoch 95
Validation r2 = 0.723545
Epoch 96
Validation r2 = 0.729029
Epoch 97
Validation r2 = 0.738517
Epoch 98
Validation r2 = 0.745042
Epoch 99
Validation r2 = 0.743125
Model 2 best validation r2 = 0.745042 on epoch 98
Moving model to cuda
Model 2 test mae = 0.449020
Model 2 test mse = 0.396676
Model 2 test r2 = 0.549916
Ensemble test mae = 0.481321
Ensemble test mse = 0.446476
Ensemble test r2 = 0.493411
1-fold cross validation
Seed 0 ==> test r2 = 0.493411
Overall test r2 = 0.493411 +/- 0.000000
