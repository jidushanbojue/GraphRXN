Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,247 | train size = 997 | val size = 250 | test size = 311
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = 0.024147
Epoch 1
Validation r2 = 0.063482
Epoch 2
Validation r2 = 0.055116
Epoch 3
Validation r2 = 0.085226
Epoch 4
Validation r2 = 0.091264
Epoch 5
Validation r2 = 0.132380
Epoch 6
Validation r2 = 0.191163
Epoch 7
Validation r2 = 0.136499
Epoch 8
Validation r2 = 0.238010
Epoch 9
Validation r2 = 0.178814
Epoch 10
Validation r2 = 0.371487
Epoch 11
Validation r2 = 0.395725
Epoch 12
Validation r2 = 0.283513
Epoch 13
Validation r2 = 0.322402
Epoch 14
Validation r2 = 0.444746
Epoch 15
Validation r2 = 0.461318
Epoch 16
Validation r2 = 0.517953
Epoch 17
Validation r2 = 0.500177
Epoch 18
Validation r2 = 0.455494
Epoch 19
Validation r2 = 0.496685
Epoch 20
Validation r2 = 0.480920
Epoch 21
Validation r2 = 0.500248
Epoch 22
Validation r2 = 0.502464
Epoch 23
Validation r2 = 0.510415
Epoch 24
Validation r2 = 0.467582
Epoch 25
Validation r2 = 0.553153
Epoch 26
Validation r2 = 0.547636
Epoch 27
Validation r2 = 0.557198
Epoch 28
Validation r2 = 0.516409
Epoch 29
Validation r2 = 0.507934
Epoch 30
Validation r2 = 0.568061
Epoch 31
Validation r2 = 0.600013
Epoch 32
Validation r2 = 0.553832
Epoch 33
Validation r2 = 0.565739
Epoch 34
Validation r2 = 0.553021
Epoch 35
Validation r2 = 0.552341
Epoch 36
Validation r2 = 0.560057
Epoch 37
Validation r2 = 0.580599
Epoch 38
Validation r2 = 0.572227
Epoch 39
Validation r2 = 0.574790
Epoch 40
Validation r2 = 0.599541
Epoch 41
Validation r2 = 0.614112
Epoch 42
Validation r2 = 0.573062
Epoch 43
Validation r2 = 0.569734
Epoch 44
Validation r2 = 0.593740
Epoch 45
Validation r2 = 0.641547
Epoch 46
Validation r2 = 0.604775
Epoch 47
Validation r2 = 0.646660
Epoch 48
Validation r2 = 0.618347
Epoch 49
Validation r2 = 0.625507
Epoch 50
Validation r2 = 0.657480
Epoch 51
Validation r2 = 0.635453
Epoch 52
Validation r2 = 0.653457
Epoch 53
Validation r2 = 0.654582
Epoch 54
Validation r2 = 0.639192
Epoch 55
Validation r2 = 0.646334
Epoch 56
Validation r2 = 0.625842
Epoch 57
Validation r2 = 0.634559
Epoch 58
Validation r2 = 0.660751
Epoch 59
Validation r2 = 0.675402
Epoch 60
Validation r2 = 0.660252
Epoch 61
Validation r2 = 0.662876
Epoch 62
Validation r2 = 0.669703
Epoch 63
Validation r2 = 0.658797
Epoch 64
Validation r2 = 0.669155
Epoch 65
Validation r2 = 0.668372
Epoch 66
Validation r2 = 0.688173
Epoch 67
Validation r2 = 0.677272
Epoch 68
Validation r2 = 0.661028
Epoch 69
Validation r2 = 0.685060
Epoch 70
Validation r2 = 0.678684
Epoch 71
Validation r2 = 0.673598
Epoch 72
Validation r2 = 0.675731
Epoch 73
Validation r2 = 0.693626
Epoch 74
Validation r2 = 0.670415
Epoch 75
Validation r2 = 0.683199
Epoch 76
Validation r2 = 0.681255
Epoch 77
Validation r2 = 0.680186
Epoch 78
Validation r2 = 0.671494
Epoch 79
Validation r2 = 0.684386
Epoch 80
Validation r2 = 0.675841
Epoch 81
Validation r2 = 0.673876
Epoch 82
Validation r2 = 0.679973
Epoch 83
Validation r2 = 0.664144
Epoch 84
Validation r2 = 0.688457
Epoch 85
Validation r2 = 0.677690
Epoch 86
Validation r2 = 0.681456
Epoch 87
Validation r2 = 0.676001
Epoch 88
Validation r2 = 0.678901
Epoch 89
Validation r2 = 0.674805
Epoch 90
Validation r2 = 0.679272
Epoch 91
Validation r2 = 0.670948
Epoch 92
Validation r2 = 0.682777
Epoch 93
Validation r2 = 0.676872
Epoch 94
Validation r2 = 0.670180
Epoch 95
Validation r2 = 0.672718
Epoch 96
Validation r2 = 0.667665
Epoch 97
Validation r2 = 0.670242
Epoch 98
Validation r2 = 0.663165
Epoch 99
Validation r2 = 0.659918
Model 0 best validation r2 = 0.693626 on epoch 73
Moving model to cuda
Model 0 test mae = 0.408186
Model 0 test mse = 0.380423
Model 0 test r2 = 0.662517
Ensemble test mae = 0.408186
Ensemble test mse = 0.380423
Ensemble test r2 = 0.662517
1-fold cross validation
Seed 0 ==> test r2 = 0.662517
Overall test r2 = 0.662517 +/- 0.000000
