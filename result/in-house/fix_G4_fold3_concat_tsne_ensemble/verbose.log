Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 337 | train size = 269 | val size = 68 | test size = 84
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.004437
Epoch 1
Validation r2 = 0.010270
Epoch 2
Validation r2 = -0.028825
Epoch 3
Validation r2 = -0.022458
Epoch 4
Validation r2 = 0.019955
Epoch 5
Validation r2 = 0.037945
Epoch 6
Validation r2 = 0.065221
Epoch 7
Validation r2 = 0.073264
Epoch 8
Validation r2 = 0.113952
Epoch 9
Validation r2 = 0.113050
Epoch 10
Validation r2 = 0.140239
Epoch 11
Validation r2 = 0.118796
Epoch 12
Validation r2 = 0.113103
Epoch 13
Validation r2 = 0.167557
Epoch 14
Validation r2 = 0.182821
Epoch 15
Validation r2 = 0.205716
Epoch 16
Validation r2 = 0.244252
Epoch 17
Validation r2 = 0.231488
Epoch 18
Validation r2 = 0.305404
Epoch 19
Validation r2 = 0.295128
Epoch 20
Validation r2 = 0.329296
Epoch 21
Validation r2 = 0.336079
Epoch 22
Validation r2 = 0.380383
Epoch 23
Validation r2 = 0.320506
Epoch 24
Validation r2 = 0.401413
Epoch 25
Validation r2 = 0.352815
Epoch 26
Validation r2 = 0.409400
Epoch 27
Validation r2 = 0.394646
Epoch 28
Validation r2 = 0.343863
Epoch 29
Validation r2 = 0.394670
Epoch 30
Validation r2 = 0.330340
Epoch 31
Validation r2 = 0.379771
Epoch 32
Validation r2 = 0.361394
Epoch 33
Validation r2 = 0.396541
Epoch 34
Validation r2 = 0.321780
Epoch 35
Validation r2 = 0.248598
Epoch 36
Validation r2 = 0.317999
Epoch 37
Validation r2 = 0.298900
Epoch 38
Validation r2 = 0.318024
Epoch 39
Validation r2 = 0.281899
Epoch 40
Validation r2 = 0.232452
Epoch 41
Validation r2 = 0.247984
Epoch 42
Validation r2 = 0.280489
Epoch 43
Validation r2 = 0.286948
Epoch 44
Validation r2 = 0.256861
Epoch 45
Validation r2 = 0.230048
Epoch 46
Validation r2 = 0.224530
Epoch 47
Validation r2 = 0.242271
Epoch 48
Validation r2 = 0.232644
Epoch 49
Validation r2 = 0.149087
Epoch 50
Validation r2 = 0.245200
Epoch 51
Validation r2 = 0.272210
Epoch 52
Validation r2 = 0.184030
Epoch 53
Validation r2 = 0.288475
Epoch 54
Validation r2 = 0.195325
Epoch 55
Validation r2 = 0.280062
Epoch 56
Validation r2 = 0.166628
Epoch 57
Validation r2 = 0.256051
Epoch 58
Validation r2 = 0.193326
Epoch 59
Validation r2 = 0.315776
Epoch 60
Validation r2 = 0.282244
Epoch 61
Validation r2 = 0.274304
Epoch 62
Validation r2 = 0.195288
Epoch 63
Validation r2 = 0.220775
Epoch 64
Validation r2 = 0.176588
Epoch 65
Validation r2 = 0.284735
Epoch 66
Validation r2 = 0.305254
Epoch 67
Validation r2 = 0.281781
Epoch 68
Validation r2 = 0.282852
Epoch 69
Validation r2 = 0.239562
Epoch 70
Validation r2 = 0.273984
Epoch 71
Validation r2 = 0.282092
Epoch 72
Validation r2 = 0.281268
Epoch 73
Validation r2 = 0.301180
Epoch 74
Validation r2 = 0.279942
Epoch 75
Validation r2 = 0.285624
Epoch 76
Validation r2 = 0.273342
Epoch 77
Validation r2 = 0.265242
Epoch 78
Validation r2 = 0.279970
Epoch 79
Validation r2 = 0.289749
Epoch 80
Validation r2 = 0.293914
Epoch 81
Validation r2 = 0.290362
Epoch 82
Validation r2 = 0.292139
Epoch 83
Validation r2 = 0.296810
Epoch 84
Validation r2 = 0.295330
Epoch 85
Validation r2 = 0.298526
Epoch 86
Validation r2 = 0.308016
Epoch 87
Validation r2 = 0.304082
Epoch 88
Validation r2 = 0.305569
Epoch 89
Validation r2 = 0.283075
Epoch 90
Validation r2 = 0.299673
Epoch 91
Validation r2 = 0.304083
Epoch 92
Validation r2 = 0.330878
Epoch 93
Validation r2 = 0.330167
Epoch 94
Validation r2 = 0.306174
Epoch 95
Validation r2 = 0.306697
Epoch 96
Validation r2 = 0.296142
Epoch 97
Validation r2 = 0.308677
Epoch 98
Validation r2 = 0.315168
Epoch 99
Validation r2 = 0.323718
Model 0 best validation r2 = 0.409400 on epoch 26
Moving model to cuda
Model 0 test mae = 0.665187
Model 0 test mse = 0.745351
Model 0 test r2 = 0.399743
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.010016
Epoch 1
Validation r2 = 0.002273
Epoch 2
Validation r2 = 0.007700
Epoch 3
Validation r2 = 0.011780
Epoch 4
Validation r2 = -0.011862
Epoch 5
Validation r2 = 0.016094
Epoch 6
Validation r2 = 0.030786
Epoch 7
Validation r2 = 0.029845
Epoch 8
Validation r2 = 0.054035
Epoch 9
Validation r2 = 0.069189
Epoch 10
Validation r2 = 0.080842
Epoch 11
Validation r2 = 0.107483
Epoch 12
Validation r2 = 0.114866
Epoch 13
Validation r2 = 0.121148
Epoch 14
Validation r2 = 0.122982
Epoch 15
Validation r2 = 0.117706
Epoch 16
Validation r2 = 0.147955
Epoch 17
Validation r2 = 0.123408
Epoch 18
Validation r2 = 0.139355
Epoch 19
Validation r2 = 0.153859
Epoch 20
Validation r2 = 0.210301
Epoch 21
Validation r2 = 0.231131
Epoch 22
Validation r2 = 0.161297
Epoch 23
Validation r2 = 0.261170
Epoch 24
Validation r2 = 0.268632
Epoch 25
Validation r2 = 0.278350
Epoch 26
Validation r2 = 0.299048
Epoch 27
Validation r2 = 0.376104
Epoch 28
Validation r2 = 0.378996
Epoch 29
Validation r2 = 0.362044
Epoch 30
Validation r2 = 0.401838
Epoch 31
Validation r2 = 0.437855
Epoch 32
Validation r2 = 0.446042
Epoch 33
Validation r2 = 0.400086
Epoch 34
Validation r2 = 0.401609
Epoch 35
Validation r2 = 0.408096
Epoch 36
Validation r2 = 0.322272
Epoch 37
Validation r2 = 0.369714
Epoch 38
Validation r2 = 0.362297
Epoch 39
Validation r2 = 0.368804
Epoch 40
Validation r2 = 0.324785
Epoch 41
Validation r2 = 0.257857
Epoch 42
Validation r2 = 0.324536
Epoch 43
Validation r2 = 0.312282
Epoch 44
Validation r2 = 0.241011
Epoch 45
Validation r2 = 0.252898
Epoch 46
Validation r2 = 0.289825
Epoch 47
Validation r2 = 0.329867
Epoch 48
Validation r2 = 0.273876
Epoch 49
Validation r2 = 0.241827
Epoch 50
Validation r2 = 0.298781
Epoch 51
Validation r2 = 0.290225
Epoch 52
Validation r2 = 0.312482
Epoch 53
Validation r2 = 0.239673
Epoch 54
Validation r2 = 0.274904
Epoch 55
Validation r2 = 0.216236
Epoch 56
Validation r2 = 0.279742
Epoch 57
Validation r2 = 0.368780
Epoch 58
Validation r2 = 0.384099
Epoch 59
Validation r2 = 0.427266
Epoch 60
Validation r2 = 0.277779
Epoch 61
Validation r2 = 0.122258
Epoch 62
Validation r2 = 0.299662
Epoch 63
Validation r2 = 0.344975
Epoch 64
Validation r2 = 0.295752
Epoch 65
Validation r2 = 0.341175
Epoch 66
Validation r2 = 0.294480
Epoch 67
Validation r2 = 0.303793
Epoch 68
Validation r2 = 0.293801
Epoch 69
Validation r2 = 0.285216
Epoch 70
Validation r2 = 0.309425
Epoch 71
Validation r2 = 0.262549
Epoch 72
Validation r2 = 0.237815
Epoch 73
Validation r2 = 0.290439
Epoch 74
Validation r2 = 0.288308
Epoch 75
Validation r2 = 0.321165
Epoch 76
Validation r2 = 0.267956
Epoch 77
Validation r2 = 0.280833
Epoch 78
Validation r2 = 0.287051
Epoch 79
Validation r2 = 0.284815
Epoch 80
Validation r2 = 0.281673
Epoch 81
Validation r2 = 0.302038
Epoch 82
Validation r2 = 0.288254
Epoch 83
Validation r2 = 0.298786
Epoch 84
Validation r2 = 0.312368
Epoch 85
Validation r2 = 0.308238
Epoch 86
Validation r2 = 0.308418
Epoch 87
Validation r2 = 0.254550
Epoch 88
Validation r2 = 0.323983
Epoch 89
Validation r2 = 0.270355
Epoch 90
Validation r2 = 0.320531
Epoch 91
Validation r2 = 0.310950
Epoch 92
Validation r2 = 0.290282
Epoch 93
Validation r2 = 0.296546
Epoch 94
Validation r2 = 0.254133
Epoch 95
Validation r2 = 0.301380
Epoch 96
Validation r2 = 0.256739
Epoch 97
Validation r2 = 0.301469
Epoch 98
Validation r2 = 0.259031
Epoch 99
Validation r2 = 0.330241
Model 1 best validation r2 = 0.446042 on epoch 32
Moving model to cuda
Model 1 test mae = 0.649241
Model 1 test mse = 0.736000
Model 1 test r2 = 0.407274
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.013348
Epoch 1
Validation r2 = -0.058847
Epoch 2
Validation r2 = -0.006822
Epoch 3
Validation r2 = 0.008459
Epoch 4
Validation r2 = 0.006648
Epoch 5
Validation r2 = 0.027837
Epoch 6
Validation r2 = 0.050436
Epoch 7
Validation r2 = 0.050876
Epoch 8
Validation r2 = 0.090112
Epoch 9
Validation r2 = 0.100263
Epoch 10
Validation r2 = 0.113943
Epoch 11
Validation r2 = 0.103964
Epoch 12
Validation r2 = 0.100315
Epoch 13
Validation r2 = 0.070551
Epoch 14
Validation r2 = 0.164626
Epoch 15
Validation r2 = 0.181714
Epoch 16
Validation r2 = 0.226105
Epoch 17
Validation r2 = 0.195791
Epoch 18
Validation r2 = 0.276420
Epoch 19
Validation r2 = 0.303712
Epoch 20
Validation r2 = 0.283083
Epoch 21
Validation r2 = 0.376448
Epoch 22
Validation r2 = 0.323301
Epoch 23
Validation r2 = 0.400978
Epoch 24
Validation r2 = 0.380247
Epoch 25
Validation r2 = 0.406028
Epoch 26
Validation r2 = 0.463050
Epoch 27
Validation r2 = 0.437721
Epoch 28
Validation r2 = 0.471217
Epoch 29
Validation r2 = 0.433014
Epoch 30
Validation r2 = 0.451913
Epoch 31
Validation r2 = 0.458304
Epoch 32
Validation r2 = 0.460477
Epoch 33
Validation r2 = 0.363737
Epoch 34
Validation r2 = 0.425640
Epoch 35
Validation r2 = 0.421632
Epoch 36
Validation r2 = 0.421380
Epoch 37
Validation r2 = 0.382994
Epoch 38
Validation r2 = 0.379868
Epoch 39
Validation r2 = 0.397840
Epoch 40
Validation r2 = 0.377687
Epoch 41
Validation r2 = 0.373175
Epoch 42
Validation r2 = 0.347066
Epoch 43
Validation r2 = 0.415650
Epoch 44
Validation r2 = 0.447522
Epoch 45
Validation r2 = 0.403127
Epoch 46
Validation r2 = 0.391219
Epoch 47
Validation r2 = 0.399987
Epoch 48
Validation r2 = 0.373917
Epoch 49
Validation r2 = 0.421290
Epoch 50
Validation r2 = 0.410584
Epoch 51
Validation r2 = 0.438414
Epoch 52
Validation r2 = 0.376378
Epoch 53
Validation r2 = 0.417362
Epoch 54
Validation r2 = 0.458147
Epoch 55
Validation r2 = 0.337314
Epoch 56
Validation r2 = 0.419018
Epoch 57
Validation r2 = 0.374535
Epoch 58
Validation r2 = 0.408048
Epoch 59
Validation r2 = 0.462917
Epoch 60
Validation r2 = 0.430411
Epoch 61
Validation r2 = 0.414752
Epoch 62
Validation r2 = 0.423068
Epoch 63
Validation r2 = 0.440965
Epoch 64
Validation r2 = 0.423184
Epoch 65
Validation r2 = 0.424527
Epoch 66
Validation r2 = 0.402960
Epoch 67
Validation r2 = 0.442039
Epoch 68
Validation r2 = 0.387170
Epoch 69
Validation r2 = 0.429670
Epoch 70
Validation r2 = 0.411531
Epoch 71
Validation r2 = 0.443077
Epoch 72
Validation r2 = 0.447234
Epoch 73
Validation r2 = 0.457082
Epoch 74
Validation r2 = 0.459973
Epoch 75
Validation r2 = 0.453643
Epoch 76
Validation r2 = 0.428681
Epoch 77
Validation r2 = 0.443742
Epoch 78
Validation r2 = 0.458595
Epoch 79
Validation r2 = 0.447417
Epoch 80
Validation r2 = 0.461766
Epoch 81
Validation r2 = 0.442415
Epoch 82
Validation r2 = 0.432699
Epoch 83
Validation r2 = 0.430439
Epoch 84
Validation r2 = 0.465236
Epoch 85
Validation r2 = 0.450465
Epoch 86
Validation r2 = 0.457442
Epoch 87
Validation r2 = 0.438050
Epoch 88
Validation r2 = 0.438080
Epoch 89
Validation r2 = 0.430523
Epoch 90
Validation r2 = 0.449132
Epoch 91
Validation r2 = 0.447680
Epoch 92
Validation r2 = 0.433385
Epoch 93
Validation r2 = 0.416310
Epoch 94
Validation r2 = 0.428250
Epoch 95
Validation r2 = 0.425943
Epoch 96
Validation r2 = 0.409288
Epoch 97
Validation r2 = 0.412026
Epoch 98
Validation r2 = 0.445485
Epoch 99
Validation r2 = 0.428745
Model 2 best validation r2 = 0.471217 on epoch 28
Moving model to cuda
Model 2 test mae = 0.658700
Model 2 test mse = 0.702781
Model 2 test r2 = 0.434026
Ensemble test mae = 0.653633
Ensemble test mse = 0.718937
Ensemble test r2 = 0.421015
1-fold cross validation
Seed 0 ==> test r2 = 0.421015
Overall test r2 = 0.421015 +/- 0.000000
