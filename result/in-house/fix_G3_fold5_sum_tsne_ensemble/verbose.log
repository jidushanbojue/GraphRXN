Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 321 | train size = 256 | val size = 65 | test size = 80
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = 0.012096
Epoch 1
Validation r2 = 0.011512
Epoch 2
Validation r2 = -0.190910
Epoch 3
Validation r2 = -0.029041
Epoch 4
Validation r2 = 0.009197
Epoch 5
Validation r2 = 0.033247
Epoch 6
Validation r2 = 0.043206
Epoch 7
Validation r2 = 0.071800
Epoch 8
Validation r2 = 0.077685
Epoch 9
Validation r2 = 0.142669
Epoch 10
Validation r2 = 0.197288
Epoch 11
Validation r2 = 0.215135
Epoch 12
Validation r2 = 0.258352
Epoch 13
Validation r2 = 0.236317
Epoch 14
Validation r2 = 0.368857
Epoch 15
Validation r2 = 0.401773
Epoch 16
Validation r2 = 0.351263
Epoch 17
Validation r2 = 0.425039
Epoch 18
Validation r2 = 0.477011
Epoch 19
Validation r2 = 0.494468
Epoch 20
Validation r2 = 0.535850
Epoch 21
Validation r2 = 0.547585
Epoch 22
Validation r2 = 0.576051
Epoch 23
Validation r2 = 0.605345
Epoch 24
Validation r2 = 0.389347
Epoch 25
Validation r2 = 0.600877
Epoch 26
Validation r2 = 0.498432
Epoch 27
Validation r2 = 0.622785
Epoch 28
Validation r2 = 0.574269
Epoch 29
Validation r2 = 0.665881
Epoch 30
Validation r2 = 0.648014
Epoch 31
Validation r2 = 0.681217
Epoch 32
Validation r2 = 0.668154
Epoch 33
Validation r2 = 0.687216
Epoch 34
Validation r2 = 0.682129
Epoch 35
Validation r2 = 0.696073
Epoch 36
Validation r2 = 0.683315
Epoch 37
Validation r2 = 0.706474
Epoch 38
Validation r2 = 0.704890
Epoch 39
Validation r2 = 0.711197
Epoch 40
Validation r2 = 0.719955
Epoch 41
Validation r2 = 0.717727
Epoch 42
Validation r2 = 0.716513
Epoch 43
Validation r2 = 0.731450
Epoch 44
Validation r2 = 0.735416
Epoch 45
Validation r2 = 0.714348
Epoch 46
Validation r2 = 0.744507
Epoch 47
Validation r2 = 0.726936
Epoch 48
Validation r2 = 0.749700
Epoch 49
Validation r2 = 0.734705
Epoch 50
Validation r2 = 0.756440
Epoch 51
Validation r2 = 0.758979
Epoch 52
Validation r2 = 0.752567
Epoch 53
Validation r2 = 0.763609
Epoch 54
Validation r2 = 0.767722
Epoch 55
Validation r2 = 0.769491
Epoch 56
Validation r2 = 0.774416
Epoch 57
Validation r2 = 0.778059
Epoch 58
Validation r2 = 0.777089
Epoch 59
Validation r2 = 0.770645
Epoch 60
Validation r2 = 0.782209
Epoch 61
Validation r2 = 0.773931
Epoch 62
Validation r2 = 0.781868
Epoch 63
Validation r2 = 0.770472
Epoch 64
Validation r2 = 0.789076
Epoch 65
Validation r2 = 0.782518
Epoch 66
Validation r2 = 0.782615
Epoch 67
Validation r2 = 0.789612
Epoch 68
Validation r2 = 0.767166
Epoch 69
Validation r2 = 0.793982
Epoch 70
Validation r2 = 0.780559
Epoch 71
Validation r2 = 0.798505
Epoch 72
Validation r2 = 0.799697
Epoch 73
Validation r2 = 0.794527
Epoch 74
Validation r2 = 0.801892
Epoch 75
Validation r2 = 0.802998
Epoch 76
Validation r2 = 0.786294
Epoch 77
Validation r2 = 0.805573
Epoch 78
Validation r2 = 0.804636
Epoch 79
Validation r2 = 0.803107
Epoch 80
Validation r2 = 0.808322
Epoch 81
Validation r2 = 0.801253
Epoch 82
Validation r2 = 0.806663
Epoch 83
Validation r2 = 0.803485
Epoch 84
Validation r2 = 0.811924
Epoch 85
Validation r2 = 0.812422
Epoch 86
Validation r2 = 0.804358
Epoch 87
Validation r2 = 0.811214
Epoch 88
Validation r2 = 0.808774
Epoch 89
Validation r2 = 0.816294
Epoch 90
Validation r2 = 0.816709
Epoch 91
Validation r2 = 0.817128
Epoch 92
Validation r2 = 0.811906
Epoch 93
Validation r2 = 0.817977
Epoch 94
Validation r2 = 0.817038
Epoch 95
Validation r2 = 0.809537
Epoch 96
Validation r2 = 0.820586
Epoch 97
Validation r2 = 0.820036
Epoch 98
Validation r2 = 0.812486
Epoch 99
Validation r2 = 0.822702
Model 0 best validation r2 = 0.822702 on epoch 99
Moving model to cuda
Model 0 test mae = 0.395915
Model 0 test mse = 0.269846
Model 0 test r2 = 0.746778
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.003001
Epoch 1
Validation r2 = -0.002380
Epoch 2
Validation r2 = -0.040998
Epoch 3
Validation r2 = 0.019788
Epoch 4
Validation r2 = 0.048566
Epoch 5
Validation r2 = 0.089036
Epoch 6
Validation r2 = -0.092359
Epoch 7
Validation r2 = 0.055902
Epoch 8
Validation r2 = 0.147459
Epoch 9
Validation r2 = 0.073347
Epoch 10
Validation r2 = 0.198692
Epoch 11
Validation r2 = 0.241826
Epoch 12
Validation r2 = 0.196661
Epoch 13
Validation r2 = 0.297824
Epoch 14
Validation r2 = 0.355602
Epoch 15
Validation r2 = 0.396371
Epoch 16
Validation r2 = 0.470430
Epoch 17
Validation r2 = 0.463690
Epoch 18
Validation r2 = 0.565483
Epoch 19
Validation r2 = 0.571918
Epoch 20
Validation r2 = 0.607618
Epoch 21
Validation r2 = 0.638963
Epoch 22
Validation r2 = 0.610980
Epoch 23
Validation r2 = 0.650402
Epoch 24
Validation r2 = 0.603771
Epoch 25
Validation r2 = 0.660505
Epoch 26
Validation r2 = 0.648673
Epoch 27
Validation r2 = 0.655937
Epoch 28
Validation r2 = 0.685219
Epoch 29
Validation r2 = 0.665393
Epoch 30
Validation r2 = 0.699852
Epoch 31
Validation r2 = 0.704365
Epoch 32
Validation r2 = 0.700742
Epoch 33
Validation r2 = 0.716256
Epoch 34
Validation r2 = 0.713648
Epoch 35
Validation r2 = 0.732093
Epoch 36
Validation r2 = 0.649060
Epoch 37
Validation r2 = 0.657508
Epoch 38
Validation r2 = 0.641856
Epoch 39
Validation r2 = 0.723739
Epoch 40
Validation r2 = 0.717171
Epoch 41
Validation r2 = 0.752550
Epoch 42
Validation r2 = 0.756769
Epoch 43
Validation r2 = 0.732479
Epoch 44
Validation r2 = 0.761518
Epoch 45
Validation r2 = 0.767250
Epoch 46
Validation r2 = 0.754169
Epoch 47
Validation r2 = 0.773452
Epoch 48
Validation r2 = 0.766816
Epoch 49
Validation r2 = 0.780466
Epoch 50
Validation r2 = 0.779344
Epoch 51
Validation r2 = 0.765140
Epoch 52
Validation r2 = 0.771372
Epoch 53
Validation r2 = 0.757363
Epoch 54
Validation r2 = 0.789424
Epoch 55
Validation r2 = 0.792410
Epoch 56
Validation r2 = 0.793767
Epoch 57
Validation r2 = 0.794782
Epoch 58
Validation r2 = 0.796875
Epoch 59
Validation r2 = 0.799950
Epoch 60
Validation r2 = 0.801006
Epoch 61
Validation r2 = 0.802324
Epoch 62
Validation r2 = 0.797942
Epoch 63
Validation r2 = 0.803662
Epoch 64
Validation r2 = 0.791583
Epoch 65
Validation r2 = 0.807576
Epoch 66
Validation r2 = 0.801201
Epoch 67
Validation r2 = 0.780980
Epoch 68
Validation r2 = 0.806007
Epoch 69
Validation r2 = 0.811365
Epoch 70
Validation r2 = 0.800662
Epoch 71
Validation r2 = 0.806746
Epoch 72
Validation r2 = 0.803543
Epoch 73
Validation r2 = 0.817144
Epoch 74
Validation r2 = 0.817827
Epoch 75
Validation r2 = 0.817358
Epoch 76
Validation r2 = 0.818790
Epoch 77
Validation r2 = 0.820997
Epoch 78
Validation r2 = 0.819747
Epoch 79
Validation r2 = 0.820580
Epoch 80
Validation r2 = 0.820815
Epoch 81
Validation r2 = 0.822889
Epoch 82
Validation r2 = 0.823873
Epoch 83
Validation r2 = 0.825015
Epoch 84
Validation r2 = 0.825896
Epoch 85
Validation r2 = 0.827439
Epoch 86
Validation r2 = 0.827337
Epoch 87
Validation r2 = 0.825340
Epoch 88
Validation r2 = 0.824860
Epoch 89
Validation r2 = 0.818738
Epoch 90
Validation r2 = 0.827997
Epoch 91
Validation r2 = 0.828519
Epoch 92
Validation r2 = 0.827442
Epoch 93
Validation r2 = 0.829911
Epoch 94
Validation r2 = 0.831770
Epoch 95
Validation r2 = 0.832013
Epoch 96
Validation r2 = 0.833516
Epoch 97
Validation r2 = 0.833366
Epoch 98
Validation r2 = 0.833487
Epoch 99
Validation r2 = 0.832332
Model 1 best validation r2 = 0.833516 on epoch 96
Moving model to cuda
Model 1 test mae = 0.374461
Model 1 test mse = 0.248524
Model 1 test r2 = 0.766786
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = 0.001116
Epoch 1
Validation r2 = 0.007712
Epoch 2
Validation r2 = 0.018818
Epoch 3
Validation r2 = 0.043148
Epoch 4
Validation r2 = 0.080111
Epoch 5
Validation r2 = -0.181233
Epoch 6
Validation r2 = -0.062777
Epoch 7
Validation r2 = 0.155437
Epoch 8
Validation r2 = 0.094300
Epoch 9
Validation r2 = 0.199439
Epoch 10
Validation r2 = 0.121756
Epoch 11
Validation r2 = 0.300022
Epoch 12
Validation r2 = 0.330501
Epoch 13
Validation r2 = 0.404322
Epoch 14
Validation r2 = 0.398775
Epoch 15
Validation r2 = 0.509364
Epoch 16
Validation r2 = 0.553378
Epoch 17
Validation r2 = 0.550231
Epoch 18
Validation r2 = 0.601427
Epoch 19
Validation r2 = 0.620118
Epoch 20
Validation r2 = 0.590356
Epoch 21
Validation r2 = 0.615851
Epoch 22
Validation r2 = 0.621679
Epoch 23
Validation r2 = 0.627426
Epoch 24
Validation r2 = 0.617250
Epoch 25
Validation r2 = 0.644979
Epoch 26
Validation r2 = 0.659555
Epoch 27
Validation r2 = 0.625603
Epoch 28
Validation r2 = 0.669891
Epoch 29
Validation r2 = 0.679961
Epoch 30
Validation r2 = 0.674571
Epoch 31
Validation r2 = 0.696649
Epoch 32
Validation r2 = 0.702529
Epoch 33
Validation r2 = 0.671838
Epoch 34
Validation r2 = 0.710451
Epoch 35
Validation r2 = 0.713784
Epoch 36
Validation r2 = 0.709695
Epoch 37
Validation r2 = 0.732051
Epoch 38
Validation r2 = 0.731296
Epoch 39
Validation r2 = 0.742854
Epoch 40
Validation r2 = 0.742238
Epoch 41
Validation r2 = 0.750780
Epoch 42
Validation r2 = 0.762659
Epoch 43
Validation r2 = 0.760530
Epoch 44
Validation r2 = 0.768587
Epoch 45
Validation r2 = 0.765295
Epoch 46
Validation r2 = 0.767956
Epoch 47
Validation r2 = 0.772828
Epoch 48
Validation r2 = 0.753389
Epoch 49
Validation r2 = 0.780808
Epoch 50
Validation r2 = 0.774513
Epoch 51
Validation r2 = 0.786684
Epoch 52
Validation r2 = 0.787322
Epoch 53
Validation r2 = 0.781042
Epoch 54
Validation r2 = 0.791947
Epoch 55
Validation r2 = 0.794840
Epoch 56
Validation r2 = 0.787418
Epoch 57
Validation r2 = 0.799413
Epoch 58
Validation r2 = 0.796192
Epoch 59
Validation r2 = 0.802305
Epoch 60
Validation r2 = 0.805382
Epoch 61
Validation r2 = 0.804593
Epoch 62
Validation r2 = 0.804427
Epoch 63
Validation r2 = 0.808923
Epoch 64
Validation r2 = 0.810066
Epoch 65
Validation r2 = 0.803937
Epoch 66
Validation r2 = 0.806338
Epoch 67
Validation r2 = 0.803919
Epoch 68
Validation r2 = 0.807706
Epoch 69
Validation r2 = 0.804168
Epoch 70
Validation r2 = 0.802468
Epoch 71
Validation r2 = 0.816944
Epoch 72
Validation r2 = 0.819015
Epoch 73
Validation r2 = 0.809305
Epoch 74
Validation r2 = 0.818113
Epoch 75
Validation r2 = 0.815340
Epoch 76
Validation r2 = 0.821904
Epoch 77
Validation r2 = 0.821102
Epoch 78
Validation r2 = 0.821452
Epoch 79
Validation r2 = 0.824136
Epoch 80
Validation r2 = 0.825905
Epoch 81
Validation r2 = 0.828533
Epoch 82
Validation r2 = 0.826869
Epoch 83
Validation r2 = 0.826681
Epoch 84
Validation r2 = 0.829036
Epoch 85
Validation r2 = 0.823919
Epoch 86
Validation r2 = 0.820369
Epoch 87
Validation r2 = 0.830092
Epoch 88
Validation r2 = 0.819975
Epoch 89
Validation r2 = 0.825874
Epoch 90
Validation r2 = 0.831635
Epoch 91
Validation r2 = 0.818169
Epoch 92
Validation r2 = 0.824714
Epoch 93
Validation r2 = 0.828780
Epoch 94
Validation r2 = 0.829052
Epoch 95
Validation r2 = 0.832636
Epoch 96
Validation r2 = 0.830153
Epoch 97
Validation r2 = 0.833516
Epoch 98
Validation r2 = 0.832575
Epoch 99
Validation r2 = 0.834617
Model 2 best validation r2 = 0.834617 on epoch 99
Moving model to cuda
Model 2 test mae = 0.365296
Model 2 test mse = 0.219777
Model 2 test r2 = 0.793762
Ensemble test mae = 0.375623
Ensemble test mse = 0.239672
Ensemble test r2 = 0.775093
1-fold cross validation
Seed 0 ==> test r2 = 0.775093
Overall test r2 = 0.775093 +/- 0.000000
