Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 254 | train size = 203 | val size = 51 | test size = 63
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.777908
Epoch 1
Validation r2 = -0.024365
Epoch 2
Validation r2 = 0.005741
Epoch 3
Validation r2 = -0.031358
Epoch 4
Validation r2 = -0.009580
Epoch 5
Validation r2 = -0.007848
Epoch 6
Validation r2 = 0.031451
Epoch 7
Validation r2 = -0.003442
Epoch 8
Validation r2 = 0.027254
Epoch 9
Validation r2 = 0.053367
Epoch 10
Validation r2 = 0.042281
Epoch 11
Validation r2 = 0.090086
Epoch 12
Validation r2 = 0.088168
Epoch 13
Validation r2 = 0.094606
Epoch 14
Validation r2 = 0.131725
Epoch 15
Validation r2 = 0.124505
Epoch 16
Validation r2 = 0.162236
Epoch 17
Validation r2 = 0.172968
Epoch 18
Validation r2 = 0.223443
Epoch 19
Validation r2 = 0.215449
Epoch 20
Validation r2 = 0.304634
Epoch 21
Validation r2 = 0.354687
Epoch 22
Validation r2 = 0.396454
Epoch 23
Validation r2 = 0.469198
Epoch 24
Validation r2 = 0.530348
Epoch 25
Validation r2 = 0.516310
Epoch 26
Validation r2 = 0.575090
Epoch 27
Validation r2 = 0.605532
Epoch 28
Validation r2 = 0.574212
Epoch 29
Validation r2 = 0.571606
Epoch 30
Validation r2 = 0.644156
Epoch 31
Validation r2 = 0.640092
Epoch 32
Validation r2 = 0.592620
Epoch 33
Validation r2 = 0.628489
Epoch 34
Validation r2 = 0.654793
Epoch 35
Validation r2 = 0.657702
Epoch 36
Validation r2 = 0.630875
Epoch 37
Validation r2 = 0.579565
Epoch 38
Validation r2 = 0.623379
Epoch 39
Validation r2 = 0.629269
Epoch 40
Validation r2 = 0.619125
Epoch 41
Validation r2 = 0.542012
Epoch 42
Validation r2 = 0.519302
Epoch 43
Validation r2 = 0.593787
Epoch 44
Validation r2 = 0.622912
Epoch 45
Validation r2 = 0.633818
Epoch 46
Validation r2 = 0.581899
Epoch 47
Validation r2 = 0.544497
Epoch 48
Validation r2 = 0.588132
Epoch 49
Validation r2 = 0.676100
Epoch 50
Validation r2 = 0.674952
Epoch 51
Validation r2 = 0.692287
Epoch 52
Validation r2 = 0.609069
Epoch 53
Validation r2 = 0.565368
Epoch 54
Validation r2 = 0.664087
Epoch 55
Validation r2 = 0.709311
Epoch 56
Validation r2 = 0.705800
Epoch 57
Validation r2 = 0.710888
Epoch 58
Validation r2 = 0.699599
Epoch 59
Validation r2 = 0.672581
Epoch 60
Validation r2 = 0.663136
Epoch 61
Validation r2 = 0.679093
Epoch 62
Validation r2 = 0.697105
Epoch 63
Validation r2 = 0.692714
Epoch 64
Validation r2 = 0.680221
Epoch 65
Validation r2 = 0.682883
Epoch 66
Validation r2 = 0.680820
Epoch 67
Validation r2 = 0.685940
Epoch 68
Validation r2 = 0.702766
Epoch 69
Validation r2 = 0.712344
Epoch 70
Validation r2 = 0.713823
Epoch 71
Validation r2 = 0.715644
Epoch 72
Validation r2 = 0.719070
Epoch 73
Validation r2 = 0.711818
Epoch 74
Validation r2 = 0.709780
Epoch 75
Validation r2 = 0.722576
Epoch 76
Validation r2 = 0.734494
Epoch 77
Validation r2 = 0.732251
Epoch 78
Validation r2 = 0.715511
Epoch 79
Validation r2 = 0.687291
Epoch 80
Validation r2 = 0.667317
Epoch 81
Validation r2 = 0.678767
Epoch 82
Validation r2 = 0.711792
Epoch 83
Validation r2 = 0.726679
Epoch 84
Validation r2 = 0.733020
Epoch 85
Validation r2 = 0.730419
Epoch 86
Validation r2 = 0.706158
Epoch 87
Validation r2 = 0.689268
Epoch 88
Validation r2 = 0.701966
Epoch 89
Validation r2 = 0.716349
Epoch 90
Validation r2 = 0.727891
Epoch 91
Validation r2 = 0.733842
Epoch 92
Validation r2 = 0.733201
Epoch 93
Validation r2 = 0.719887
Epoch 94
Validation r2 = 0.707228
Epoch 95
Validation r2 = 0.706408
Epoch 96
Validation r2 = 0.709243
Epoch 97
Validation r2 = 0.712957
Epoch 98
Validation r2 = 0.710101
Epoch 99
Validation r2 = 0.705140
Model 0 best validation r2 = 0.734494 on epoch 76
Moving model to cuda
Model 0 test mae = 0.490892
Model 0 test mse = 0.437814
Model 0 test r2 = 0.620832
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -1.472742
Epoch 1
Validation r2 = 0.013060
Epoch 2
Validation r2 = -0.074645
Epoch 3
Validation r2 = 0.013160
Epoch 4
Validation r2 = 0.014457
Epoch 5
Validation r2 = 0.019077
Epoch 6
Validation r2 = -0.001762
Epoch 7
Validation r2 = 0.000966
Epoch 8
Validation r2 = 0.049140
Epoch 9
Validation r2 = -0.017447
Epoch 10
Validation r2 = 0.062161
Epoch 11
Validation r2 = 0.042325
Epoch 12
Validation r2 = 0.048400
Epoch 13
Validation r2 = 0.101392
Epoch 14
Validation r2 = 0.080148
Epoch 15
Validation r2 = 0.081539
Epoch 16
Validation r2 = 0.155066
Epoch 17
Validation r2 = 0.164209
Epoch 18
Validation r2 = 0.148495
Epoch 19
Validation r2 = 0.206022
Epoch 20
Validation r2 = 0.227185
Epoch 21
Validation r2 = 0.173863
Epoch 22
Validation r2 = 0.305941
Epoch 23
Validation r2 = 0.265004
Epoch 24
Validation r2 = 0.353446
Epoch 25
Validation r2 = 0.359269
Epoch 26
Validation r2 = 0.277701
Epoch 27
Validation r2 = 0.385811
Epoch 28
Validation r2 = 0.497584
Epoch 29
Validation r2 = 0.513254
Epoch 30
Validation r2 = 0.535237
Epoch 31
Validation r2 = 0.557852
Epoch 32
Validation r2 = 0.498068
Epoch 33
Validation r2 = 0.454171
Epoch 34
Validation r2 = 0.524493
Epoch 35
Validation r2 = 0.596074
Epoch 36
Validation r2 = 0.612167
Epoch 37
Validation r2 = 0.613697
Epoch 38
Validation r2 = 0.598062
Epoch 39
Validation r2 = 0.553312
Epoch 40
Validation r2 = 0.534010
Epoch 41
Validation r2 = 0.552041
Epoch 42
Validation r2 = 0.600841
Epoch 43
Validation r2 = 0.622917
Epoch 44
Validation r2 = 0.635093
Epoch 45
Validation r2 = 0.620825
Epoch 46
Validation r2 = 0.572138
Epoch 47
Validation r2 = 0.602856
Epoch 48
Validation r2 = 0.656521
Epoch 49
Validation r2 = 0.696303
Epoch 50
Validation r2 = 0.702652
Epoch 51
Validation r2 = 0.701374
Epoch 52
Validation r2 = 0.685969
Epoch 53
Validation r2 = 0.647399
Epoch 54
Validation r2 = 0.606105
Epoch 55
Validation r2 = 0.635813
Epoch 56
Validation r2 = 0.682852
Epoch 57
Validation r2 = 0.688210
Epoch 58
Validation r2 = 0.688873
Epoch 59
Validation r2 = 0.668596
Epoch 60
Validation r2 = 0.628305
Epoch 61
Validation r2 = 0.620685
Epoch 62
Validation r2 = 0.632435
Epoch 63
Validation r2 = 0.658136
Epoch 64
Validation r2 = 0.676829
Epoch 65
Validation r2 = 0.678710
Epoch 66
Validation r2 = 0.671692
Epoch 67
Validation r2 = 0.650494
Epoch 68
Validation r2 = 0.636982
Epoch 69
Validation r2 = 0.653916
Epoch 70
Validation r2 = 0.676879
Epoch 71
Validation r2 = 0.696967
Epoch 72
Validation r2 = 0.712985
Epoch 73
Validation r2 = 0.713755
Epoch 74
Validation r2 = 0.707980
Epoch 75
Validation r2 = 0.693596
Epoch 76
Validation r2 = 0.678135
Epoch 77
Validation r2 = 0.684325
Epoch 78
Validation r2 = 0.702639
Epoch 79
Validation r2 = 0.711271
Epoch 80
Validation r2 = 0.703435
Epoch 81
Validation r2 = 0.689065
Epoch 82
Validation r2 = 0.680172
Epoch 83
Validation r2 = 0.679080
Epoch 84
Validation r2 = 0.675477
Epoch 85
Validation r2 = 0.679844
Epoch 86
Validation r2 = 0.682843
Epoch 87
Validation r2 = 0.685920
Epoch 88
Validation r2 = 0.685004
Epoch 89
Validation r2 = 0.677200
Epoch 90
Validation r2 = 0.663709
Epoch 91
Validation r2 = 0.662357
Epoch 92
Validation r2 = 0.682123
Epoch 93
Validation r2 = 0.704050
Epoch 94
Validation r2 = 0.712184
Epoch 95
Validation r2 = 0.710517
Epoch 96
Validation r2 = 0.702414
Epoch 97
Validation r2 = 0.689966
Epoch 98
Validation r2 = 0.687521
Epoch 99
Validation r2 = 0.684089
Model 1 best validation r2 = 0.713755 on epoch 73
Moving model to cuda
Model 1 test mae = 0.478487
Model 1 test mse = 0.444340
Model 1 test r2 = 0.615180
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.874216
Epoch 1
Validation r2 = -0.004196
Epoch 2
Validation r2 = -0.013554
Epoch 3
Validation r2 = 0.012234
Epoch 4
Validation r2 = -0.038997
Epoch 5
Validation r2 = 0.035249
Epoch 6
Validation r2 = 0.012833
Epoch 7
Validation r2 = 0.062479
Epoch 8
Validation r2 = 0.021052
Epoch 9
Validation r2 = 0.042100
Epoch 10
Validation r2 = 0.108926
Epoch 11
Validation r2 = 0.089603
Epoch 12
Validation r2 = 0.143375
Epoch 13
Validation r2 = 0.184121
Epoch 14
Validation r2 = 0.204036
Epoch 15
Validation r2 = 0.227837
Epoch 16
Validation r2 = 0.196635
Epoch 17
Validation r2 = 0.267777
Epoch 18
Validation r2 = 0.322817
Epoch 19
Validation r2 = 0.312254
Epoch 20
Validation r2 = 0.319476
Epoch 21
Validation r2 = 0.428133
Epoch 22
Validation r2 = 0.467497
Epoch 23
Validation r2 = 0.442101
Epoch 24
Validation r2 = 0.550781
Epoch 25
Validation r2 = 0.554338
Epoch 26
Validation r2 = 0.594682
Epoch 27
Validation r2 = 0.557254
Epoch 28
Validation r2 = 0.613133
Epoch 29
Validation r2 = 0.624709
Epoch 30
Validation r2 = 0.603115
Epoch 31
Validation r2 = 0.564363
Epoch 32
Validation r2 = 0.615004
Epoch 33
Validation r2 = 0.615708
Epoch 34
Validation r2 = 0.602065
Epoch 35
Validation r2 = 0.561974
Epoch 36
Validation r2 = 0.598182
Epoch 37
Validation r2 = 0.640389
Epoch 38
Validation r2 = 0.625754
Epoch 39
Validation r2 = 0.584927
Epoch 40
Validation r2 = 0.646485
Epoch 41
Validation r2 = 0.677653
Epoch 42
Validation r2 = 0.674142
Epoch 43
Validation r2 = 0.659439
Epoch 44
Validation r2 = 0.665482
Epoch 45
Validation r2 = 0.689459
Epoch 46
Validation r2 = 0.712055
Epoch 47
Validation r2 = 0.692170
Epoch 48
Validation r2 = 0.643264
Epoch 49
Validation r2 = 0.614739
Epoch 50
Validation r2 = 0.701996
Epoch 51
Validation r2 = 0.718592
Epoch 52
Validation r2 = 0.694116
Epoch 53
Validation r2 = 0.662475
Epoch 54
Validation r2 = 0.654707
Epoch 55
Validation r2 = 0.694299
Epoch 56
Validation r2 = 0.715813
Epoch 57
Validation r2 = 0.712331
Epoch 58
Validation r2 = 0.668072
Epoch 59
Validation r2 = 0.645063
Epoch 60
Validation r2 = 0.708735
Epoch 61
Validation r2 = 0.718587
Epoch 62
Validation r2 = 0.709259
Epoch 63
Validation r2 = 0.682312
Epoch 64
Validation r2 = 0.678713
Epoch 65
Validation r2 = 0.688579
Epoch 66
Validation r2 = 0.707714
Epoch 67
Validation r2 = 0.701692
Epoch 68
Validation r2 = 0.661449
Epoch 69
Validation r2 = 0.677610
Epoch 70
Validation r2 = 0.692168
Epoch 71
Validation r2 = 0.693922
Epoch 72
Validation r2 = 0.701314
Epoch 73
Validation r2 = 0.707859
Epoch 74
Validation r2 = 0.716410
Epoch 75
Validation r2 = 0.734485
Epoch 76
Validation r2 = 0.732032
Epoch 77
Validation r2 = 0.734226
Epoch 78
Validation r2 = 0.732743
Epoch 79
Validation r2 = 0.713788
Epoch 80
Validation r2 = 0.704333
Epoch 81
Validation r2 = 0.689984
Epoch 82
Validation r2 = 0.688912
Epoch 83
Validation r2 = 0.703051
Epoch 84
Validation r2 = 0.715921
Epoch 85
Validation r2 = 0.721420
Epoch 86
Validation r2 = 0.720964
Epoch 87
Validation r2 = 0.713131
Epoch 88
Validation r2 = 0.717739
Epoch 89
Validation r2 = 0.744074
Epoch 90
Validation r2 = 0.757719
Epoch 91
Validation r2 = 0.746009
Epoch 92
Validation r2 = 0.718342
Epoch 93
Validation r2 = 0.693300
Epoch 94
Validation r2 = 0.712415
Epoch 95
Validation r2 = 0.739414
Epoch 96
Validation r2 = 0.744667
Epoch 97
Validation r2 = 0.741586
Epoch 98
Validation r2 = 0.725824
Epoch 99
Validation r2 = 0.705879
Model 2 best validation r2 = 0.757719 on epoch 90
Moving model to cuda
Model 2 test mae = 0.399292
Model 2 test mse = 0.333158
Model 2 test r2 = 0.711469
Ensemble test mae = 0.445990
Ensemble test mse = 0.393583
Ensemble test r2 = 0.659138
1-fold cross validation
Seed 0 ==> test r2 = 0.659138
Overall test r2 = 0.659138 +/- 0.000000
