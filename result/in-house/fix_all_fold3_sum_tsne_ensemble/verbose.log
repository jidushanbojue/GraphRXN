Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,247 | train size = 997 | val size = 250 | test size = 311
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.136465
Epoch 1
Validation r2 = -0.114914
Epoch 2
Validation r2 = 0.102526
Epoch 3
Validation r2 = -0.220272
Epoch 4
Validation r2 = 0.049230
Epoch 5
Validation r2 = 0.119033
Epoch 6
Validation r2 = 0.255383
Epoch 7
Validation r2 = 0.300663
Epoch 8
Validation r2 = 0.390431
Epoch 9
Validation r2 = 0.427233
Epoch 10
Validation r2 = 0.455639
Epoch 11
Validation r2 = 0.404587
Epoch 12
Validation r2 = 0.445650
Epoch 13
Validation r2 = 0.507647
Epoch 14
Validation r2 = 0.572207
Epoch 15
Validation r2 = 0.561975
Epoch 16
Validation r2 = 0.590909
Epoch 17
Validation r2 = 0.592796
Epoch 18
Validation r2 = 0.620040
Epoch 19
Validation r2 = 0.617747
Epoch 20
Validation r2 = 0.646728
Epoch 21
Validation r2 = 0.597604
Epoch 22
Validation r2 = 0.675263
Epoch 23
Validation r2 = 0.653593
Epoch 24
Validation r2 = 0.646969
Epoch 25
Validation r2 = 0.670810
Epoch 26
Validation r2 = 0.665899
Epoch 27
Validation r2 = 0.660362
Epoch 28
Validation r2 = 0.694693
Epoch 29
Validation r2 = 0.671508
Epoch 30
Validation r2 = 0.610010
Epoch 31
Validation r2 = 0.690333
Epoch 32
Validation r2 = 0.666513
Epoch 33
Validation r2 = 0.703983
Epoch 34
Validation r2 = 0.711004
Epoch 35
Validation r2 = 0.709226
Epoch 36
Validation r2 = 0.678630
Epoch 37
Validation r2 = 0.701532
Epoch 38
Validation r2 = 0.669582
Epoch 39
Validation r2 = 0.725699
Epoch 40
Validation r2 = 0.718738
Epoch 41
Validation r2 = 0.721388
Epoch 42
Validation r2 = 0.726583
Epoch 43
Validation r2 = 0.716862
Epoch 44
Validation r2 = 0.719673
Epoch 45
Validation r2 = 0.719482
Epoch 46
Validation r2 = 0.704010
Epoch 47
Validation r2 = 0.699735
Epoch 48
Validation r2 = 0.704231
Epoch 49
Validation r2 = 0.720695
Epoch 50
Validation r2 = 0.716392
Epoch 51
Validation r2 = 0.716176
Epoch 52
Validation r2 = 0.714765
Epoch 53
Validation r2 = 0.720449
Epoch 54
Validation r2 = 0.721238
Epoch 55
Validation r2 = 0.721957
Epoch 56
Validation r2 = 0.707803
Epoch 57
Validation r2 = 0.698488
Epoch 58
Validation r2 = 0.711006
Epoch 59
Validation r2 = 0.721246
Epoch 60
Validation r2 = 0.702724
Epoch 61
Validation r2 = 0.724883
Epoch 62
Validation r2 = 0.712028
Epoch 63
Validation r2 = 0.731345
Epoch 64
Validation r2 = 0.718029
Epoch 65
Validation r2 = 0.717537
Epoch 66
Validation r2 = 0.715677
Epoch 67
Validation r2 = 0.716329
Epoch 68
Validation r2 = 0.703527
Epoch 69
Validation r2 = 0.704601
Epoch 70
Validation r2 = 0.718483
Epoch 71
Validation r2 = 0.717240
Epoch 72
Validation r2 = 0.695526
Epoch 73
Validation r2 = 0.718606
Epoch 74
Validation r2 = 0.697497
Epoch 75
Validation r2 = 0.695612
Epoch 76
Validation r2 = 0.710787
Epoch 77
Validation r2 = 0.703749
Epoch 78
Validation r2 = 0.700884
Epoch 79
Validation r2 = 0.701650
Epoch 80
Validation r2 = 0.697818
Epoch 81
Validation r2 = 0.701188
Epoch 82
Validation r2 = 0.697803
Epoch 83
Validation r2 = 0.702787
Epoch 84
Validation r2 = 0.693716
Epoch 85
Validation r2 = 0.696951
Epoch 86
Validation r2 = 0.696600
Epoch 87
Validation r2 = 0.704152
Epoch 88
Validation r2 = 0.704934
Epoch 89
Validation r2 = 0.700123
Epoch 90
Validation r2 = 0.687311
Epoch 91
Validation r2 = 0.687399
Epoch 92
Validation r2 = 0.704305
Epoch 93
Validation r2 = 0.702591
Epoch 94
Validation r2 = 0.706468
Epoch 95
Validation r2 = 0.695393
Epoch 96
Validation r2 = 0.688178
Epoch 97
Validation r2 = 0.696331
Epoch 98
Validation r2 = 0.697217
Epoch 99
Validation r2 = 0.695854
Model 0 best validation r2 = 0.731345 on epoch 63
Moving model to cuda
Model 0 test mae = 0.358595
Model 0 test mse = 0.224555
Model 0 test r2 = 0.730823
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.000612
Epoch 1
Validation r2 = 0.019319
Epoch 2
Validation r2 = -0.017550
Epoch 3
Validation r2 = 0.084440
Epoch 4
Validation r2 = 0.139785
Epoch 5
Validation r2 = 0.185576
Epoch 6
Validation r2 = 0.230153
Epoch 7
Validation r2 = 0.289078
Epoch 8
Validation r2 = 0.255146
Epoch 9
Validation r2 = 0.381847
Epoch 10
Validation r2 = 0.390003
Epoch 11
Validation r2 = 0.476783
Epoch 12
Validation r2 = 0.344312
Epoch 13
Validation r2 = 0.478319
Epoch 14
Validation r2 = 0.468596
Epoch 15
Validation r2 = 0.547635
Epoch 16
Validation r2 = 0.595070
Epoch 17
Validation r2 = 0.603985
Epoch 18
Validation r2 = 0.619076
Epoch 19
Validation r2 = 0.629380
Epoch 20
Validation r2 = 0.657389
Epoch 21
Validation r2 = 0.644949
Epoch 22
Validation r2 = 0.607511
Epoch 23
Validation r2 = 0.658948
Epoch 24
Validation r2 = 0.615540
Epoch 25
Validation r2 = 0.656025
Epoch 26
Validation r2 = 0.650604
Epoch 27
Validation r2 = 0.658942
Epoch 28
Validation r2 = 0.679987
Epoch 29
Validation r2 = 0.685410
Epoch 30
Validation r2 = 0.677576
Epoch 31
Validation r2 = 0.692646
Epoch 32
Validation r2 = 0.687888
Epoch 33
Validation r2 = 0.687124
Epoch 34
Validation r2 = 0.670521
Epoch 35
Validation r2 = 0.699501
Epoch 36
Validation r2 = 0.712817
Epoch 37
Validation r2 = 0.680004
Epoch 38
Validation r2 = 0.677531
Epoch 39
Validation r2 = 0.654932
Epoch 40
Validation r2 = 0.644760
Epoch 41
Validation r2 = 0.708583
Epoch 42
Validation r2 = 0.707088
Epoch 43
Validation r2 = 0.693052
Epoch 44
Validation r2 = 0.726956
Epoch 45
Validation r2 = 0.719741
Epoch 46
Validation r2 = 0.715135
Epoch 47
Validation r2 = 0.718918
Epoch 48
Validation r2 = 0.723118
Epoch 49
Validation r2 = 0.713141
Epoch 50
Validation r2 = 0.712380
Epoch 51
Validation r2 = 0.720511
Epoch 52
Validation r2 = 0.668372
Epoch 53
Validation r2 = 0.681576
Epoch 54
Validation r2 = 0.713488
Epoch 55
Validation r2 = 0.699765
Epoch 56
Validation r2 = 0.712686
Epoch 57
Validation r2 = 0.710282
Epoch 58
Validation r2 = 0.715744
Epoch 59
Validation r2 = 0.707155
Epoch 60
Validation r2 = 0.705214
Epoch 61
Validation r2 = 0.700777
Epoch 62
Validation r2 = 0.696240
Epoch 63
Validation r2 = 0.707307
Epoch 64
Validation r2 = 0.701178
Epoch 65
Validation r2 = 0.698426
Epoch 66
Validation r2 = 0.704380
Epoch 67
Validation r2 = 0.688322
Epoch 68
Validation r2 = 0.697235
Epoch 69
Validation r2 = 0.688030
Epoch 70
Validation r2 = 0.682239
Epoch 71
Validation r2 = 0.686797
Epoch 72
Validation r2 = 0.682955
Epoch 73
Validation r2 = 0.683165
Epoch 74
Validation r2 = 0.673031
Epoch 75
Validation r2 = 0.665722
Epoch 76
Validation r2 = 0.672681
Epoch 77
Validation r2 = 0.676495
Epoch 78
Validation r2 = 0.670789
Epoch 79
Validation r2 = 0.674269
Epoch 80
Validation r2 = 0.674060
Epoch 81
Validation r2 = 0.677113
Epoch 82
Validation r2 = 0.674068
Epoch 83
Validation r2 = 0.684127
Epoch 84
Validation r2 = 0.674803
Epoch 85
Validation r2 = 0.682202
Epoch 86
Validation r2 = 0.670468
Epoch 87
Validation r2 = 0.669726
Epoch 88
Validation r2 = 0.663556
Epoch 89
Validation r2 = 0.675037
Epoch 90
Validation r2 = 0.667736
Epoch 91
Validation r2 = 0.665897
Epoch 92
Validation r2 = 0.664749
Epoch 93
Validation r2 = 0.653231
Epoch 94
Validation r2 = 0.674122
Epoch 95
Validation r2 = 0.665706
Epoch 96
Validation r2 = 0.663639
Epoch 97
Validation r2 = 0.668581
Epoch 98
Validation r2 = 0.662487
Epoch 99
Validation r2 = 0.662662
Model 1 best validation r2 = 0.726956 on epoch 44
Moving model to cuda
Model 1 test mae = 0.383277
Model 1 test mse = 0.250604
Model 1 test r2 = 0.699597
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.009459
Epoch 1
Validation r2 = 0.041932
Epoch 2
Validation r2 = 0.094632
Epoch 3
Validation r2 = 0.155831
Epoch 4
Validation r2 = 0.117858
Epoch 5
Validation r2 = 0.284055
Epoch 6
Validation r2 = 0.269522
Epoch 7
Validation r2 = 0.394343
Epoch 8
Validation r2 = 0.469324
Epoch 9
Validation r2 = 0.292495
Epoch 10
Validation r2 = 0.492975
Epoch 11
Validation r2 = 0.556238
Epoch 12
Validation r2 = 0.470370
Epoch 13
Validation r2 = 0.584757
Epoch 14
Validation r2 = 0.593188
Epoch 15
Validation r2 = 0.591939
Epoch 16
Validation r2 = 0.635950
Epoch 17
Validation r2 = 0.653605
Epoch 18
Validation r2 = 0.582187
Epoch 19
Validation r2 = 0.623166
Epoch 20
Validation r2 = 0.658154
Epoch 21
Validation r2 = 0.661807
Epoch 22
Validation r2 = 0.632773
Epoch 23
Validation r2 = 0.672439
Epoch 24
Validation r2 = 0.666539
Epoch 25
Validation r2 = 0.661579
Epoch 26
Validation r2 = 0.628077
Epoch 27
Validation r2 = 0.625753
Epoch 28
Validation r2 = 0.675170
Epoch 29
Validation r2 = 0.680802
Epoch 30
Validation r2 = 0.706195
Epoch 31
Validation r2 = 0.699081
Epoch 32
Validation r2 = 0.684615
Epoch 33
Validation r2 = 0.713862
Epoch 34
Validation r2 = 0.681611
Epoch 35
Validation r2 = 0.709122
Epoch 36
Validation r2 = 0.699703
Epoch 37
Validation r2 = 0.713163
Epoch 38
Validation r2 = 0.713010
Epoch 39
Validation r2 = 0.706286
Epoch 40
Validation r2 = 0.697370
Epoch 41
Validation r2 = 0.720337
Epoch 42
Validation r2 = 0.723147
Epoch 43
Validation r2 = 0.682748
Epoch 44
Validation r2 = 0.720009
Epoch 45
Validation r2 = 0.694828
Epoch 46
Validation r2 = 0.695344
Epoch 47
Validation r2 = 0.732740
Epoch 48
Validation r2 = 0.715445
Epoch 49
Validation r2 = 0.720231
Epoch 50
Validation r2 = 0.714067
Epoch 51
Validation r2 = 0.716454
Epoch 52
Validation r2 = 0.708830
Epoch 53
Validation r2 = 0.689933
Epoch 54
Validation r2 = 0.710895
Epoch 55
Validation r2 = 0.705730
Epoch 56
Validation r2 = 0.706544
Epoch 57
Validation r2 = 0.710641
Epoch 58
Validation r2 = 0.723542
Epoch 59
Validation r2 = 0.679035
Epoch 60
Validation r2 = 0.687502
Epoch 61
Validation r2 = 0.669401
Epoch 62
Validation r2 = 0.674933
Epoch 63
Validation r2 = 0.690562
Epoch 64
Validation r2 = 0.695759
Epoch 65
Validation r2 = 0.684811
Epoch 66
Validation r2 = 0.686309
Epoch 67
Validation r2 = 0.696116
Epoch 68
Validation r2 = 0.680408
Epoch 69
Validation r2 = 0.650639
Epoch 70
Validation r2 = 0.645177
Epoch 71
Validation r2 = 0.671860
Epoch 72
Validation r2 = 0.665186
Epoch 73
Validation r2 = 0.664528
Epoch 74
Validation r2 = 0.671581
Epoch 75
Validation r2 = 0.676438
Epoch 76
Validation r2 = 0.671532
Epoch 77
Validation r2 = 0.678509
Epoch 78
Validation r2 = 0.685548
Epoch 79
Validation r2 = 0.673069
Epoch 80
Validation r2 = 0.669451
Epoch 81
Validation r2 = 0.665847
Epoch 82
Validation r2 = 0.668743
Epoch 83
Validation r2 = 0.661754
Epoch 84
Validation r2 = 0.650057
Epoch 85
Validation r2 = 0.628557
Epoch 86
Validation r2 = 0.646430
Epoch 87
Validation r2 = 0.653840
Epoch 88
Validation r2 = 0.642347
Epoch 89
Validation r2 = 0.662395
Epoch 90
Validation r2 = 0.647373
Epoch 91
Validation r2 = 0.653674
Epoch 92
Validation r2 = 0.653789
Epoch 93
Validation r2 = 0.641899
Epoch 94
Validation r2 = 0.657964
Epoch 95
Validation r2 = 0.657930
Epoch 96
Validation r2 = 0.652828
Epoch 97
Validation r2 = 0.649319
Epoch 98
Validation r2 = 0.659650
Epoch 99
Validation r2 = 0.654063
Model 2 best validation r2 = 0.732740 on epoch 47
Moving model to cuda
Model 2 test mae = 0.371962
Model 2 test mse = 0.240323
Model 2 test r2 = 0.711921
Ensemble test mae = 0.362535
Ensemble test mse = 0.224519
Ensemble test r2 = 0.730866
1-fold cross validation
Seed 0 ==> test r2 = 0.730866
Overall test r2 = 0.730866 +/- 0.000000
