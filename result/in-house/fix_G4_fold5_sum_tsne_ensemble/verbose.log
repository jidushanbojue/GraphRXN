Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 337 | train size = 269 | val size = 68 | test size = 84
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -3.279646
Epoch 1
Validation r2 = 0.007644
Epoch 2
Validation r2 = -0.002914
Epoch 3
Validation r2 = -0.131165
Epoch 4
Validation r2 = -0.326927
Epoch 5
Validation r2 = 0.024452
Epoch 6
Validation r2 = -0.198099
Epoch 7
Validation r2 = -0.168442
Epoch 8
Validation r2 = 0.022914
Epoch 9
Validation r2 = -0.015534
Epoch 10
Validation r2 = -0.301919
Epoch 11
Validation r2 = -0.012084
Epoch 12
Validation r2 = 0.024611
Epoch 13
Validation r2 = -0.142152
Epoch 14
Validation r2 = -0.107327
Epoch 15
Validation r2 = 0.041221
Epoch 16
Validation r2 = -0.245011
Epoch 17
Validation r2 = 0.005124
Epoch 18
Validation r2 = 0.000716
Epoch 19
Validation r2 = -0.093623
Epoch 20
Validation r2 = -0.034268
Epoch 21
Validation r2 = -0.005139
Epoch 22
Validation r2 = -0.217729
Epoch 23
Validation r2 = 0.034742
Epoch 24
Validation r2 = -0.037439
Epoch 25
Validation r2 = 0.003101
Epoch 26
Validation r2 = 0.052899
Epoch 27
Validation r2 = -0.246601
Epoch 28
Validation r2 = 0.075537
Epoch 29
Validation r2 = 0.067076
Epoch 30
Validation r2 = -0.022214
Epoch 31
Validation r2 = 0.057903
Epoch 32
Validation r2 = -0.014963
Epoch 33
Validation r2 = 0.072369
Epoch 34
Validation r2 = 0.005538
Epoch 35
Validation r2 = 0.074384
Epoch 36
Validation r2 = 0.017286
Epoch 37
Validation r2 = -0.101108
Epoch 38
Validation r2 = 0.007484
Epoch 39
Validation r2 = -0.015927
Epoch 40
Validation r2 = 0.065170
Epoch 41
Validation r2 = 0.003365
Epoch 42
Validation r2 = -0.122856
Epoch 43
Validation r2 = -0.152994
Epoch 44
Validation r2 = -0.213886
Epoch 45
Validation r2 = 0.151535
Epoch 46
Validation r2 = 0.049520
Epoch 47
Validation r2 = -0.132324
Epoch 48
Validation r2 = -0.041636
Epoch 49
Validation r2 = -0.210366
Epoch 50
Validation r2 = 0.097813
Epoch 51
Validation r2 = 0.091921
Epoch 52
Validation r2 = -0.185106
Epoch 53
Validation r2 = -0.025507
Epoch 54
Validation r2 = 0.007913
Epoch 55
Validation r2 = -0.112228
Epoch 56
Validation r2 = 0.040510
Epoch 57
Validation r2 = 0.026540
Epoch 58
Validation r2 = -0.180123
Epoch 59
Validation r2 = 0.051661
Epoch 60
Validation r2 = 0.089333
Epoch 61
Validation r2 = -0.100050
Epoch 62
Validation r2 = 0.023292
Epoch 63
Validation r2 = 0.077062
Epoch 64
Validation r2 = -0.002517
Epoch 65
Validation r2 = 0.093471
Epoch 66
Validation r2 = 0.109184
Epoch 67
Validation r2 = -0.019482
Epoch 68
Validation r2 = 0.075021
Epoch 69
Validation r2 = 0.102638
Epoch 70
Validation r2 = 0.034049
Epoch 71
Validation r2 = 0.035732
Epoch 72
Validation r2 = 0.064905
Epoch 73
Validation r2 = 0.060897
Epoch 74
Validation r2 = 0.118579
Epoch 75
Validation r2 = 0.047607
Epoch 76
Validation r2 = 0.136022
Epoch 77
Validation r2 = 0.129100
Epoch 78
Validation r2 = 0.090964
Epoch 79
Validation r2 = 0.133828
Epoch 80
Validation r2 = 0.125736
Epoch 81
Validation r2 = 0.093364
Epoch 82
Validation r2 = 0.137331
Epoch 83
Validation r2 = 0.123770
Epoch 84
Validation r2 = 0.134122
Epoch 85
Validation r2 = 0.108481
Epoch 86
Validation r2 = 0.088080
Epoch 87
Validation r2 = 0.123371
Epoch 88
Validation r2 = 0.139925
Epoch 89
Validation r2 = 0.165050
Epoch 90
Validation r2 = 0.143087
Epoch 91
Validation r2 = 0.111952
Epoch 92
Validation r2 = 0.152698
Epoch 93
Validation r2 = 0.184441
Epoch 94
Validation r2 = 0.157894
Epoch 95
Validation r2 = 0.116641
Epoch 96
Validation r2 = 0.156866
Epoch 97
Validation r2 = 0.174174
Epoch 98
Validation r2 = 0.167263
Epoch 99
Validation r2 = 0.177896
Model 0 best validation r2 = 0.184441 on epoch 93
Moving model to cuda
Model 0 test mae = 0.623940
Model 0 test mse = 0.793171
Model 0 test r2 = 0.315300
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.837518
Epoch 1
Validation r2 = -0.188175
Epoch 2
Validation r2 = -0.946107
Epoch 3
Validation r2 = 0.015470
Epoch 4
Validation r2 = -0.248781
Epoch 5
Validation r2 = -0.452814
Epoch 6
Validation r2 = 0.020795
Epoch 7
Validation r2 = 0.006345
Epoch 8
Validation r2 = -0.270590
Epoch 9
Validation r2 = -0.209448
Epoch 10
Validation r2 = -0.040759
Epoch 11
Validation r2 = 0.013853
Epoch 12
Validation r2 = -0.086129
Epoch 13
Validation r2 = -0.079764
Epoch 14
Validation r2 = 0.044108
Epoch 15
Validation r2 = -0.112291
Epoch 16
Validation r2 = -0.036847
Epoch 17
Validation r2 = -0.086856
Epoch 18
Validation r2 = -0.082344
Epoch 19
Validation r2 = -0.080545
Epoch 20
Validation r2 = -0.122262
Epoch 21
Validation r2 = -0.001065
Epoch 22
Validation r2 = -0.239834
Epoch 23
Validation r2 = 0.013005
Epoch 24
Validation r2 = 0.043097
Epoch 25
Validation r2 = -0.352207
Epoch 26
Validation r2 = 0.024063
Epoch 27
Validation r2 = 0.077204
Epoch 28
Validation r2 = -0.187090
Epoch 29
Validation r2 = 0.057210
Epoch 30
Validation r2 = 0.049692
Epoch 31
Validation r2 = 0.037297
Epoch 32
Validation r2 = 0.041455
Epoch 33
Validation r2 = -0.009823
Epoch 34
Validation r2 = 0.001502
Epoch 35
Validation r2 = -0.026985
Epoch 36
Validation r2 = 0.027099
Epoch 37
Validation r2 = -0.035260
Epoch 38
Validation r2 = 0.024761
Epoch 39
Validation r2 = 0.003426
Epoch 40
Validation r2 = 0.014599
Epoch 41
Validation r2 = -0.101347
Epoch 42
Validation r2 = 0.104443
Epoch 43
Validation r2 = 0.072251
Epoch 44
Validation r2 = -0.055605
Epoch 45
Validation r2 = -0.184433
Epoch 46
Validation r2 = -0.066910
Epoch 47
Validation r2 = -0.112282
Epoch 48
Validation r2 = -0.216892
Epoch 49
Validation r2 = 0.002681
Epoch 50
Validation r2 = 0.084200
Epoch 51
Validation r2 = 0.017089
Epoch 52
Validation r2 = -0.075579
Epoch 53
Validation r2 = 0.046378
Epoch 54
Validation r2 = -0.027596
Epoch 55
Validation r2 = -0.185587
Epoch 56
Validation r2 = -0.046610
Epoch 57
Validation r2 = 0.024290
Epoch 58
Validation r2 = -0.093798
Epoch 59
Validation r2 = -0.058948
Epoch 60
Validation r2 = -0.010882
Epoch 61
Validation r2 = -0.066271
Epoch 62
Validation r2 = -0.062043
Epoch 63
Validation r2 = -0.026205
Epoch 64
Validation r2 = 0.022607
Epoch 65
Validation r2 = 0.003682
Epoch 66
Validation r2 = -0.031093
Epoch 67
Validation r2 = -0.031704
Epoch 68
Validation r2 = 0.030294
Epoch 69
Validation r2 = -0.025094
Epoch 70
Validation r2 = -0.018103
Epoch 71
Validation r2 = 0.046296
Epoch 72
Validation r2 = 0.044566
Epoch 73
Validation r2 = 0.032795
Epoch 74
Validation r2 = 0.004328
Epoch 75
Validation r2 = 0.014490
Epoch 76
Validation r2 = 0.027905
Epoch 77
Validation r2 = 0.085461
Epoch 78
Validation r2 = 0.032318
Epoch 79
Validation r2 = 0.016873
Epoch 80
Validation r2 = 0.016801
Epoch 81
Validation r2 = 0.048909
Epoch 82
Validation r2 = 0.086929
Epoch 83
Validation r2 = 0.096365
Epoch 84
Validation r2 = 0.074666
Epoch 85
Validation r2 = 0.031949
Epoch 86
Validation r2 = 0.104266
Epoch 87
Validation r2 = 0.114591
Epoch 88
Validation r2 = 0.108138
Epoch 89
Validation r2 = 0.092370
Epoch 90
Validation r2 = 0.081514
Epoch 91
Validation r2 = 0.143634
Epoch 92
Validation r2 = 0.138711
Epoch 93
Validation r2 = 0.117529
Epoch 94
Validation r2 = 0.150805
Epoch 95
Validation r2 = 0.135235
Epoch 96
Validation r2 = 0.116305
Epoch 97
Validation r2 = 0.111981
Epoch 98
Validation r2 = 0.152654
Epoch 99
Validation r2 = 0.142553
Model 1 best validation r2 = 0.152654 on epoch 98
Moving model to cuda
Model 1 test mae = 0.618691
Model 1 test mse = 0.808726
Model 1 test r2 = 0.301872
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.134848
Epoch 1
Validation r2 = -0.125499
Epoch 2
Validation r2 = -0.057222
Epoch 3
Validation r2 = -0.585147
Epoch 4
Validation r2 = -0.005946
Epoch 5
Validation r2 = -0.269534
Epoch 6
Validation r2 = -0.196497
Epoch 7
Validation r2 = 0.022092
Epoch 8
Validation r2 = -0.243957
Epoch 9
Validation r2 = -0.213703
Epoch 10
Validation r2 = -0.001044
Epoch 11
Validation r2 = -0.023443
Epoch 12
Validation r2 = -0.189184
Epoch 13
Validation r2 = -0.121950
Epoch 14
Validation r2 = 0.036780
Epoch 15
Validation r2 = -0.070768
Epoch 16
Validation r2 = -0.135108
Epoch 17
Validation r2 = 0.013288
Epoch 18
Validation r2 = -0.120450
Epoch 19
Validation r2 = 0.027441
Epoch 20
Validation r2 = -0.153991
Epoch 21
Validation r2 = 0.013039
Epoch 22
Validation r2 = -0.092997
Epoch 23
Validation r2 = -0.054954
Epoch 24
Validation r2 = 0.008060
Epoch 25
Validation r2 = -0.079354
Epoch 26
Validation r2 = 0.024427
Epoch 27
Validation r2 = -0.024036
Epoch 28
Validation r2 = -0.157843
Epoch 29
Validation r2 = 0.024370
Epoch 30
Validation r2 = 0.023911
Epoch 31
Validation r2 = -0.372360
Epoch 32
Validation r2 = -0.063629
Epoch 33
Validation r2 = -0.067223
Epoch 34
Validation r2 = 0.052827
Epoch 35
Validation r2 = 0.048729
Epoch 36
Validation r2 = -0.090021
Epoch 37
Validation r2 = -0.003752
Epoch 38
Validation r2 = -0.024579
Epoch 39
Validation r2 = -0.194952
Epoch 40
Validation r2 = -0.028751
Epoch 41
Validation r2 = -0.051504
Epoch 42
Validation r2 = -0.166952
Epoch 43
Validation r2 = -0.131038
Epoch 44
Validation r2 = -0.044695
Epoch 45
Validation r2 = 0.040348
Epoch 46
Validation r2 = 0.008009
Epoch 47
Validation r2 = -0.143614
Epoch 48
Validation r2 = -0.000740
Epoch 49
Validation r2 = 0.032361
Epoch 50
Validation r2 = 0.030177
Epoch 51
Validation r2 = -0.061441
Epoch 52
Validation r2 = -0.156570
Epoch 53
Validation r2 = 0.060458
Epoch 54
Validation r2 = 0.052049
Epoch 55
Validation r2 = 0.038379
Epoch 56
Validation r2 = 0.006039
Epoch 57
Validation r2 = 0.006446
Epoch 58
Validation r2 = 0.008698
Epoch 59
Validation r2 = 0.019455
Epoch 60
Validation r2 = 0.029644
Epoch 61
Validation r2 = 0.001463
Epoch 62
Validation r2 = -0.023609
Epoch 63
Validation r2 = -0.025706
Epoch 64
Validation r2 = -0.017061
Epoch 65
Validation r2 = 0.014278
Epoch 66
Validation r2 = 0.017017
Epoch 67
Validation r2 = 0.021897
Epoch 68
Validation r2 = 0.016625
Epoch 69
Validation r2 = 0.001359
Epoch 70
Validation r2 = -0.003110
Epoch 71
Validation r2 = 0.049241
Epoch 72
Validation r2 = 0.011982
Epoch 73
Validation r2 = 0.047356
Epoch 74
Validation r2 = 0.073937
Epoch 75
Validation r2 = 0.031834
Epoch 76
Validation r2 = -0.007458
Epoch 77
Validation r2 = -0.001023
Epoch 78
Validation r2 = 0.035411
Epoch 79
Validation r2 = 0.081409
Epoch 80
Validation r2 = 0.021466
Epoch 81
Validation r2 = -0.000052
Epoch 82
Validation r2 = 0.024889
Epoch 83
Validation r2 = 0.063691
Epoch 84
Validation r2 = 0.045609
Epoch 85
Validation r2 = 0.013306
Epoch 86
Validation r2 = 0.015929
Epoch 87
Validation r2 = 0.050634
Epoch 88
Validation r2 = 0.022320
Epoch 89
Validation r2 = 0.019735
Epoch 90
Validation r2 = 0.106711
Epoch 91
Validation r2 = 0.023164
Epoch 92
Validation r2 = -0.050612
Epoch 93
Validation r2 = 0.009981
Epoch 94
Validation r2 = 0.069476
Epoch 95
Validation r2 = 0.087338
Epoch 96
Validation r2 = 0.038609
Epoch 97
Validation r2 = 0.057888
Epoch 98
Validation r2 = 0.059544
Epoch 99
Validation r2 = 0.081698
Model 2 best validation r2 = 0.106711 on epoch 90
Moving model to cuda
Model 2 test mae = 0.606425
Model 2 test mse = 0.755944
Model 2 test r2 = 0.347436
Ensemble test mae = 0.610595
Ensemble test mse = 0.772795
Ensemble test r2 = 0.332889
1-fold cross validation
Seed 0 ==> test r2 = 0.332889
Overall test r2 = 0.332889 +/- 0.000000
