Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 335 | train size = 268 | val size = 67 | test size = 84
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.009810
Epoch 1
Validation r2 = 0.006734
Epoch 2
Validation r2 = -0.018708
Epoch 3
Validation r2 = 0.008181
Epoch 4
Validation r2 = 0.004883
Epoch 5
Validation r2 = 0.025110
Epoch 6
Validation r2 = 0.021901
Epoch 7
Validation r2 = 0.048520
Epoch 8
Validation r2 = 0.066250
Epoch 9
Validation r2 = 0.104660
Epoch 10
Validation r2 = 0.154642
Epoch 11
Validation r2 = 0.175827
Epoch 12
Validation r2 = 0.240500
Epoch 13
Validation r2 = 0.294032
Epoch 14
Validation r2 = 0.372768
Epoch 15
Validation r2 = 0.216667
Epoch 16
Validation r2 = 0.359920
Epoch 17
Validation r2 = 0.408249
Epoch 18
Validation r2 = 0.506588
Epoch 19
Validation r2 = 0.569946
Epoch 20
Validation r2 = 0.590597
Epoch 21
Validation r2 = 0.600090
Epoch 22
Validation r2 = 0.631457
Epoch 23
Validation r2 = 0.637718
Epoch 24
Validation r2 = 0.697553
Epoch 25
Validation r2 = 0.684296
Epoch 26
Validation r2 = 0.654148
Epoch 27
Validation r2 = 0.673409
Epoch 28
Validation r2 = 0.675050
Epoch 29
Validation r2 = 0.697793
Epoch 30
Validation r2 = 0.704417
Epoch 31
Validation r2 = 0.705216
Epoch 32
Validation r2 = 0.698027
Epoch 33
Validation r2 = 0.680037
Epoch 34
Validation r2 = 0.696005
Epoch 35
Validation r2 = 0.690872
Epoch 36
Validation r2 = 0.678294
Epoch 37
Validation r2 = 0.698970
Epoch 38
Validation r2 = 0.698726
Epoch 39
Validation r2 = 0.698566
Epoch 40
Validation r2 = 0.686211
Epoch 41
Validation r2 = 0.684751
Epoch 42
Validation r2 = 0.691399
Epoch 43
Validation r2 = 0.702552
Epoch 44
Validation r2 = 0.701625
Epoch 45
Validation r2 = 0.702656
Epoch 46
Validation r2 = 0.706287
Epoch 47
Validation r2 = 0.707117
Epoch 48
Validation r2 = 0.696153
Epoch 49
Validation r2 = 0.707642
Epoch 50
Validation r2 = 0.706516
Epoch 51
Validation r2 = 0.703305
Epoch 52
Validation r2 = 0.708161
Epoch 53
Validation r2 = 0.708309
Epoch 54
Validation r2 = 0.695962
Epoch 55
Validation r2 = 0.690134
Epoch 56
Validation r2 = 0.701758
Epoch 57
Validation r2 = 0.707865
Epoch 58
Validation r2 = 0.696309
Epoch 59
Validation r2 = 0.700468
Epoch 60
Validation r2 = 0.696681
Epoch 61
Validation r2 = 0.689976
Epoch 62
Validation r2 = 0.696912
Epoch 63
Validation r2 = 0.699526
Epoch 64
Validation r2 = 0.687570
Epoch 65
Validation r2 = 0.690584
Epoch 66
Validation r2 = 0.689303
Epoch 67
Validation r2 = 0.690377
Epoch 68
Validation r2 = 0.691378
Epoch 69
Validation r2 = 0.697470
Epoch 70
Validation r2 = 0.698484
Epoch 71
Validation r2 = 0.702027
Epoch 72
Validation r2 = 0.688259
Epoch 73
Validation r2 = 0.679469
Epoch 74
Validation r2 = 0.683286
Epoch 75
Validation r2 = 0.686200
Epoch 76
Validation r2 = 0.690215
Epoch 77
Validation r2 = 0.687985
Epoch 78
Validation r2 = 0.686289
Epoch 79
Validation r2 = 0.693344
Epoch 80
Validation r2 = 0.694341
Epoch 81
Validation r2 = 0.689112
Epoch 82
Validation r2 = 0.684282
Epoch 83
Validation r2 = 0.682069
Epoch 84
Validation r2 = 0.667403
Epoch 85
Validation r2 = 0.678259
Epoch 86
Validation r2 = 0.687303
Epoch 87
Validation r2 = 0.687494
Epoch 88
Validation r2 = 0.690460
Epoch 89
Validation r2 = 0.679359
Epoch 90
Validation r2 = 0.683890
Epoch 91
Validation r2 = 0.690250
Epoch 92
Validation r2 = 0.689474
Epoch 93
Validation r2 = 0.691988
Epoch 94
Validation r2 = 0.685130
Epoch 95
Validation r2 = 0.690407
Epoch 96
Validation r2 = 0.690374
Epoch 97
Validation r2 = 0.685778
Epoch 98
Validation r2 = 0.688678
Epoch 99
Validation r2 = 0.684815
Model 0 best validation r2 = 0.708309 on epoch 53
Moving model to cuda
Model 0 test mae = 0.494060
Model 0 test mse = 0.460908
Model 0 test r2 = 0.542000
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.001602
Epoch 1
Validation r2 = -0.011972
Epoch 2
Validation r2 = 0.011826
Epoch 3
Validation r2 = 0.020991
Epoch 4
Validation r2 = 0.034424
Epoch 5
Validation r2 = 0.036473
Epoch 6
Validation r2 = 0.065055
Epoch 7
Validation r2 = 0.107725
Epoch 8
Validation r2 = 0.135590
Epoch 9
Validation r2 = 0.174415
Epoch 10
Validation r2 = 0.103543
Epoch 11
Validation r2 = 0.250671
Epoch 12
Validation r2 = 0.279019
Epoch 13
Validation r2 = 0.367827
Epoch 14
Validation r2 = 0.447188
Epoch 15
Validation r2 = 0.525438
Epoch 16
Validation r2 = 0.582238
Epoch 17
Validation r2 = 0.632819
Epoch 18
Validation r2 = 0.661758
Epoch 19
Validation r2 = 0.691145
Epoch 20
Validation r2 = 0.692289
Epoch 21
Validation r2 = 0.688202
Epoch 22
Validation r2 = 0.658083
Epoch 23
Validation r2 = 0.643976
Epoch 24
Validation r2 = 0.694312
Epoch 25
Validation r2 = 0.696531
Epoch 26
Validation r2 = 0.688497
Epoch 27
Validation r2 = 0.685560
Epoch 28
Validation r2 = 0.681777
Epoch 29
Validation r2 = 0.682982
Epoch 30
Validation r2 = 0.685203
Epoch 31
Validation r2 = 0.689089
Epoch 32
Validation r2 = 0.694831
Epoch 33
Validation r2 = 0.688351
Epoch 34
Validation r2 = 0.687330
Epoch 35
Validation r2 = 0.686234
Epoch 36
Validation r2 = 0.682871
Epoch 37
Validation r2 = 0.678848
Epoch 38
Validation r2 = 0.686749
Epoch 39
Validation r2 = 0.690767
Epoch 40
Validation r2 = 0.693377
Epoch 41
Validation r2 = 0.691599
Epoch 42
Validation r2 = 0.693655
Epoch 43
Validation r2 = 0.693042
Epoch 44
Validation r2 = 0.693109
Epoch 45
Validation r2 = 0.691768
Epoch 46
Validation r2 = 0.707016
Epoch 47
Validation r2 = 0.705022
Epoch 48
Validation r2 = 0.692374
Epoch 49
Validation r2 = 0.695732
Epoch 50
Validation r2 = 0.699476
Epoch 51
Validation r2 = 0.693516
Epoch 52
Validation r2 = 0.691569
Epoch 53
Validation r2 = 0.701025
Epoch 54
Validation r2 = 0.701586
Epoch 55
Validation r2 = 0.704276
Epoch 56
Validation r2 = 0.703668
Epoch 57
Validation r2 = 0.709871
Epoch 58
Validation r2 = 0.716586
Epoch 59
Validation r2 = 0.703921
Epoch 60
Validation r2 = 0.680763
Epoch 61
Validation r2 = 0.691676
Epoch 62
Validation r2 = 0.675676
Epoch 63
Validation r2 = 0.695212
Epoch 64
Validation r2 = 0.711607
Epoch 65
Validation r2 = 0.716685
Epoch 66
Validation r2 = 0.717130
Epoch 67
Validation r2 = 0.723791
Epoch 68
Validation r2 = 0.716027
Epoch 69
Validation r2 = 0.723348
Epoch 70
Validation r2 = 0.716486
Epoch 71
Validation r2 = 0.718478
Epoch 72
Validation r2 = 0.721079
Epoch 73
Validation r2 = 0.709269
Epoch 74
Validation r2 = 0.715190
Epoch 75
Validation r2 = 0.702252
Epoch 76
Validation r2 = 0.709668
Epoch 77
Validation r2 = 0.717257
Epoch 78
Validation r2 = 0.720846
Epoch 79
Validation r2 = 0.708462
Epoch 80
Validation r2 = 0.718710
Epoch 81
Validation r2 = 0.721073
Epoch 82
Validation r2 = 0.705796
Epoch 83
Validation r2 = 0.703590
Epoch 84
Validation r2 = 0.708846
Epoch 85
Validation r2 = 0.714173
Epoch 86
Validation r2 = 0.717561
Epoch 87
Validation r2 = 0.702545
Epoch 88
Validation r2 = 0.698078
Epoch 89
Validation r2 = 0.698760
Epoch 90
Validation r2 = 0.699690
Epoch 91
Validation r2 = 0.681767
Epoch 92
Validation r2 = 0.677880
Epoch 93
Validation r2 = 0.681588
Epoch 94
Validation r2 = 0.692899
Epoch 95
Validation r2 = 0.695443
Epoch 96
Validation r2 = 0.694497
Epoch 97
Validation r2 = 0.686791
Epoch 98
Validation r2 = 0.675235
Epoch 99
Validation r2 = 0.675791
Model 1 best validation r2 = 0.723791 on epoch 67
Moving model to cuda
Model 1 test mae = 0.494933
Model 1 test mse = 0.477915
Model 1 test r2 = 0.525100
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.015150
Epoch 1
Validation r2 = -0.068741
Epoch 2
Validation r2 = -0.009768
Epoch 3
Validation r2 = 0.006674
Epoch 4
Validation r2 = 0.059751
Epoch 5
Validation r2 = 0.100486
Epoch 6
Validation r2 = 0.142687
Epoch 7
Validation r2 = 0.189401
Epoch 8
Validation r2 = 0.231625
Epoch 9
Validation r2 = 0.222054
Epoch 10
Validation r2 = 0.318641
Epoch 11
Validation r2 = 0.358460
Epoch 12
Validation r2 = 0.493740
Epoch 13
Validation r2 = 0.553118
Epoch 14
Validation r2 = 0.584165
Epoch 15
Validation r2 = 0.580950
Epoch 16
Validation r2 = 0.561017
Epoch 17
Validation r2 = 0.640953
Epoch 18
Validation r2 = 0.650717
Epoch 19
Validation r2 = 0.673176
Epoch 20
Validation r2 = 0.679746
Epoch 21
Validation r2 = 0.665087
Epoch 22
Validation r2 = 0.679634
Epoch 23
Validation r2 = 0.694983
Epoch 24
Validation r2 = 0.698896
Epoch 25
Validation r2 = 0.699425
Epoch 26
Validation r2 = 0.695794
Epoch 27
Validation r2 = 0.690104
Epoch 28
Validation r2 = 0.701356
Epoch 29
Validation r2 = 0.699290
Epoch 30
Validation r2 = 0.701277
Epoch 31
Validation r2 = 0.692742
Epoch 32
Validation r2 = 0.707797
Epoch 33
Validation r2 = 0.716749
Epoch 34
Validation r2 = 0.714669
Epoch 35
Validation r2 = 0.709675
Epoch 36
Validation r2 = 0.698802
Epoch 37
Validation r2 = 0.705234
Epoch 38
Validation r2 = 0.713482
Epoch 39
Validation r2 = 0.714080
Epoch 40
Validation r2 = 0.709643
Epoch 41
Validation r2 = 0.706574
Epoch 42
Validation r2 = 0.715964
Epoch 43
Validation r2 = 0.697021
Epoch 44
Validation r2 = 0.708238
Epoch 45
Validation r2 = 0.710201
Epoch 46
Validation r2 = 0.714119
Epoch 47
Validation r2 = 0.705218
Epoch 48
Validation r2 = 0.722533
Epoch 49
Validation r2 = 0.720046
Epoch 50
Validation r2 = 0.704627
Epoch 51
Validation r2 = 0.690960
Epoch 52
Validation r2 = 0.694066
Epoch 53
Validation r2 = 0.698288
Epoch 54
Validation r2 = 0.699687
Epoch 55
Validation r2 = 0.700061
Epoch 56
Validation r2 = 0.690383
Epoch 57
Validation r2 = 0.679175
Epoch 58
Validation r2 = 0.684909
Epoch 59
Validation r2 = 0.698291
Epoch 60
Validation r2 = 0.701738
Epoch 61
Validation r2 = 0.698749
Epoch 62
Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 335 | train size = 268 | val size = 67 | test size = 84
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.001482
Epoch 1
Validation r2 = 0.007535
Epoch 2
Validation r2 = 0.003176
Epoch 3
Validation r2 = 0.000112
Epoch 4
Validation r2 = 0.013014
Epoch 5
Validation r2 = 0.027154
Epoch 6
Validation r2 = 0.033021
Epoch 7
Validation r2 = 0.063679
Epoch 8
Validation r2 = 0.081128
Epoch 9
Validation r2 = 0.117122
Epoch 10
Validation r2 = 0.177411
Epoch 11
Validation r2 = 0.182123
Epoch 12
Validation r2 = 0.260594
Epoch 13
Validation r2 = 0.302023
Epoch 14
Validation r2 = 0.367491
Epoch 15
Validation r2 = 0.376993
Epoch 16
Validation r2 = 0.411922
Epoch 17
Validation r2 = 0.417669
Epoch 18
Validation r2 = 0.407412
Epoch 19
Validation r2 = 0.520208
Epoch 20
Validation r2 = 0.554112
Epoch 21
Validation r2 = 0.579018
Epoch 22
Validation r2 = 0.579341
Epoch 23
Validation r2 = 0.610897
Epoch 24
Validation r2 = 0.638745
Epoch 25
Validation r2 = 0.661403
Epoch 26
Validation r2 = 0.638049
Epoch 27
Validation r2 = 0.676738
Epoch 28
Validation r2 = 0.686341
Epoch 29
Validation r2 = 0.699293
Epoch 30
Validation r2 = 0.702864
Epoch 31
Validation r2 = 0.689447
Epoch 32
Validation r2 = 0.694887
Epoch 33
Validation r2 = 0.691685
Epoch 34
Validation r2 = 0.695339
Epoch 35
Validation r2 = 0.703139
Epoch 36
Validation r2 = 0.706238
Epoch 37
Validation r2 = 0.694724
Epoch 38
Validation r2 = 0.687694
Epoch 39
Validation r2 = 0.697032
Epoch 40
Validation r2 = 0.697546
Epoch 41
Validation r2 = 0.684114
Epoch 42
Validation r2 = 0.715947
Epoch 43
Validation r2 = 0.708351
Epoch 44
Validation r2 = 0.704324
Epoch 45
Validation r2 = 0.702074
Epoch 46
Validation r2 = 0.704431
Epoch 47
Validation r2 = 0.713624
Epoch 48
Validation r2 = 0.711117
Epoch 49
Validation r2 = 0.717046
Epoch 50
Validation r2 = 0.714892
Epoch 51
Validation r2 = 0.720871
Epoch 52
Validation r2 = 0.719090
Epoch 53
Validation r2 = 0.714226
Epoch 54
Validation r2 = 0.715846
Epoch 55
Validation r2 = 0.712172
Epoch 56
Validation r2 = 0.713946
Epoch 57
Validation r2 = 0.709817
Epoch 58
Validation r2 = 0.718895
Epoch 59
Validation r2 = 0.718412
Epoch 60
Validation r2 = 0.708737
Epoch 61
Validation r2 = 0.702865
Epoch 62
Validation r2 = 0.713021
Epoch 63
Validation r2 = 0.715690
Epoch 64
Validation r2 = 0.710520
Epoch 65
Validation r2 = 0.716631
Epoch 66
Validation r2 = 0.712859
Epoch 67
Validation r2 = 0.712446
Epoch 68
Validation r2 = 0.722719
Epoch 69
Validation r2 = 0.722185
Epoch 70
Validation r2 = 0.716199
Epoch 71
Validation r2 = 0.720503
Epoch 72
Validation r2 = 0.711224
Epoch 73
Validation r2 = 0.712911
Epoch 74
Validation r2 = 0.708439
Epoch 75
Validation r2 = 0.716218
Epoch 76
Validation r2 = 0.724875
Epoch 77
Validation r2 = 0.712241
Epoch 78
Validation r2 = 0.711779
Epoch 79
Validation r2 = 0.721326
Epoch 80
Validation r2 = 0.704178
Epoch 81
Validation r2 = 0.709400
Epoch 82
Validation r2 = 0.720143
Epoch 83
Validation r2 = 0.710295
Epoch 84
Validation r2 = 0.711478
Epoch 85
Validation r2 = 0.707766
Epoch 86
Validation r2 = 0.706940
Epoch 87
Validation r2 = 0.707054
Epoch 88
Validation r2 = 0.711546
Epoch 89
Validation r2 = 0.708539
Epoch 90
Validation r2 = 0.705321
Epoch 91
Validation r2 = 0.712271
Epoch 92
Validation r2 = 0.709945
Epoch 93
Validation r2 = 0.702398
Epoch 94
Validation r2 = 0.703572
Epoch 95
Validation r2 = 0.702581
Epoch 96
Validation r2 = 0.700374
Epoch 97
Validation r2 = 0.705007
Epoch 98
Validation r2 = 0.704771
Epoch 99
Validation r2 = 0.702970
Model 0 best validation r2 = 0.724875 on epoch 76
Moving model to cuda
Model 0 test mae = 0.453337
Model 0 test mse = 0.402639
Model 0 test r2 = 0.599901
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.000107
Epoch 1
Validation r2 = -0.043384
Epoch 2
Validation r2 = 0.009740
Epoch 3
Validation r2 = 0.025016
Epoch 4
Validation r2 = 0.042992
Epoch 5
Validation r2 = 0.047487
Epoch 6
Validation r2 = 0.083470
Epoch 7
Validation r2 = 0.155931
Epoch 8
Validation r2 = 0.198902
Epoch 9
Validation r2 = 0.252788
Epoch 10
Validation r2 = 0.077562
Epoch 11
Validation r2 = 0.246582
Epoch 12
Validation r2 = 0.301978
Epoch 13
Validation r2 = 0.453015
Epoch 14
Validation r2 = 0.476182
Epoch 15
Validation r2 = 0.554408
Epoch 16
Validation r2 = 0.612124
Epoch 17
Validation r2 = 0.600984
Epoch 18
Validation r2 = 0.628671
Epoch 19
Validation r2 = 0.651860
Epoch 20
Validation r2 = 0.672429
Epoch 21
Validation r2 = 0.675865
Epoch 22
Validation r2 = 0.688610
Epoch 23
Validation r2 = 0.709729
Epoch 24
Validation r2 = 0.702834
Epoch 25
Validation r2 = 0.697994
Epoch 26
Validation r2 = 0.712142
Epoch 27
Validation r2 = 0.717535
Epoch 28
Validation r2 = 0.710172
Epoch 29
Validation r2 = 0.702853
Epoch 30
Validation r2 = 0.698306
Epoch 31
Validation r2 = 0.704793
Epoch 32
Validation r2 = 0.702962
Epoch 33
Validation r2 = 0.694655
Epoch 34
Validation r2 = 0.703705
Epoch 35
Validation r2 = 0.702434
Epoch 36
Validation r2 = 0.697400
Epoch 37
Validation r2 = 0.677714
Epoch 38
Validation r2 = 0.701594
Epoch 39
Validation r2 = 0.712391
Epoch 40
Validation r2 = 0.699661
Epoch 41
Validation r2 = 0.703521
Epoch 42
Validation r2 = 0.686131
Epoch 43
Validation r2 = 0.703451
Epoch 44
Validation r2 = 0.701911
Epoch 45
Validation r2 = 0.709906
Epoch 46
Validation r2 = 0.710955
Epoch 47
Validation r2 = 0.701484
Epoch 48
Validation r2 = 0.711265
Epoch 49
Validation r2 = 0.711401
Epoch 50
Validation r2 = 0.700264
Epoch 51
Validation r2 = 0.695036
Epoch 52
Validation r2 = 0.701391
Epoch 53
Validation r2 = 0.706865
Epoch 54
Validation r2 = 0.707585
Epoch 55
Validation r2 = 0.707806
Epoch 56
Validation r2 = 0.703231
Epoch 57
Validation r2 = 0.704303
Epoch 58
Validation r2 = 0.709881
Epoch 59
Validation r2 = 0.705176
Epoch 60
Validation r2 = 0.701524
Epoch 61
Validation r2 = 0.698868
Epoch 62
Validation r2 = 0.694529
Epoch 63
Validation r2 = 0.695275
Epoch 64
Validation r2 = 0.699807
Epoch 65
Validation r2 = 0.695714
Epoch 66
Validation r2 = 0.688476
Epoch 67
Validation r2 = 0.690233
Epoch 68
Validation r2 = 0.699972
Epoch 69
Validation r2 = 0.703910
Epoch 70
Validation r2 = 0.686328
Epoch 71
Validation r2 = 0.685110
Epoch 72
Validation r2 = 0.684853
Epoch 73
Validation r2 = 0.684329
Epoch 74
Validation r2 = 0.687148
Epoch 75
Validation r2 = 0.691673
Epoch 76
Validation r2 = 0.693034
Epoch 77
Validation r2 = 0.700558
Epoch 78
Validation r2 = 0.696058
Epoch 79
Validation r2 = 0.685470
Epoch 80
Validation r2 = 0.694081
Epoch 81
Validation r2 = 0.694826
Epoch 82
Validation r2 = 0.684564
Epoch 83
Validation r2 = 0.689311
Epoch 84
Validation r2 = 0.693011
Epoch 85
Validation r2 = 0.694926
Epoch 86
Validation r2 = 0.696198
Epoch 87
Validation r2 = 0.690240
Epoch 88
Validation r2 = 0.691267
Epoch 89
Validation r2 = 0.697919
Epoch 90
Validation r2 = 0.693888
Epoch 91
Validation r2 = 0.689136
Epoch 92
Validation r2 = 0.683472
Epoch 93
Validation r2 = 0.695463
Epoch 94
Validation r2 = 0.696585
Epoch 95
Validation r2 = 0.690573
Epoch 96
Validation r2 = 0.689005
Epoch 97
Validation r2 = 0.688978
Epoch 98
Validation r2 = 0.688317
Epoch 99
Validation r2 = 0.693391
Model 1 best validation r2 = 0.717535 on epoch 27
Moving model to cuda
Model 1 test mae = 0.542611
Model 1 test mse = 0.513396
Model 1 test r2 = 0.489842
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.067285
Epoch 1
Validation r2 = 0.014898
Epoch 2
Validation r2 = 0.016768
Epoch 3
Validation r2 = 0.026039
Epoch 4
Validation r2 = 0.054521
Epoch 5
Validation r2 = 0.086185
Epoch 6
Validation r2 = 0.130314
Epoch 7
Validation r2 = 0.187205
Epoch 8
Validation r2 = 0.250052
Epoch 9
Validation r2 = 0.142053
Epoch 10
Validation r2 = 0.215884
Epoch 11
Validation r2 = 0.232380
Epoch 12
Validation r2 = 0.475170
Epoch 13
Validation r2 = 0.510699
Epoch 14
Validation r2 = 0.530869
Epoch 15
Validation r2 = 0.568317
Epoch 16
Validation r2 = 0.589262
Epoch 17
Validation r2 = 0.627961
Epoch 18
Validation r2 = 0.664609
Epoch 19
Validation r2 = 0.665856
Epoch 20
Validation r2 = 0.658113
Epoch 21
Validation r2 = 0.679367
Epoch 22
Validation r2 = 0.667911
Epoch 23
Validation r2 = 0.666648
Epoch 24
Validation r2 = 0.693728
Epoch 25
Validation r2 = 0.700370
Epoch 26
Validation r2 = 0.711592
Epoch 27
Validation r2 = 0.719007
Epoch 28
Validation r2 = 0.714300
Epoch 29
Validation r2 = 0.704256
Epoch 30
Validation r2 = 0.706861
Epoch 31
Validation r2 = 0.714399
Epoch 32
Validation r2 = 0.728164
Epoch 33
Validation r2 = 0.726417
Epoch 34
Validation r2 = 0.728522
Epoch 35
Validation r2 = 0.720399
Epoch 36
Validation r2 = 0.723679
Epoch 37
Validation r2 = 0.725399
Epoch 38
Validation r2 = 0.716099
Epoch 39
Validation r2 = 0.723488
Epoch 40
Validation r2 = 0.727124
Epoch 41
Validation r2 = 0.729114
Epoch 42
Validation r2 = 0.729462
Epoch 43
Validation r2 = 0.707553
Epoch 44
Validation r2 = 0.723275
Epoch 45
Validation r2 = 0.720963
Epoch 46
Validation r2 = 0.717109
Epoch 47
Validation r2 = 0.734668
Epoch 48
Validation r2 = 0.731341
Epoch 49
Validation r2 = 0.731066
Epoch 50
Validation r2 = 0.711037
Epoch 51
Validation r2 = 0.712718
Epoch 52
Validation r2 = 0.722944
Epoch 53
Validation r2 = 0.725084
Epoch 54
Validation r2 = 0.727207
Epoch 55
Validation r2 = 0.732853
Epoch 56
Validation r2 = 0.724757
Epoch 57
Validation r2 = 0.712142
Epoch 58
Validation r2 = 0.702761
Epoch 59
Validation r2 = 0.724612
Epoch 60
Validation r2 = 0.730348
Epoch 61
Validation r2 = 0.725612
Epoch 62
Validation r2 = 0.716557
Epoch 63
Validation r2 = 0.713158
Epoch 64
Validation r2 = 0.717997
Epoch 65
Validation r2 = 0.722672
Epoch 66
Validation r2 = 0.724468
Epoch 67
Validation r2 = 0.719487
Epoch 68
Validation r2 = 0.712100
Epoch 69
Validation r2 = 0.711703
Epoch 70
Validation r2 = 0.726355
Epoch 71
Validation r2 = 0.729653
Epoch 72
Validation r2 = 0.725962
Epoch 73
Validation r2 = 0.725268
Epoch 74
Validation r2 = 0.724035
Epoch 75
Validation r2 = 0.715614
Epoch 76
Validation r2 = 0.707933
Epoch 77
Validation r2 = 0.708514
Epoch 78
Validation r2 = 0.714432
Epoch 79
Validation r2 = 0.717750
Epoch 80
Validation r2 = 0.723552
Epoch 81
Validation r2 = 0.720410
Epoch 82
Validation r2 = 0.713446
Epoch 83
Validation r2 = 0.708035
Epoch 84
Validation r2 = 0.714285
Epoch 85
Validation r2 = 0.719652
Epoch 86
Validation r2 = 0.717824
Epoch 87
Validation r2 = 0.712395
Epoch 88
Validation r2 = 0.713154
Epoch 89
Validation r2 = 0.707040
Epoch 90
Validation r2 = 0.701867
Epoch 91
Validation r2 = 0.712151
Epoch 92
Validation r2 = 0.718754
Epoch 93
Validation r2 = 0.714506
Epoch 94
Validation r2 = 0.703798
Epoch 95
Validation r2 = 0.711355
Epoch 96
Validation r2 = 0.717613
Epoch 97
Validation r2 = 0.718182
Epoch 98
Validation r2 = 0.712328
Epoch 99
Validation r2 = 0.709986
Model 2 best validation r2 = 0.734668 on epoch 47
Moving model to cuda
Model 2 test mae = 0.485740
Model 2 test mse = 0.464921
Model 2 test r2 = 0.538012
Ensemble test mae = 0.479347
Ensemble test mse = 0.435186
Ensemble test r2 = 0.567560
1-fold cross validation
Seed 0 ==> test r2 = 0.567560
Overall test r2 = 0.567560 +/- 0.000000
