Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 337 | train size = 269 | val size = 68 | test size = 84
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.164404
Epoch 1
Validation r2 = 0.019521
Epoch 2
Validation r2 = -0.113384
Epoch 3
Validation r2 = 0.006775
Epoch 4
Validation r2 = -0.203321
Epoch 5
Validation r2 = 0.025084
Epoch 6
Validation r2 = -0.128133
Epoch 7
Validation r2 = -0.061494
Epoch 8
Validation r2 = 0.024642
Epoch 9
Validation r2 = -0.096875
Epoch 10
Validation r2 = 0.084886
Epoch 11
Validation r2 = 0.007423
Epoch 12
Validation r2 = 0.011280
Epoch 13
Validation r2 = 0.126914
Epoch 14
Validation r2 = -0.048570
Epoch 15
Validation r2 = 0.106106
Epoch 16
Validation r2 = 0.041962
Epoch 17
Validation r2 = 0.081728
Epoch 18
Validation r2 = 0.062578
Epoch 19
Validation r2 = -0.317579
Epoch 20
Validation r2 = -0.272366
Epoch 21
Validation r2 = 0.043028
Epoch 22
Validation r2 = -0.028855
Epoch 23
Validation r2 = 0.084192
Epoch 24
Validation r2 = 0.076291
Epoch 25
Validation r2 = -0.128706
Epoch 26
Validation r2 = -0.064332
Epoch 27
Validation r2 = 0.031081
Epoch 28
Validation r2 = -0.021840
Epoch 29
Validation r2 = 0.090147
Epoch 30
Validation r2 = -0.007598
Epoch 31
Validation r2 = -0.006488
Epoch 32
Validation r2 = -0.076932
Epoch 33
Validation r2 = 0.091049
Epoch 34
Validation r2 = 0.120797
Epoch 35
Validation r2 = 0.122611
Epoch 36
Validation r2 = 0.043286
Epoch 37
Validation r2 = -0.031709
Epoch 38
Validation r2 = 0.125474
Epoch 39
Validation r2 = 0.128308
Epoch 40
Validation r2 = 0.045384
Epoch 41
Validation r2 = 0.091978
Epoch 42
Validation r2 = 0.181494
Epoch 43
Validation r2 = 0.092401
Epoch 44
Validation r2 = 0.242535
Epoch 45
Validation r2 = 0.183726
Epoch 46
Validation r2 = 0.084630
Epoch 47
Validation r2 = 0.215227
Epoch 48
Validation r2 = 0.305072
Epoch 49
Validation r2 = 0.011078
Epoch 50
Validation r2 = 0.335966
Epoch 51
Validation r2 = 0.374160
Epoch 52
Validation r2 = 0.323143
Epoch 53
Validation r2 = 0.182571
Epoch 54
Validation r2 = 0.266844
Epoch 55
Validation r2 = 0.367385
Epoch 56
Validation r2 = 0.307855
Epoch 57
Validation r2 = 0.213880
Epoch 58
Validation r2 = 0.383901
Epoch 59
Validation r2 = 0.363075
Epoch 60
Validation r2 = 0.223448
Epoch 61
Validation r2 = 0.252560
Epoch 62
Validation r2 = 0.292067
Epoch 63
Validation r2 = 0.315946
Epoch 64
Validation r2 = 0.344864
Epoch 65
Validation r2 = 0.252284
Epoch 66
Validation r2 = 0.265381
Epoch 67
Validation r2 = 0.339301
Epoch 68
Validation r2 = 0.297483
Epoch 69
Validation r2 = 0.253823
Epoch 70
Validation r2 = 0.316839
Epoch 71
Validation r2 = 0.296015
Epoch 72
Validation r2 = 0.317255
Epoch 73
Validation r2 = 0.313536
Epoch 74
Validation r2 = 0.266462
Epoch 75
Validation r2 = 0.302362
Epoch 76
Validation r2 = 0.282158
Epoch 77
Validation r2 = 0.249844
Epoch 78
Validation r2 = 0.316717
Epoch 79
Validation r2 = 0.322824
Epoch 80
Validation r2 = 0.222467
Epoch 81
Validation r2 = 0.263270
Epoch 82
Validation r2 = 0.265900
Epoch 83
Validation r2 = 0.307282
Epoch 84
Validation r2 = 0.320775
Epoch 85
Validation r2 = 0.227884
Epoch 86
Validation r2 = 0.232706
Epoch 87
Validation r2 = 0.321239
Epoch 88
Validation r2 = 0.290136
Epoch 89
Validation r2 = 0.283438
Epoch 90
Validation r2 = 0.285428
Epoch 91
Validation r2 = 0.213902
Epoch 92
Validation r2 = 0.287444
Epoch 93
Validation r2 = 0.324304
Epoch 94
Validation r2 = 0.264883
Epoch 95
Validation r2 = 0.244122
Epoch 96
Validation r2 = 0.281352
Epoch 97
Validation r2 = 0.276371
Epoch 98
Validation r2 = 0.263282
Epoch 99
Validation r2 = 0.326970
Model 0 best validation r2 = 0.383901 on epoch 58
Moving model to cuda
Model 0 test mae = 0.542301
Model 0 test mse = 0.674405
Model 0 test r2 = 0.417824
Ensemble test mae = 0.542301
Ensemble test mse = 0.674405
Ensemble test r2 = 0.417824
1-fold cross validation
Seed 0 ==> test r2 = 0.417824
Overall test r2 = 0.417824 +/- 0.000000
