Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 4,032 | train size = 3,225 | val size = 807 | test size = 1,728
Fitting scaler
Building model 0
Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 4,032 | train size = 3,225 | val size = 807 | test size = 1,728
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2100, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,562,901
Moving model to cuda
Epoch 0
Validation r2 = 0.183052
Epoch 1
Validation r2 = 0.344144
Epoch 2
Validation r2 = 0.596211
Epoch 3
Validation r2 = 0.638435
Epoch 4
Validation r2 = 0.680974
Epoch 5
Validation r2 = 0.651480
Epoch 6
Validation r2 = 0.673685
Epoch 7
Validation r2 = 0.688696
Epoch 8
Validation r2 = 0.734094
Epoch 9
Validation r2 = 0.715635
Epoch 10
Validation r2 = 0.752708
Epoch 11
Validation r2 = 0.759198
Epoch 12
Validation r2 = 0.769688
Epoch 13
Validation r2 = 0.780801
Epoch 14
Validation r2 = 0.782660
Epoch 15
Validation r2 = 0.797500
Epoch 16
Validation r2 = 0.805630
Epoch 17
Validation r2 = 0.807744
Epoch 18
Validation r2 = 0.811960
Epoch 19
Validation r2 = 0.820092
Epoch 20
Validation r2 = 0.809587
Epoch 21
Validation r2 = 0.822917
Epoch 22
Validation r2 = 0.821936
Epoch 23
Validation r2 = 0.820831
Epoch 24
Validation r2 = 0.825674
Epoch 25
Validation r2 = 0.837508
Epoch 26
Validation r2 = 0.828192
Epoch 27
Validation r2 = 0.832354
Epoch 28
Validation r2 = 0.838060
Epoch 29
Validation r2 = 0.839005
Epoch 30
Validation r2 = 0.831188
Epoch 31
Validation r2 = 0.838798
Epoch 32
Validation r2 = 0.840939
Epoch 33
Validation r2 = 0.842401
Epoch 34
Validation r2 = 0.837770
Epoch 35
Validation r2 = 0.837680
Epoch 36
Validation r2 = 0.839141
Epoch 37
Validation r2 = 0.844153
Epoch 38
Validation r2 = 0.842011
Epoch 39
Validation r2 = 0.832678
Epoch 40
Validation r2 = 0.846845
Epoch 41
Validation r2 = 0.840476
Epoch 42
Validation r2 = 0.837716
Epoch 43
Validation r2 = 0.844067
Epoch 44
Validation r2 = 0.845279
Epoch 45
Validation r2 = 0.845775
Epoch 46
Validation r2 = 0.847966
Epoch 47
Validation r2 = 0.844020
Epoch 48
Validation r2 = 0.842714
Epoch 49
Validation r2 = 0.843679
Epoch 50
Validation r2 = 0.841328
Epoch 51
Validation r2 = 0.840487
Epoch 52
Validation r2 = 0.841639
Epoch 53
Validation r2 = 0.838474
Epoch 54
Validation r2 = 0.838811
Epoch 55
Validation r2 = 0.842670
Epoch 56
Validation r2 = 0.839985
Epoch 57
Validation r2 = 0.835412
Epoch 58
Validation r2 = 0.837080
Epoch 59
Validation r2 = 0.841802
Epoch 60
Validation r2 = 0.833176
Epoch 61
Validation r2 = 0.838934
Epoch 62
Validation r2 = 0.834049
Epoch 63
Validation r2 = 0.840049
Epoch 64
Validation r2 = 0.838574
Epoch 65
Validation r2 = 0.832921
Epoch 66
Validation r2 = 0.832018
Epoch 67
Validation r2 = 0.832403
Epoch 68
Validation r2 = 0.833316
Epoch 69
Validation r2 = 0.833034
Epoch 70
Validation r2 = 0.833934
Epoch 71
Validation r2 = 0.834569
Epoch 72
Validation r2 = 0.833796
Epoch 73
Validation r2 = 0.830033
Epoch 74
Validation r2 = 0.831753
Epoch 75
Validation r2 = 0.832357
Epoch 76
Validation r2 = 0.831889
Epoch 77
Validation r2 = 0.831016
Epoch 78
Validation r2 = 0.828316
Epoch 79
Validation r2 = 0.830759
Epoch 80
Validation r2 = 0.829115
Epoch 81
Validation r2 = 0.828437
Epoch 82
Validation r2 = 0.827823
Epoch 83
Validation r2 = 0.826131
Epoch 84
Validation r2 = 0.828582
Epoch 85
Validation r2 = 0.829311
Epoch 86
Validation r2 = 0.828110
Epoch 87
Validation r2 = 0.827245
Epoch 88
Validation r2 = 0.827891
Epoch 89
Validation r2 = 0.823230
Epoch 90
Validation r2 = 0.824355
Epoch 91
Validation r2 = 0.824536
Epoch 92
Validation r2 = 0.824692
Epoch 93
Validation r2 = 0.822156
Epoch 94
Validation r2 = 0.825725
Epoch 95
Validation r2 = 0.823627
Epoch 96
Validation r2 = 0.823843
Epoch 97
Validation r2 = 0.824683
Epoch 98
Validation r2 = 0.822875
Epoch 99
Validation r2 = 0.824285
Model 0 best validation r2 = 0.847966 on epoch 46
Moving model to cuda
Model 0 test mae = 0.287540
Model 0 test mse = 0.157365
Model 0 test r2 = 0.843192
Ensemble test mae = 0.287540
Ensemble test mse = 0.157365
Ensemble test r2 = 0.843192
1-fold cross validation
Seed 0 ==> test r2 = 0.843192
Overall test r2 = 0.843192 +/- 0.000000
