Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 321 | train size = 256 | val size = 65 | test size = 80
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.235212
Epoch 1
Validation r2 = -0.042026
Epoch 2
Validation r2 = -0.043312
Epoch 3
Validation r2 = 0.031926
Epoch 4
Validation r2 = 0.106195
Epoch 5
Validation r2 = 0.126965
Epoch 6
Validation r2 = 0.207486
Epoch 7
Validation r2 = 0.240290
Epoch 8
Validation r2 = 0.333252
Epoch 9
Validation r2 = 0.382504
Epoch 10
Validation r2 = 0.267733
Epoch 11
Validation r2 = 0.433912
Epoch 12
Validation r2 = 0.377722
Epoch 13
Validation r2 = 0.463358
Epoch 14
Validation r2 = 0.495502
Epoch 15
Validation r2 = 0.559159
Epoch 16
Validation r2 = 0.563438
Epoch 17
Validation r2 = 0.563777
Epoch 18
Validation r2 = 0.569546
Epoch 19
Validation r2 = 0.551029
Epoch 20
Validation r2 = 0.564392
Epoch 21
Validation r2 = 0.520919
Epoch 22
Validation r2 = 0.499793
Epoch 23
Validation r2 = 0.578981
Epoch 24
Validation r2 = 0.541424
Epoch 25
Validation r2 = 0.612442
Epoch 26
Validation r2 = 0.623725
Epoch 27
Validation r2 = 0.614793
Epoch 28
Validation r2 = 0.639895
Epoch 29
Validation r2 = 0.619322
Epoch 30
Validation r2 = 0.650405
Epoch 31
Validation r2 = 0.629903
Epoch 32
Validation r2 = 0.662473
Epoch 33
Validation r2 = 0.650481
Epoch 34
Validation r2 = 0.665668
Epoch 35
Validation r2 = 0.668587
Epoch 36
Validation r2 = 0.591057
Epoch 37
Validation r2 = 0.664014
Epoch 38
Validation r2 = 0.597853
Epoch 39
Validation r2 = 0.672423
Epoch 40
Validation r2 = 0.679313
Epoch 41
Validation r2 = 0.572227
Epoch 42
Validation r2 = 0.665764
Epoch 43
Validation r2 = 0.691054
Epoch 44
Validation r2 = 0.606189
Epoch 45
Validation r2 = 0.676962
Epoch 46
Validation r2 = 0.693042
Epoch 47
Validation r2 = 0.641948
Epoch 48
Validation r2 = 0.700361
Epoch 49
Validation r2 = 0.704371
Epoch 50
Validation r2 = 0.655312
Epoch 51
Validation r2 = 0.703456
Epoch 52
Validation r2 = 0.705380
Epoch 53
Validation r2 = 0.679104
Epoch 54
Validation r2 = 0.705974
Epoch 55
Validation r2 = 0.714213
Epoch 56
Validation r2 = 0.681400
Epoch 57
Validation r2 = 0.716433
Epoch 58
Validation r2 = 0.706764
Epoch 59
Validation r2 = 0.708291
Epoch 60
Validation r2 = 0.721657
Epoch 61
Validation r2 = 0.717814
Epoch 62
Validation r2 = 0.698978
Epoch 63
Validation r2 = 0.725661
Epoch 64
Validation r2 = 0.719196
Epoch 65
Validation r2 = 0.720047
Epoch 66
Validation r2 = 0.729917
Epoch 67
Validation r2 = 0.729316
Epoch 68
Validation r2 = 0.728279
Epoch 69
Validation r2 = 0.735335
Epoch 70
Validation r2 = 0.719092
Epoch 71
Validation r2 = 0.732859
Epoch 72
Validation r2 = 0.742199
Epoch 73
Validation r2 = 0.742243
Epoch 74
Validation r2 = 0.730834
Epoch 75
Validation r2 = 0.742651
Epoch 76
Validation r2 = 0.739913
Epoch 77
Validation r2 = 0.721370
Epoch 78
Validation r2 = 0.745513
Epoch 79
Validation r2 = 0.749845
Epoch 80
Validation r2 = 0.749292
Epoch 81
Validation r2 = 0.751172
Epoch 82
Validation r2 = 0.748775
Epoch 83
Validation r2 = 0.753544
Epoch 84
Validation r2 = 0.751497
Epoch 85
Validation r2 = 0.745605
Epoch 86
Validation r2 = 0.753316
Epoch 87
Validation r2 = 0.759350
Epoch 88
Validation r2 = 0.751478
Epoch 89
Validation r2 = 0.757305
Epoch 90
Validation r2 = 0.757466
Epoch 91
Validation r2 = 0.755242
Epoch 92
Validation r2 = 0.761180
Epoch 93
Validation r2 = 0.756155
Epoch 94
Validation r2 = 0.756689
Epoch 95
Validation r2 = 0.762653
Epoch 96
Validation r2 = 0.759685
Epoch 97
Validation r2 = 0.754683
Epoch 98
Validation r2 = 0.763886
Epoch 99
Validation r2 = 0.767259
Model 0 best validation r2 = 0.767259 on epoch 99
Moving model to cuda
Model 0 test mae = 0.313491
Model 0 test mse = 0.195819
Model 0 test r2 = 0.781858
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -3.324643
Epoch 1
Validation r2 = -0.747528
Epoch 2
Validation r2 = -0.106938
Epoch 3
Validation r2 = 0.006426
Epoch 4
Validation r2 = -0.058256
Epoch 5
Validation r2 = 0.013649
Epoch 6
Validation r2 = -0.009253
Epoch 7
Validation r2 = 0.016464
Epoch 8
Validation r2 = 0.007373
Epoch 9
Validation r2 = 0.065606
Epoch 10
Validation r2 = 0.068399
Epoch 11
Validation r2 = 0.114802
Epoch 12
Validation r2 = 0.123619
Epoch 13
Validation r2 = 0.226027
Epoch 14
Validation r2 = 0.280525
Epoch 15
Validation r2 = 0.251372
Epoch 16
Validation r2 = 0.354300
Epoch 17
Validation r2 = 0.348816
Epoch 18
Validation r2 = 0.432013
Epoch 19
Validation r2 = 0.467764
Epoch 20
Validation r2 = 0.430169
Epoch 21
Validation r2 = 0.516271
Epoch 22
Validation r2 = 0.523607
Epoch 23
Validation r2 = 0.553989
Epoch 24
Validation r2 = 0.583856
Epoch 25
Validation r2 = 0.543742
Epoch 26
Validation r2 = 0.493279
Epoch 27
Validation r2 = 0.536657
Epoch 28
Validation r2 = 0.587608
Epoch 29
Validation r2 = 0.573185
Epoch 30
Validation r2 = 0.448322
Epoch 31
Validation r2 = 0.595362
Epoch 32
Validation r2 = 0.606769
Epoch 33
Validation r2 = 0.558805
Epoch 34
Validation r2 = 0.609832
Epoch 35
Validation r2 = 0.617362
Epoch 36
Validation r2 = 0.553983
Epoch 37
Validation r2 = 0.624603
Epoch 38
Validation r2 = 0.623659
Epoch 39
Validation r2 = 0.613756
Epoch 40
Validation r2 = 0.628939
Epoch 41
Validation r2 = 0.585890
Epoch 42
Validation r2 = 0.639036
Epoch 43
Validation r2 = 0.648120
Epoch 44
Validation r2 = 0.585447
Epoch 45
Validation r2 = 0.656286
Epoch 46
Validation r2 = 0.659510
Epoch 47
Validation r2 = 0.630699
Epoch 48
Validation r2 = 0.666633
Epoch 49
Validation r2 = 0.652863
Epoch 50
Validation r2 = 0.657837
Epoch 51
Validation r2 = 0.672466
Epoch 52
Validation r2 = 0.648560
Epoch 53
Validation r2 = 0.674889
Epoch 54
Validation r2 = 0.679146
Epoch 55
Validation r2 = 0.653518
Epoch 56
Validation r2 = 0.682757
Epoch 57
Validation r2 = 0.664701
Epoch 58
Validation r2 = 0.682983
Epoch 59
Validation r2 = 0.687837
Epoch 60
Validation r2 = 0.641942
Epoch 61
Validation r2 = 0.692299
Epoch 62
Validation r2 = 0.676989
Epoch 63
Validation r2 = 0.682616
Epoch 64
Validation r2 = 0.695130
Epoch 65
Validation r2 = 0.660341
Epoch 66
Validation r2 = 0.689974
Epoch 67
Validation r2 = 0.701622
Epoch 68
Validation r2 = 0.671315
Epoch 69
Validation r2 = 0.697788
Epoch 70
Validation r2 = 0.704098
Epoch 71
Validation r2 = 0.679536
Epoch 72
Validation r2 = 0.699475
Epoch 73
Validation r2 = 0.697196
Epoch 74
Validation r2 = 0.694653
Epoch 75
Validation r2 = 0.705127
Epoch 76
Validation r2 = 0.698772
Epoch 77
Validation r2 = 0.711396
Epoch 78
Validation r2 = 0.699560
Epoch 79
Validation r2 = 0.688485
Epoch 80
Validation r2 = 0.715636
Epoch 81
Validation r2 = 0.703824
Epoch 82
Validation r2 = 0.701229
Epoch 83
Validation r2 = 0.715558
Epoch 84
Validation r2 = 0.703210
Epoch 85
Validation r2 = 0.717713
Epoch 86
Validation r2 = 0.711253
Epoch 87
Validation r2 = 0.708580
Epoch 88
Validation r2 = 0.709478
Epoch 89
Validation r2 = 0.718078
Epoch 90
Validation r2 = 0.719843
Epoch 91
Validation r2 = 0.691895
Epoch 92
Validation r2 = 0.723025
Epoch 93
Validation r2 = 0.721112
Epoch 94
Validation r2 = 0.706848
Epoch 95
Validation r2 = 0.723941
Epoch 96
Validation r2 = 0.728139
Epoch 97
Validation r2 = 0.710278
Epoch 98
Validation r2 = 0.699870
Epoch 99
Validation r2 = 0.730477
Model 1 best validation r2 = 0.730477 on epoch 99
Moving model to cuda
Model 1 test mae = 0.338498
Model 1 test mse = 0.215041
Model 1 test r2 = 0.760445
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.588942
Epoch 1
Validation r2 = -0.001603
Epoch 2
Validation r2 = 0.037183
Epoch 3
Validation r2 = 0.080055
Epoch 4
Validation r2 = 0.164038
Epoch 5
Validation r2 = 0.201862
Epoch 6
Validation r2 = -0.355217
Epoch 7
Validation r2 = 0.170398
Epoch 8
Validation r2 = 0.187370
Epoch 9
Validation r2 = 0.254607
Epoch 10
Validation r2 = 0.317713
Epoch 11
Validation r2 = 0.408853
Epoch 12
Validation r2 = 0.356471
Epoch 13
Validation r2 = 0.488063
Epoch 14
Validation r2 = 0.511772
Epoch 15
Validation r2 = 0.525393
Epoch 16
Validation r2 = 0.540958
Epoch 17
Validation r2 = 0.513341
Epoch 18
Validation r2 = 0.522994
Epoch 19
Validation r2 = 0.534437
Epoch 20
Validation r2 = 0.560621
Epoch 21
Validation r2 = 0.553904
Epoch 22
Validation r2 = 0.575453
Epoch 23
Validation r2 = 0.582550
Epoch 24
Validation r2 = 0.581059
Epoch 25
Validation r2 = 0.540694
Epoch 26
Validation r2 = 0.584798
Epoch 27
Validation r2 = 0.561985
Epoch 28
Validation r2 = 0.600731
Epoch 29
Validation r2 = 0.609641
Epoch 30
Validation r2 = 0.539367
Epoch 31
Validation r2 = 0.625846
Epoch 32
Validation r2 = 0.635622
Epoch 33
Validation r2 = 0.623851
Epoch 34
Validation r2 = 0.635865
Epoch 35
Validation r2 = 0.621626
Epoch 36
Validation r2 = 0.664203
Epoch 37
Validation r2 = 0.650889
Epoch 38
Validation r2 = 0.590272
Epoch 39
Validation r2 = 0.670496
Epoch 40
Validation r2 = 0.672643
Epoch 41
Validation r2 = 0.658233
Epoch 42
Validation r2 = 0.666322
Epoch 43
Validation r2 = 0.667878
Epoch 44
Validation r2 = 0.673202
Epoch 45
Validation r2 = 0.665114
Epoch 46
Validation r2 = 0.681922
Epoch 47
Validation r2 = 0.668464
Epoch 48
Validation r2 = 0.685396
Epoch 49
Validation r2 = 0.680621
Epoch 50
Validation r2 = 0.692557
Epoch 51
Validation r2 = 0.700242
Epoch 52
Validation r2 = 0.679279
Epoch 53
Validation r2 = 0.702673
Epoch 54
Validation r2 = 0.685542
Epoch 55
Validation r2 = 0.700170
Epoch 56
Validation r2 = 0.713292
Epoch 57
Validation r2 = 0.694582
Epoch 58
Validation r2 = 0.715625
Epoch 59
Validation r2 = 0.715773
Epoch 60
Validation r2 = 0.689203
Epoch 61
Validation r2 = 0.721386
Epoch 62
Validation r2 = 0.718624
Epoch 63
Validation r2 = 0.713615
Epoch 64
Validation r2 = 0.729133
Epoch 65
Validation r2 = 0.726473
Epoch 66
Validation r2 = 0.719398
Epoch 67
Validation r2 = 0.731516
Epoch 68
Validation r2 = 0.729152
Epoch 69
Validation r2 = 0.736980
Epoch 70
Validation r2 = 0.737187
Epoch 71
Validation r2 = 0.744041
Epoch 72
Validation r2 = 0.730397
Epoch 73
Validation r2 = 0.745430
Epoch 74
Validation r2 = 0.727779
Epoch 75
Validation r2 = 0.740428
Epoch 76
Validation r2 = 0.729321
Epoch 77
Validation r2 = 0.746375
Epoch 78
Validation r2 = 0.733956
Epoch 79
Validation r2 = 0.750608
Epoch 80
Validation r2 = 0.754299
Epoch 81
Validation r2 = 0.723854
Epoch 82
Validation r2 = 0.752382
Epoch 83
Validation r2 = 0.735716
Epoch 84
Validation r2 = 0.742203
Epoch 85
Validation r2 = 0.756521
Epoch 86
Validation r2 = 0.721760
Epoch 87
Validation r2 = 0.757178
Epoch 88
Validation r2 = 0.754321
Epoch 89
Validation r2 = 0.746680
Epoch 90
Validation r2 = 0.759474
Epoch 91
Validation r2 = 0.742615
Epoch 92
Validation r2 = 0.760536
Epoch 93
Validation r2 = 0.760989
Epoch 94
Validation r2 = 0.739329
Epoch 95
Validation r2 = 0.759350
Epoch 96
Validation r2 = 0.753752
Epoch 97
Validation r2 = 0.742473
Epoch 98
Validation r2 = 0.761535
Epoch 99
Validation r2 = 0.756451
Model 2 best validation r2 = 0.761535 on epoch 98
Moving model to cuda
Model 2 test mae = 0.291847
Model 2 test mse = 0.163031
Model 2 test r2 = 0.818384
Ensemble test mae = 0.309404
Ensemble test mse = 0.187576
Ensemble test r2 = 0.791041
1-fold cross validation
Seed 0 ==> test r2 = 0.791041
Overall test r2 = 0.791041 +/- 0.000000
