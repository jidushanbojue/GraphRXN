Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 335 | train size = 268 | val size = 67 | test size = 84
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.082387
Epoch 1
Validation r2 = -0.011995
Epoch 2
Validation r2 = -0.000582
Epoch 3
Validation r2 = 0.017918
Epoch 4
Validation r2 = -0.024756
Epoch 5
Validation r2 = 0.004394
Epoch 6
Validation r2 = 0.039941
Epoch 7
Validation r2 = 0.045084
Epoch 8
Validation r2 = -0.064109
Epoch 9
Validation r2 = 0.079054
Epoch 10
Validation r2 = 0.114221
Epoch 11
Validation r2 = 0.044704
Epoch 12
Validation r2 = 0.208514
Epoch 13
Validation r2 = 0.247819
Epoch 14
Validation r2 = 0.298756
Epoch 15
Validation r2 = 0.458341
Epoch 16
Validation r2 = 0.448365
Epoch 17
Validation r2 = 0.561988
Epoch 18
Validation r2 = 0.549091
Epoch 19
Validation r2 = 0.605681
Epoch 20
Validation r2 = 0.599679
Epoch 21
Validation r2 = 0.604680
Epoch 22
Validation r2 = 0.656906
Epoch 23
Validation r2 = 0.630749
Epoch 24
Validation r2 = 0.619369
Epoch 25
Validation r2 = 0.658377
Epoch 26
Validation r2 = 0.667060
Epoch 27
Validation r2 = 0.688897
Epoch 28
Validation r2 = 0.680557
Epoch 29
Validation r2 = 0.649590
Epoch 30
Validation r2 = 0.664825
Epoch 31
Validation r2 = 0.683367
Epoch 32
Validation r2 = 0.699476
Epoch 33
Validation r2 = 0.681379
Epoch 34
Validation r2 = 0.692607
Epoch 35
Validation r2 = 0.710323
Epoch 36
Validation r2 = 0.705907
Epoch 37
Validation r2 = 0.696615
Epoch 38
Validation r2 = 0.698242
Epoch 39
Validation r2 = 0.708564
Epoch 40
Validation r2 = 0.692644
Epoch 41
Validation r2 = 0.697894
Epoch 42
Validation r2 = 0.682482
Epoch 43
Validation r2 = 0.653013
Epoch 44
Validation r2 = 0.685103
Epoch 45
Validation r2 = 0.708926
Epoch 46
Validation r2 = 0.681147
Epoch 47
Validation r2 = 0.710944
Epoch 48
Validation r2 = 0.704855
Epoch 49
Validation r2 = 0.657964
Epoch 50
Validation r2 = 0.697354
Epoch 51
Validation r2 = 0.694517
Epoch 52
Validation r2 = 0.662802
Epoch 53
Validation r2 = 0.701652
Epoch 54
Validation r2 = 0.709313
Epoch 55
Validation r2 = 0.665521
Epoch 56
Validation r2 = 0.701444
Epoch 57
Validation r2 = 0.692358
Epoch 58
Validation r2 = 0.648245
Epoch 59
Validation r2 = 0.692626
Epoch 60
Validation r2 = 0.674605
Epoch 61
Validation r2 = 0.675747
Epoch 62
Validation r2 = 0.667486
Epoch 63
Validation r2 = 0.649379
Epoch 64
Validation r2 = 0.685060
Epoch 65
Validation r2 = 0.647699
Epoch 66
Validation r2 = 0.686130
Epoch 67
Validation r2 = 0.662971
Epoch 68
Validation r2 = 0.646962
Epoch 69
Validation r2 = 0.670684
Epoch 70
Validation r2 = 0.636823
Epoch 71
Validation r2 = 0.674197
Epoch 72
Validation r2 = 0.647806
Epoch 73
Validation r2 = 0.648444
Epoch 74
Validation r2 = 0.647387
Epoch 75
Validation r2 = 0.659038
Epoch 76
Validation r2 = 0.638282
Epoch 77
Validation r2 = 0.644963
Epoch 78
Validation r2 = 0.628958
Epoch 79
Validation r2 = 0.614020
Epoch 80
Validation r2 = 0.636208
Epoch 81
Validation r2 = 0.617859
Epoch 82
Validation r2 = 0.668600
Epoch 83
Validation r2 = 0.628562
Epoch 84
Validation r2 = 0.656269
Epoch 85
Validation r2 = 0.620785
Epoch 86
Validation r2 = 0.647910
Epoch 87
Validation r2 = 0.649140
Epoch 88
Validation r2 = 0.611054
Epoch 89
Validation r2 = 0.658589
Epoch 90
Validation r2 = 0.642758
Epoch 91
Validation r2 = 0.636991
Epoch 92
Validation r2 = 0.665700
Epoch 93
Validation r2 = 0.641553
Epoch 94
Validation r2 = 0.647132
Epoch 95
Validation r2 = 0.660766
Epoch 96
Validation r2 = 0.627303
Epoch 97
Validation r2 = 0.653774
Epoch 98
Validation r2 = 0.644714
Epoch 99
Validation r2 = 0.638290
Model 0 best validation r2 = 0.710944 on epoch 47
Moving model to cuda
Model 0 test mae = 0.469633
Model 0 test mse = 0.390328
Model 0 test r2 = 0.656063
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.040193
Epoch 1
Validation r2 = -0.010447
Epoch 2
Validation r2 = -0.000332
Epoch 3
Validation r2 = -0.111397
Epoch 4
Validation r2 = -0.024507
Epoch 5
Validation r2 = -0.001951
Epoch 6
Validation r2 = -0.016415
Epoch 7
Validation r2 = -0.017139
Epoch 8
Validation r2 = -0.001047
Epoch 9
Validation r2 = -0.010108
Epoch 10
Validation r2 = 0.001535
Epoch 11
Validation r2 = 0.021781
Epoch 12
Validation r2 = -0.020867
Epoch 13
Validation r2 = 0.032428
Epoch 14
Validation r2 = 0.039437
Epoch 15
Validation r2 = 0.100717
Epoch 16
Validation r2 = 0.054953
Epoch 17
Validation r2 = 0.169608
Epoch 18
Validation r2 = 0.181097
Epoch 19
Validation r2 = 0.186471
Epoch 20
Validation r2 = 0.301743
Epoch 21
Validation r2 = 0.359041
Epoch 22
Validation r2 = 0.437189
Epoch 23
Validation r2 = 0.488982
Epoch 24
Validation r2 = 0.535919
Epoch 25
Validation r2 = 0.433803
Epoch 26
Validation r2 = 0.548993
Epoch 27
Validation r2 = 0.562597
Epoch 28
Validation r2 = 0.488086
Epoch 29
Validation r2 = 0.567772
Epoch 30
Validation r2 = 0.588179
Epoch 31
Validation r2 = 0.587259
Epoch 32
Validation r2 = 0.620828
Epoch 33
Validation r2 = 0.591526
Epoch 34
Validation r2 = 0.638765
Epoch 35
Validation r2 = 0.634279
Epoch 36
Validation r2 = 0.655050
Epoch 37
Validation r2 = 0.672926
Epoch 38
Validation r2 = 0.679464
Epoch 39
Validation r2 = 0.696132
Epoch 40
Validation r2 = 0.697795
Epoch 41
Validation r2 = 0.687127
Epoch 42
Validation r2 = 0.685955
Epoch 43
Validation r2 = 0.669533
Epoch 44
Validation r2 = 0.657935
Epoch 45
Validation r2 = 0.679982
Epoch 46
Validation r2 = 0.687500
Epoch 47
Validation r2 = 0.682440
Epoch 48
Validation r2 = 0.689918
Epoch 49
Validation r2 = 0.693536
Epoch 50
Validation r2 = 0.694980
Epoch 51
Validation r2 = 0.695469
Epoch 52
Validation r2 = 0.692004
Epoch 53
Validation r2 = 0.689128
Epoch 54
Validation r2 = 0.698895
Epoch 55
Validation r2 = 0.703417
Epoch 56
Validation r2 = 0.715443
Epoch 57
Validation r2 = 0.710865
Epoch 58
Validation r2 = 0.703453
Epoch 59
Validation r2 = 0.700387
Epoch 60
Validation r2 = 0.692160
Epoch 61
Validation r2 = 0.698318
Epoch 62
Validation r2 = 0.697643
Epoch 63
Validation r2 = 0.694008
Epoch 64
Validation r2 = 0.690890
Epoch 65
Validation r2 = 0.705265
Epoch 66
Validation r2 = 0.706636
Epoch 67
Validation r2 = 0.695172
Epoch 68
Validation r2 = 0.699257
Epoch 69
Validation r2 = 0.699709
Epoch 70
Validation r2 = 0.696680
Epoch 71
Validation r2 = 0.693252
Epoch 72
Validation r2 = 0.694022
Epoch 73
Validation r2 = 0.700856
Epoch 74
Validation r2 = 0.690686
Epoch 75
Validation r2 = 0.690669
Epoch 76
Validation r2 = 0.687703
Epoch 77
Validation r2 = 0.685094
Epoch 78
Validation r2 = 0.691785
Epoch 79
Validation r2 = 0.699201
Epoch 80
Validation r2 = 0.694540
Epoch 81
Validation r2 = 0.685297
Epoch 82
Validation r2 = 0.704608
Epoch 83
Validation r2 = 0.699939
Epoch 84
Validation r2 = 0.680996
Epoch 85
Validation r2 = 0.684766
Epoch 86
Validation r2 = 0.689693
Epoch 87
Validation r2 = 0.689527
Epoch 88
Validation r2 = 0.685123
Epoch 89
Validation r2 = 0.694186
Epoch 90
Validation r2 = 0.688216
Epoch 91
Validation r2 = 0.673823
Epoch 92
Validation r2 = 0.686001
Epoch 93
Validation r2 = 0.688546
Epoch 94
Validation r2 = 0.681272
Epoch 95
Validation r2 = 0.690578
Epoch 96
Validation r2 = 0.691310
Epoch 97
Validation r2 = 0.682173
Epoch 98
Validation r2 = 0.692515
Epoch 99
Validation r2 = 0.692070
Model 1 best validation r2 = 0.715443 on epoch 56
Moving model to cuda
Model 1 test mae = 0.468204
Model 1 test mse = 0.380158
Model 1 test r2 = 0.665024
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.002996
Epoch 1
Validation r2 = -0.080538
Epoch 2
Validation r2 = -0.032932
Epoch 3
Validation r2 = 0.006392
Epoch 4
Validation r2 = -0.011509
Epoch 5
Validation r2 = -0.032672
Epoch 6
Validation r2 = 0.035460
Epoch 7
Validation r2 = -0.029674
Epoch 8
Validation r2 = 0.045066
Epoch 9
Validation r2 = 0.062195
Epoch 10
Validation r2 = 0.084395
Epoch 11
Validation r2 = 0.111407
Epoch 12
Validation r2 = 0.128848
Epoch 13
Validation r2 = 0.180325
Epoch 14
Validation r2 = 0.250581
Epoch 15
Validation r2 = 0.127108
Epoch 16
Validation r2 = 0.303162
Epoch 17
Validation r2 = 0.357610
Epoch 18
Validation r2 = 0.361708
Epoch 19
Validation r2 = 0.476659
Epoch 20
Validation r2 = 0.540627
Epoch 21
Validation r2 = 0.576692
Epoch 22
Validation r2 = 0.600556
Epoch 23
Validation r2 = 0.602451
Epoch 24
Validation r2 = 0.619525
Epoch 25
Validation r2 = 0.585593
Epoch 26
Validation r2 = 0.641526
Epoch 27
Validation r2 = 0.652246
Epoch 28
Validation r2 = 0.619512
Epoch 29
Validation r2 = 0.633510
Epoch 30
Validation r2 = 0.623649
Epoch 31
Validation r2 = 0.642261
Epoch 32
Validation r2 = 0.645624
Epoch 33
Validation r2 = 0.643332
Epoch 34
Validation r2 = 0.648119
Epoch 35
Validation r2 = 0.655753
Epoch 36
Validation r2 = 0.654128
Epoch 37
Validation r2 = 0.628696
Epoch 38
Validation r2 = 0.656185
Epoch 39
Validation r2 = 0.658610
Epoch 40
Validation r2 = 0.654459
Epoch 41
Validation r2 = 0.674825
Epoch 42
Validation r2 = 0.685482
Epoch 43
Validation r2 = 0.679706
Epoch 44
Validation r2 = 0.667180
Epoch 45
Validation r2 = 0.662358
Epoch 46
Validation r2 = 0.679835
Epoch 47
Validation r2 = 0.685870
Epoch 48
Validation r2 = 0.681568
Epoch 49
Validation r2 = 0.665948
Epoch 50
Validation r2 = 0.666290
Epoch 51
Validation r2 = 0.666072
Epoch 52
Validation r2 = 0.670550
Epoch 53
Validation r2 = 0.664717
Epoch 54
Validation r2 = 0.660353
Epoch 55
Validation r2 = 0.674885
Epoch 56
Validation r2 = 0.667789
Epoch 57
Validation r2 = 0.646219
Epoch 58
Validation r2 = 0.652096
Epoch 59
Validation r2 = 0.671865
Epoch 60
Validation r2 = 0.669700
Epoch 61
Validation r2 = 0.671468
Epoch 62
Validation r2 = 0.669348
Epoch 63
Validation r2 = 0.665246
Epoch 64
Validation r2 = 0.665582
Epoch 65
Validation r2 = 0.667295
Epoch 66
Validation r2 = 0.670488
Epoch 67
Validation r2 = 0.647954
Epoch 68
Validation r2 = 0.643927
Epoch 69
Validation r2 = 0.663847
Epoch 70
Validation r2 = 0.663522
Epoch 71
Validation r2 = 0.660053
Epoch 72
Validation r2 = 0.670529
Epoch 73
Validation r2 = 0.656292
Epoch 74
Validation r2 = 0.652502
Epoch 75
Validation r2 = 0.669995
Epoch 76
Validation r2 = 0.640210
Epoch 77
Validation r2 = 0.652168
Epoch 78
Validation r2 = 0.669198
Epoch 79
Validation r2 = 0.646407
Epoch 80
Validation r2 = 0.644626
Epoch 81
Validation r2 = 0.657676
Epoch 82
Validation r2 = 0.651488
Epoch 83
Validation r2 = 0.663295
Epoch 84
Validation r2 = 0.644339
Epoch 85
Validation r2 = 0.659177
Epoch 86
Validation r2 = 0.652007
Epoch 87
Validation r2 = 0.667770
Epoch 88
Validation r2 = 0.640168
Epoch 89
Validation r2 = 0.666558
Epoch 90
Validation r2 = 0.662585
Epoch 91
Validation r2 = 0.664508
Epoch 92
Validation r2 = 0.681479
Epoch 93
Validation r2 = 0.637023
Epoch 94
Validation r2 = 0.675403
Epoch 95
Validation r2 = 0.684475
Epoch 96
Validation r2 = 0.623447
Epoch 97
Validation r2 = 0.644794
Epoch 98
Validation r2 = 0.663954
Epoch 99
Validation r2 = 0.654785
Model 2 best validation r2 = 0.685870 on epoch 47
Moving model to cuda
Model 2 test mae = 0.471975
Model 2 test mse = 0.388476
Model 2 test r2 = 0.657695
Ensemble test mae = 0.460751
Ensemble test mse = 0.378726
Ensemble test r2 = 0.666286
1-fold cross validation
Seed 0 ==> test r2 = 0.666286
Overall test r2 = 0.666286 +/- 0.000000
