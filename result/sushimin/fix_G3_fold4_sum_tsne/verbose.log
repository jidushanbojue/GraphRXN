Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 321 | train size = 256 | val size = 65 | test size = 80
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.425306
Epoch 1
Validation r2 = -0.176427
Epoch 2
Validation r2 = -0.057551
Epoch 3
Validation r2 = -0.034940
Epoch 4
Validation r2 = 0.015044
Epoch 5
Validation r2 = 0.062028
Epoch 6
Validation r2 = 0.136497
Epoch 7
Validation r2 = 0.180490
Epoch 8
Validation r2 = 0.177881
Epoch 9
Validation r2 = 0.139125
Epoch 10
Validation r2 = 0.271611
Epoch 11
Validation r2 = 0.302118
Epoch 12
Validation r2 = 0.292058
Epoch 13
Validation r2 = 0.377482
Epoch 14
Validation r2 = 0.430236
Epoch 15
Validation r2 = 0.415214
Epoch 16
Validation r2 = 0.455139
Epoch 17
Validation r2 = 0.530543
Epoch 18
Validation r2 = 0.499045
Epoch 19
Validation r2 = 0.613099
Epoch 20
Validation r2 = 0.642325
Epoch 21
Validation r2 = 0.601082
Epoch 22
Validation r2 = 0.664905
Epoch 23
Validation r2 = 0.714437
Epoch 24
Validation r2 = 0.692867
Epoch 25
Validation r2 = 0.660545
Epoch 26
Validation r2 = 0.712789
Epoch 27
Validation r2 = 0.618455
Epoch 28
Validation r2 = 0.701333
Epoch 29
Validation r2 = 0.687371
Epoch 30
Validation r2 = 0.595362
Epoch 31
Validation r2 = 0.664585
Epoch 32
Validation r2 = 0.647628
Epoch 33
Validation r2 = 0.617860
Epoch 34
Validation r2 = 0.681857
Epoch 35
Validation r2 = 0.665577
Epoch 36
Validation r2 = 0.622003
Epoch 37
Validation r2 = 0.690597
Epoch 38
Validation r2 = 0.632741
Epoch 39
Validation r2 = 0.686876
Epoch 40
Validation r2 = 0.697480
Epoch 41
Validation r2 = 0.663581
Epoch 42
Validation r2 = 0.691641
Epoch 43
Validation r2 = 0.688001
Epoch 44
Validation r2 = 0.694409
Epoch 45
Validation r2 = 0.693567
Epoch 46
Validation r2 = 0.700468
Epoch 47
Validation r2 = 0.706709
Epoch 48
Validation r2 = 0.707382
Epoch 49
Validation r2 = 0.707525
Epoch 50
Validation r2 = 0.712870
Epoch 51
Validation r2 = 0.712857
Epoch 52
Validation r2 = 0.723380
Epoch 53
Validation r2 = 0.690665
Epoch 54
Validation r2 = 0.726806
Epoch 55
Validation r2 = 0.706532
Epoch 56
Validation r2 = 0.728707
Epoch 57
Validation r2 = 0.715284
Epoch 58
Validation r2 = 0.726745
Epoch 59
Validation r2 = 0.733158
Epoch 60
Validation r2 = 0.700514
Epoch 61
Validation r2 = 0.735986
Epoch 62
Validation r2 = 0.730561
Epoch 63
Validation r2 = 0.720892
Epoch 64
Validation r2 = 0.735805
Epoch 65
Validation r2 = 0.732185
Epoch 66
Validation r2 = 0.730489
Epoch 67
Validation r2 = 0.742480
Epoch 68
Validation r2 = 0.735339
Epoch 69
Validation r2 = 0.740341
Epoch 70
Validation r2 = 0.742437
Epoch 71
Validation r2 = 0.721039
Epoch 72
Validation r2 = 0.744595
Epoch 73
Validation r2 = 0.741154
Epoch 74
Validation r2 = 0.729757
Epoch 75
Validation r2 = 0.743993
Epoch 76
Validation r2 = 0.742252
Epoch 77
Validation r2 = 0.736836
Epoch 78
Validation r2 = 0.747641
Epoch 79
Validation r2 = 0.739818
Epoch 80
Validation r2 = 0.742945
Epoch 81
Validation r2 = 0.744925
Epoch 82
Validation r2 = 0.733328
Epoch 83
Validation r2 = 0.746898
Epoch 84
Validation r2 = 0.746185
Epoch 85
Validation r2 = 0.730111
Epoch 86
Validation r2 = 0.749243
Epoch 87
Validation r2 = 0.740533
Epoch 88
Validation r2 = 0.729647
Epoch 89
Validation r2 = 0.748662
Epoch 90
Validation r2 = 0.746047
Epoch 91
Validation r2 = 0.734764
Epoch 92
Validation r2 = 0.747148
Epoch 93
Validation r2 = 0.743730
Epoch 94
Validation r2 = 0.736956
Epoch 95
Validation r2 = 0.748071
Epoch 96
Validation r2 = 0.747952
Epoch 97
Validation r2 = 0.732151
Epoch 98
Validation r2 = 0.751816
Epoch 99
Validation r2 = 0.746478
Model 0 best validation r2 = 0.751816 on epoch 98
Moving model to cuda
Model 0 test mae = 0.373629
Model 0 test mse = 0.244853
Model 0 test r2 = 0.754815
Ensemble test mae = 0.373629
Ensemble test mse = 0.244853
Ensemble test r2 = 0.754815
1-fold cross validation
Seed 0 ==> test r2 = 0.754815
Overall test r2 = 0.754815 +/- 0.000000
