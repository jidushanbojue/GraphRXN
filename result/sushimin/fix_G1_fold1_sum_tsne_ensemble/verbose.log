Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 253 | train size = 202 | val size = 51 | test size = 64
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -5.736837
Epoch 1
Validation r2 = 0.002335
Epoch 2
Validation r2 = -0.359644
Epoch 3
Validation r2 = -0.011633
Epoch 4
Validation r2 = -0.281168
Epoch 5
Validation r2 = -0.024253
Epoch 6
Validation r2 = -0.085680
Epoch 7
Validation r2 = 0.006054
Epoch 8
Validation r2 = -0.025410
Epoch 9
Validation r2 = -0.098973
Epoch 10
Validation r2 = -0.041380
Epoch 11
Validation r2 = 0.014921
Epoch 12
Validation r2 = 0.001484
Epoch 13
Validation r2 = 0.012644
Epoch 14
Validation r2 = 0.022736
Epoch 15
Validation r2 = -0.010176
Epoch 16
Validation r2 = -0.019293
Epoch 17
Validation r2 = 0.012178
Epoch 18
Validation r2 = 0.036492
Epoch 19
Validation r2 = 0.040459
Epoch 20
Validation r2 = 0.037866
Epoch 21
Validation r2 = 0.027079
Epoch 22
Validation r2 = 0.018548
Epoch 23
Validation r2 = 0.059133
Epoch 24
Validation r2 = 0.071478
Epoch 25
Validation r2 = 0.070493
Epoch 26
Validation r2 = 0.087665
Epoch 27
Validation r2 = 0.090535
Epoch 28
Validation r2 = 0.075747
Epoch 29
Validation r2 = 0.113796
Epoch 30
Validation r2 = 0.084558
Epoch 31
Validation r2 = 0.119862
Epoch 32
Validation r2 = 0.128757
Epoch 33
Validation r2 = 0.098134
Epoch 34
Validation r2 = 0.120854
Epoch 35
Validation r2 = 0.086480
Epoch 36
Validation r2 = 0.070677
Epoch 37
Validation r2 = 0.064432
Epoch 38
Validation r2 = -0.038829
Epoch 39
Validation r2 = -0.110647
Epoch 40
Validation r2 = -0.436203
Epoch 41
Validation r2 = -0.048150
Epoch 42
Validation r2 = -0.018151
Epoch 43
Validation r2 = 0.078637
Epoch 44
Validation r2 = -0.047622
Epoch 45
Validation r2 = -0.097522
Epoch 46
Validation r2 = 0.120818
Epoch 47
Validation r2 = 0.109098
Epoch 48
Validation r2 = 0.129911
Epoch 49
Validation r2 = 0.147732
Epoch 50
Validation r2 = -0.036104
Epoch 51
Validation r2 = -0.026857
Epoch 52
Validation r2 = 0.167402
Epoch 53
Validation r2 = 0.162921
Epoch 54
Validation r2 = 0.075558
Epoch 55
Validation r2 = 0.182928
Epoch 56
Validation r2 = 0.213184
Epoch 57
Validation r2 = 0.074060
Epoch 58
Validation r2 = 0.003790
Epoch 59
Validation r2 = 0.081173
Epoch 60
Validation r2 = 0.201899
Epoch 61
Validation r2 = 0.248090
Epoch 62
Validation r2 = 0.238739
Epoch 63
Validation r2 = 0.232918
Epoch 64
Validation r2 = 0.253423
Epoch 65
Validation r2 = 0.235120
Epoch 66
Validation r2 = 0.193122
Epoch 67
Validation r2 = 0.172981
Epoch 68
Validation r2 = 0.202611
Epoch 69
Validation r2 = 0.238936
Epoch 70
Validation r2 = 0.258126
Epoch 71
Validation r2 = 0.255789
Epoch 72
Validation r2 = 0.257925
Epoch 73
Validation r2 = 0.261485
Epoch 74
Validation r2 = 0.253513
Epoch 75
Validation r2 = 0.238096
Epoch 76
Validation r2 = 0.229464
Epoch 77
Validation r2 = 0.242669
Epoch 78
Validation r2 = 0.257003
Epoch 79
Validation r2 = 0.266293
Epoch 80
Validation r2 = 0.262510
Epoch 81
Validation r2 = 0.268620
Epoch 82
Validation r2 = 0.264716
Epoch 83
Validation r2 = 0.252156
Epoch 84
Validation r2 = 0.250325
Epoch 85
Validation r2 = 0.260381
Epoch 86
Validation r2 = 0.274308
Epoch 87
Validation r2 = 0.280790
Epoch 88
Validation r2 = 0.281971
Epoch 89
Validation r2 = 0.284154
Epoch 90
Validation r2 = 0.281064
Epoch 91
Validation r2 = 0.271543
Epoch 92
Validation r2 = 0.256452
Epoch 93
Validation r2 = 0.250609
Epoch 94
Validation r2 = 0.268934
Epoch 95
Validation r2 = 0.288915
Epoch 96
Validation r2 = 0.297352
Epoch 97
Validation r2 = 0.298935
Epoch 98
Validation r2 = 0.298426
Epoch 99
Validation r2 = 0.295095
Model 0 best validation r2 = 0.298935 on epoch 97
Moving model to cuda
Model 0 test mae = 0.436627
Model 0 test mse = 0.314852
Model 0 test r2 = 0.631481
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -2.704514
Epoch 1
Validation r2 = -0.497121
Epoch 2
Validation r2 = -0.094610
Epoch 3
Validation r2 = -0.059415
Epoch 4
Validation r2 = -0.000703
Epoch 5
Validation r2 = -0.068961
Epoch 6
Validation r2 = -0.004636
Epoch 7
Validation r2 = 0.008799
Epoch 8
Validation r2 = 0.013185
Epoch 9
Validation r2 = -0.020946
Epoch 10
Validation r2 = 0.002415
Epoch 11
Validation r2 = 0.020786
Epoch 12
Validation r2 = 0.027340
Epoch 13
Validation r2 = 0.023954
Epoch 14
Validation r2 = 0.032008
Epoch 15
Validation r2 = 0.056106
Epoch 16
Validation r2 = 0.053195
Epoch 17
Validation r2 = 0.047587
Epoch 18
Validation r2 = 0.064814
Epoch 19
Validation r2 = -0.064183
Epoch 20
Validation r2 = 0.077307
Epoch 21
Validation r2 = 0.018454
Epoch 22
Validation r2 = 0.045286
Epoch 23
Validation r2 = 0.052962
Epoch 24
Validation r2 = -0.003531
Epoch 25
Validation r2 = 0.034981
Epoch 26
Validation r2 = -0.080572
Epoch 27
Validation r2 = 0.052473
Epoch 28
Validation r2 = -0.002153
Epoch 29
Validation r2 = -0.059208
Epoch 30
Validation r2 = 0.130763
Epoch 31
Validation r2 = 0.129289
Epoch 32
Validation r2 = 0.063293
Epoch 33
Validation r2 = 0.003273
Epoch 34
Validation r2 = 0.155360
Epoch 35
Validation r2 = 0.160040
Epoch 36
Validation r2 = 0.000780
Epoch 37
Validation r2 = 0.132686
Epoch 38
Validation r2 = 0.098742
Epoch 39
Validation r2 = 0.125167
Epoch 40
Validation r2 = -0.156822
Epoch 41
Validation r2 = 0.161296
Epoch 42
Validation r2 = 0.179124
Epoch 43
Validation r2 = 0.186617
Epoch 44
Validation r2 = 0.166871
Epoch 45
Validation r2 = 0.031683
Epoch 46
Validation r2 = 0.135670
Epoch 47
Validation r2 = 0.197265
Epoch 48
Validation r2 = 0.202022
Epoch 49
Validation r2 = 0.149446
Epoch 50
Validation r2 = 0.100760
Epoch 51
Validation r2 = 0.200144
Epoch 52
Validation r2 = 0.183259
Epoch 53
Validation r2 = 0.196418
Epoch 54
Validation r2 = 0.019487
Epoch 55
Validation r2 = 0.190404
Epoch 56
Validation r2 = 0.212569
Epoch 57
Validation r2 = 0.232231
Epoch 58
Validation r2 = 0.217635
Epoch 59
Validation r2 = 0.041746
Epoch 60
Validation r2 = 0.119479
Epoch 61
Validation r2 = 0.264893
Epoch 62
Validation r2 = 0.225355
Epoch 63
Validation r2 = 0.244441
Epoch 64
Validation r2 = 0.261499
Epoch 65
Validation r2 = 0.128510
Epoch 66
Validation r2 = 0.112177
Epoch 67
Validation r2 = 0.249210
Epoch 68
Validation r2 = 0.290040
Epoch 69
Validation r2 = 0.277955
Epoch 70
Validation r2 = 0.293854
Epoch 71
Validation r2 = 0.277981
Epoch 72
Validation r2 = 0.224286
Epoch 73
Validation r2 = 0.232899
Epoch 74
Validation r2 = 0.270350
Epoch 75
Validation r2 = 0.287573
Epoch 76
Validation r2 = 0.294798
Epoch 77
Validation r2 = 0.293057
Epoch 78
Validation r2 = 0.293298
Epoch 79
Validation r2 = 0.288603
Epoch 80
Validation r2 = 0.284827
Epoch 81
Validation r2 = 0.258190
Epoch 82
Validation r2 = 0.253617
Epoch 83
Validation r2 = 0.271364
Epoch 84
Validation r2 = 0.296229
Epoch 85
Validation r2 = 0.302421
Epoch 86
Validation r2 = 0.299302
Epoch 87
Validation r2 = 0.295199
Epoch 88
Validation r2 = 0.294716
Epoch 89
Validation r2 = 0.295344
Epoch 90
Validation r2 = 0.301329
Epoch 91
Validation r2 = 0.319488
Epoch 92
Validation r2 = 0.335266
Epoch 93
Validation r2 = 0.337658
Epoch 94
Validation r2 = 0.329216
Epoch 95
Validation r2 = 0.319488
Epoch 96
Validation r2 = 0.318447
Epoch 97
Validation r2 = 0.333683
Epoch 98
Validation r2 = 0.340863
Epoch 99
Validation r2 = 0.348623
Model 1 best validation r2 = 0.348623 on epoch 99
Moving model to cuda
Model 1 test mae = 0.429409
Model 1 test mse = 0.298964
Model 1 test r2 = 0.650077
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -5.954633
Epoch 1
Validation r2 = -0.005399
Epoch 2
Validation r2 = -0.398669
Epoch 3
Validation r2 = 0.006833
Epoch 4
Validation r2 = -0.175984
Epoch 5
Validation r2 = 0.015894
Epoch 6
Validation r2 = -0.269970
Epoch 7
Validation r2 = -0.147163
Epoch 8
Validation r2 = 0.014860
Epoch 9
Validation r2 = -0.030738
Epoch 10
Validation r2 = -0.002423
Epoch 11
Validation r2 = 0.009556
Epoch 12
Validation r2 = -0.060087
Epoch 13
Validation r2 = -0.174203
Epoch 14
Validation r2 = -0.079718
Epoch 15
Validation r2 = 0.023869
Epoch 16
Validation r2 = 0.029538
Epoch 17
Validation r2 = 0.009687
Epoch 18
Validation r2 = 0.036216
Epoch 19
Validation r2 = 0.042078
Epoch 20
Validation r2 = -0.011970
Epoch 21
Validation r2 = -0.052280
Epoch 22
Validation r2 = -0.029137
Epoch 23
Validation r2 = 0.027848
Epoch 24
Validation r2 = 0.072805
Epoch 25
Validation r2 = 0.077845
Epoch 26
Validation r2 = 0.074686
Epoch 27
Validation r2 = 0.094102
Epoch 28
Validation r2 = 0.094096
Epoch 29
Validation r2 = -0.002462
Epoch 30
Validation r2 = -0.012948
Epoch 31
Validation r2 = 0.074999
Epoch 32
Validation r2 = 0.119495
Epoch 33
Validation r2 = 0.081756
Epoch 34
Validation r2 = 0.113030
Epoch 35
Validation r2 = 0.113939
Epoch 36
Validation r2 = 0.017009
Epoch 37
Validation r2 = -0.042927
Epoch 38
Validation r2 = 0.050053
Epoch 39
Validation r2 = 0.125954
Epoch 40
Validation r2 = 0.095000
Epoch 41
Validation r2 = 0.097885
Epoch 42
Validation r2 = 0.139631
Epoch 43
Validation r2 = 0.060736
Epoch 44
Validation r2 = -0.006316
Epoch 45
Validation r2 = 0.073890
Epoch 46
Validation r2 = 0.161806
Epoch 47
Validation r2 = 0.160768
Epoch 48
Validation r2 = 0.153391
Epoch 49
Validation r2 = 0.183088
Epoch 50
Validation r2 = 0.165456
Epoch 51
Validation r2 = 0.115550
Epoch 52
Validation r2 = 0.111709
Epoch 53
Validation r2 = 0.169688
Epoch 54
Validation r2 = 0.190740
Epoch 55
Validation r2 = 0.180829
Epoch 56
Validation r2 = 0.188116
Epoch 57
Validation r2 = 0.176681
Epoch 58
Validation r2 = 0.100984
Epoch 59
Validation r2 = 0.094781
Epoch 60
Validation r2 = 0.158358
Epoch 61
Validation r2 = 0.192648
Epoch 62
Validation r2 = 0.191706
Epoch 63
Validation r2 = 0.196061
Epoch 64
Validation r2 = 0.156965
Epoch 65
Validation r2 = 0.126422
Epoch 66
Validation r2 = 0.162597
Epoch 67
Validation r2 = 0.204104
Epoch 68
Validation r2 = 0.222826
Epoch 69
Validation r2 = 0.227562
Epoch 70
Validation r2 = 0.229650
Epoch 71
Validation r2 = 0.217648
Epoch 72
Validation r2 = 0.204278
Epoch 73
Validation r2 = 0.202275
Epoch 74
Validation r2 = 0.227889
Epoch 75
Validation r2 = 0.251881
Epoch 76
Validation r2 = 0.264782
Epoch 77
Validation r2 = 0.269188
Epoch 78
Validation r2 = 0.271968
Epoch 79
Validation r2 = 0.262516
Epoch 80
Validation r2 = 0.243564
Epoch 81
Validation r2 = 0.269779
Epoch 82
Validation r2 = 0.275129
Epoch 83
Validation r2 = 0.282184
Epoch 84
Validation r2 = 0.284196
Epoch 85
Validation r2 = 0.291839
Epoch 86
Validation r2 = 0.296414
Epoch 87
Validation r2 = 0.289482
Epoch 88
Validation r2 = 0.290529
Epoch 89
Validation r2 = 0.299178
Epoch 90
Validation r2 = 0.308394
Epoch 91
Validation r2 = 0.309348
Epoch 92
Validation r2 = 0.305009
Epoch 93
Validation r2 = 0.298839
Epoch 94
Validation r2 = 0.272938
Epoch 95
Validation r2 = 0.252018
Epoch 96
Validation r2 = 0.279461
Epoch 97
Validation r2 = 0.306005
Epoch 98
Validation r2 = 0.319904
Epoch 99
Validation r2 = 0.322799
Model 2 best validation r2 = 0.322799 on epoch 99
Moving model to cuda
Model 2 test mae = 0.459510
Model 2 test mse = 0.346239
Model 2 test r2 = 0.594744
Ensemble test mae = 0.440556
Ensemble test mse = 0.315274
Ensemble test r2 = 0.630987
1-fold cross validation
Seed 0 ==> test r2 = 0.630987
Overall test r2 = 0.630987 +/- 0.000000
