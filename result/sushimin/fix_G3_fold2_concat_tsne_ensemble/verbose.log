Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 321 | train size = 256 | val size = 65 | test size = 80
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.013597
Epoch 1
Validation r2 = -0.041640
Epoch 2
Validation r2 = 0.028957
Epoch 3
Validation r2 = 0.092359
Epoch 4
Validation r2 = 0.133249
Epoch 5
Validation r2 = 0.356426
Epoch 6
Validation r2 = 0.390132
Epoch 7
Validation r2 = 0.497966
Epoch 8
Validation r2 = 0.366354
Epoch 9
Validation r2 = 0.477826
Epoch 10
Validation r2 = 0.497956
Epoch 11
Validation r2 = 0.568027
Epoch 12
Validation r2 = 0.552881
Epoch 13
Validation r2 = 0.570833
Epoch 14
Validation r2 = 0.603477
Epoch 15
Validation r2 = 0.612631
Epoch 16
Validation r2 = 0.608645
Epoch 17
Validation r2 = 0.616389
Epoch 18
Validation r2 = 0.620989
Epoch 19
Validation r2 = 0.617105
Epoch 20
Validation r2 = 0.643984
Epoch 21
Validation r2 = 0.661329
Epoch 22
Validation r2 = 0.664398
Epoch 23
Validation r2 = 0.675067
Epoch 24
Validation r2 = 0.674077
Epoch 25
Validation r2 = 0.656956
Epoch 26
Validation r2 = 0.667725
Epoch 27
Validation r2 = 0.669246
Epoch 28
Validation r2 = 0.677527
Epoch 29
Validation r2 = 0.673718
Epoch 30
Validation r2 = 0.676846
Epoch 31
Validation r2 = 0.663465
Epoch 32
Validation r2 = 0.683619
Epoch 33
Validation r2 = 0.682521
Epoch 34
Validation r2 = 0.679308
Epoch 35
Validation r2 = 0.677793
Epoch 36
Validation r2 = 0.673722
Epoch 37
Validation r2 = 0.674656
Epoch 38
Validation r2 = 0.679907
Epoch 39
Validation r2 = 0.676828
Epoch 40
Validation r2 = 0.679552
Epoch 41
Validation r2 = 0.677436
Epoch 42
Validation r2 = 0.676994
Epoch 43
Validation r2 = 0.678160
Epoch 44
Validation r2 = 0.675926
Epoch 45
Validation r2 = 0.684015
Epoch 46
Validation r2 = 0.691391
Epoch 47
Validation r2 = 0.681182
Epoch 48
Validation r2 = 0.692218
Epoch 49
Validation r2 = 0.700065
Epoch 50
Validation r2 = 0.694386
Epoch 51
Validation r2 = 0.693217
Epoch 52
Validation r2 = 0.700715
Epoch 53
Validation r2 = 0.703563
Epoch 54
Validation r2 = 0.707843
Epoch 55
Validation r2 = 0.701942
Epoch 56
Validation r2 = 0.700707
Epoch 57
Validation r2 = 0.708641
Epoch 58
Validation r2 = 0.710549
Epoch 59
Validation r2 = 0.702726
Epoch 60
Validation r2 = 0.713773
Epoch 61
Validation r2 = 0.723245
Epoch 62
Validation r2 = 0.722519
Epoch 63
Validation r2 = 0.721884
Epoch 64
Validation r2 = 0.720414
Epoch 65
Validation r2 = 0.718123
Epoch 66
Validation r2 = 0.718379
Epoch 67
Validation r2 = 0.720216
Epoch 68
Validation r2 = 0.716041
Epoch 69
Validation r2 = 0.714869
Epoch 70
Validation r2 = 0.724192
Epoch 71
Validation r2 = 0.722397
Epoch 72
Validation r2 = 0.723555
Epoch 73
Validation r2 = 0.725522
Epoch 74
Validation r2 = 0.717805
Epoch 75
Validation r2 = 0.718834
Epoch 76
Validation r2 = 0.728802
Epoch 77
Validation r2 = 0.720930
Epoch 78
Validation r2 = 0.723899
Epoch 79
Validation r2 = 0.726183
Epoch 80
Validation r2 = 0.723637
Epoch 81
Validation r2 = 0.720724
Epoch 82
Validation r2 = 0.727509
Epoch 83
Validation r2 = 0.729674
Epoch 84
Validation r2 = 0.728298
Epoch 85
Validation r2 = 0.726702
Epoch 86
Validation r2 = 0.724983
Epoch 87
Validation r2 = 0.726370
Epoch 88
Validation r2 = 0.727847
Epoch 89
Validation r2 = 0.720992
Epoch 90
Validation r2 = 0.721799
Epoch 91
Validation r2 = 0.727218
Epoch 92
Validation r2 = 0.729894
Epoch 93
Validation r2 = 0.727238
Epoch 94
Validation r2 = 0.716989
Epoch 95
Validation r2 = 0.721553
Epoch 96
Validation r2 = 0.730242
Epoch 97
Validation r2 = 0.732173
Epoch 98
Validation r2 = 0.724247
Epoch 99
Validation r2 = 0.721381
Model 0 best validation r2 = 0.732173 on epoch 97
Moving model to cuda
Model 0 test mae = 0.336253
Model 0 test mse = 0.235896
Model 0 test r2 = 0.736506
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.009329
Epoch 1
Validation r2 = -0.051716
Epoch 2
Validation r2 = -0.017967
Epoch 3
Validation r2 = 0.115271
Epoch 4
Validation r2 = 0.184813
Epoch 5
Validation r2 = 0.168436
Epoch 6
Validation r2 = 0.374404
Epoch 7
Validation r2 = 0.380142
Epoch 8
Validation r2 = 0.423335
Epoch 9
Validation r2 = 0.480565
Epoch 10
Validation r2 = 0.565968
Epoch 11
Validation r2 = 0.485869
Epoch 12
Validation r2 = 0.584651
Epoch 13
Validation r2 = 0.574288
Epoch 14
Validation r2 = 0.596472
Epoch 15
Validation r2 = 0.589967
Epoch 16
Validation r2 = 0.621058
Epoch 17
Validation r2 = 0.605260
Epoch 18
Validation r2 = 0.637387
Epoch 19
Validation r2 = 0.647480
Epoch 20
Validation r2 = 0.662896
Epoch 21
Validation r2 = 0.670023
Epoch 22
Validation r2 = 0.672334
Epoch 23
Validation r2 = 0.681511
Epoch 24
Validation r2 = 0.676715
Epoch 25
Validation r2 = 0.680409
Epoch 26
Validation r2 = 0.669342
Epoch 27
Validation r2 = 0.674187
Epoch 28
Validation r2 = 0.676539
Epoch 29
Validation r2 = 0.658307
Epoch 30
Validation r2 = 0.652774
Epoch 31
Validation r2 = 0.655460
Epoch 32
Validation r2 = 0.661837
Epoch 33
Validation r2 = 0.678736
Epoch 34
Validation r2 = 0.678238
Epoch 35
Validation r2 = 0.662441
Epoch 36
Validation r2 = 0.668184
Epoch 37
Validation r2 = 0.673518
Epoch 38
Validation r2 = 0.653588
Epoch 39
Validation r2 = 0.675348
Epoch 40
Validation r2 = 0.681007
Epoch 41
Validation r2 = 0.663595
Epoch 42
Validation r2 = 0.683808
Epoch 43
Validation r2 = 0.691992
Epoch 44
Validation r2 = 0.703436
Epoch 45
Validation r2 = 0.697009
Epoch 46
Validation r2 = 0.678639
Epoch 47
Validation r2 = 0.701552
Epoch 48
Validation r2 = 0.699925
Epoch 49
Validation r2 = 0.704478
Epoch 50
Validation r2 = 0.716578
Epoch 51
Validation r2 = 0.706568
Epoch 52
Validation r2 = 0.690906
Epoch 53
Validation r2 = 0.717392
Epoch 54
Validation r2 = 0.722153
Epoch 55
Validation r2 = 0.696620
Epoch 56
Validation r2 = 0.708843
Epoch 57
Validation r2 = 0.730524
Epoch 58
Validation r2 = 0.721532
Epoch 59
Validation r2 = 0.700512
Epoch 60
Validation r2 = 0.708751
Epoch 61
Validation r2 = 0.719479
Epoch 62
Validation r2 = 0.722004
Epoch 63
Validation r2 = 0.713242
Epoch 64
Validation r2 = 0.717360
Epoch 65
Validation r2 = 0.726362
Epoch 66
Validation r2 = 0.726636
Epoch 67
Validation r2 = 0.724551
Epoch 68
Validation r2 = 0.724683
Epoch 69
Validation r2 = 0.725454
Epoch 70
Validation r2 = 0.717532
Epoch 71
Validation r2 = 0.718947
Epoch 72
Validation r2 = 0.728073
Epoch 73
Validation r2 = 0.727365
Epoch 74
Validation r2 = 0.719173
Epoch 75
Validation r2 = 0.723174
Epoch 76
Validation r2 = 0.731403
Epoch 77
Validation r2 = 0.727529
Epoch 78
Validation r2 = 0.724475
Epoch 79
Validation r2 = 0.729178
Epoch 80
Validation r2 = 0.729760
Epoch 81
Validation r2 = 0.727867
Epoch 82
Validation r2 = 0.727727
Epoch 83
Validation r2 = 0.729882
Epoch 84
Validation r2 = 0.722071
Epoch 85
Validation r2 = 0.712998
Epoch 86
Validation r2 = 0.723720
Epoch 87
Validation r2 = 0.728661
Epoch 88
Validation r2 = 0.727201
Epoch 89
Validation r2 = 0.731204
Epoch 90
Validation r2 = 0.727050
Epoch 91
Validation r2 = 0.729897
Epoch 92
Validation r2 = 0.730821
Epoch 93
Validation r2 = 0.724598
Epoch 94
Validation r2 = 0.726540
Epoch 95
Validation r2 = 0.728210
Epoch 96
Validation r2 = 0.732097
Epoch 97
Validation r2 = 0.722980
Epoch 98
Validation r2 = 0.726408
Epoch 99
Validation r2 = 0.730894
Model 1 best validation r2 = 0.732097 on epoch 96
Moving model to cuda
Model 1 test mae = 0.331966
Model 1 test mse = 0.234107
Model 1 test r2 = 0.738504
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.007170
Epoch 1
Validation r2 = -0.036401
Epoch 2
Validation r2 = 0.106218
Epoch 3
Validation r2 = 0.191664
Epoch 4
Validation r2 = 0.276660
Epoch 5
Validation r2 = 0.461114
Epoch 6
Validation r2 = 0.550441
Epoch 7
Validation r2 = 0.411859
Epoch 8
Validation r2 = 0.543282
Epoch 9
Validation r2 = 0.536134
Epoch 10
Validation r2 = 0.571577
Epoch 11
Validation r2 = 0.575428
Epoch 12
Validation r2 = 0.605101
Epoch 13
Validation r2 = 0.620578
Epoch 14
Validation r2 = 0.596316
Epoch 15
Validation r2 = 0.632738
Epoch 16
Validation r2 = 0.631954
Epoch 17
Validation r2 = 0.658015
Epoch 18
Validation r2 = 0.682983
Epoch 19
Validation r2 = 0.688268
Epoch 20
Validation r2 = 0.673474
Epoch 21
Validation r2 = 0.658733
Epoch 22
Validation r2 = 0.666770
Epoch 23
Validation r2 = 0.669569
Epoch 24
Validation r2 = 0.677108
Epoch 25
Validation r2 = 0.669083
Epoch 26
Validation r2 = 0.685406
Epoch 27
Validation r2 = 0.689276
Epoch 28
Validation r2 = 0.689977
Epoch 29
Validation r2 = 0.693954
Epoch 30
Validation r2 = 0.678837
Epoch 31
Validation r2 = 0.671743
Epoch 32
Validation r2 = 0.695412
Epoch 33
Validation r2 = 0.695982
Epoch 34
Validation r2 = 0.692765
Epoch 35
Validation r2 = 0.704149
Epoch 36
Validation r2 = 0.699663
Epoch 37
Validation r2 = 0.691323
Epoch 38
Validation r2 = 0.713392
Epoch 39
Validation r2 = 0.719829
Epoch 40
Validation r2 = 0.718598
Epoch 41
Validation r2 = 0.703432
Epoch 42
Validation r2 = 0.720331
Epoch 43
Validation r2 = 0.724814
Epoch 44
Validation r2 = 0.722966
Epoch 45
Validation r2 = 0.725520
Epoch 46
Validation r2 = 0.735537
Epoch 47
Validation r2 = 0.735717
Epoch 48
Validation r2 = 0.710485
Epoch 49
Validation r2 = 0.722210
Epoch 50
Validation r2 = 0.731879
Epoch 51
Validation r2 = 0.734652
Epoch 52
Validation r2 = 0.740145
Epoch 53
Validation r2 = 0.742625
Epoch 54
Validation r2 = 0.744648
Epoch 55
Validation r2 = 0.738499
Epoch 56
Validation r2 = 0.737390
Epoch 57
Validation r2 = 0.742661
Epoch 58
Validation r2 = 0.743068
Epoch 59
Validation r2 = 0.741424
Epoch 60
Validation r2 = 0.738425
Epoch 61
Validation r2 = 0.731844
Epoch 62
Validation r2 = 0.731887
Epoch 63
Validation r2 = 0.746242
Epoch 64
Validation r2 = 0.751125
Epoch 65
Validation r2 = 0.748911
Epoch 66
Validation r2 = 0.742133
Epoch 67
Validation r2 = 0.734069
Epoch 68
Validation r2 = 0.744005
Epoch 69
Validation r2 = 0.744152
Epoch 70
Validation r2 = 0.740559
Epoch 71
Validation r2 = 0.742780
Epoch 72
Validation r2 = 0.740080
Epoch 73
Validation r2 = 0.732026
Epoch 74
Validation r2 = 0.735341
Epoch 75
Validation r2 = 0.741062
Epoch 76
Validation r2 = 0.743067
Epoch 77
Validation r2 = 0.733794
Epoch 78
Validation r2 = 0.731402
Epoch 79
Validation r2 = 0.740388
Epoch 80
Validation r2 = 0.738398
Epoch 81
Validation r2 = 0.740003
Epoch 82
Validation r2 = 0.738857
Epoch 83
Validation r2 = 0.734341
Epoch 84
Validation r2 = 0.736620
Epoch 85
Validation r2 = 0.735849
Epoch 86
Validation r2 = 0.731707
Epoch 87
Validation r2 = 0.734862
Epoch 88
Validation r2 = 0.737870
Epoch 89
Validation r2 = 0.737538
Epoch 90
Validation r2 = 0.736020
Epoch 91
Validation r2 = 0.731434
Epoch 92
Validation r2 = 0.728369
Epoch 93
Validation r2 = 0.723765
Epoch 94
Validation r2 = 0.732957
Epoch 95
Validation r2 = 0.735838
Epoch 96
Validation r2 = 0.732747
Epoch 97
Validation r2 = 0.728241
Epoch 98
Validation r2 = 0.727023
Epoch 99
Validation r2 = 0.728148
Model 2 best validation r2 = 0.751125 on epoch 64
Moving model to cuda
Model 2 test mae = 0.324604
Model 2 test mse = 0.214152
Model 2 test r2 = 0.760794
Ensemble test mae = 0.325778
Ensemble test mse = 0.223271
Ensemble test r2 = 0.750609
1-fold cross validation
Seed 0 ==> test r2 = 0.750609
Overall test r2 = 0.750609 +/- 0.000000
