Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,247 | train size = 997 | val size = 250 | test size = 311
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.172668
Epoch 1
Validation r2 = 0.012405
Epoch 2
Validation r2 = 0.093038
Epoch 3
Validation r2 = 0.049509
Epoch 4
Validation r2 = 0.176767
Epoch 5
Validation r2 = 0.186748
Epoch 6
Validation r2 = 0.281091
Epoch 7
Validation r2 = 0.445099
Epoch 8
Validation r2 = 0.437027
Epoch 9
Validation r2 = 0.486370
Epoch 10
Validation r2 = 0.540946
Epoch 11
Validation r2 = 0.542808
Epoch 12
Validation r2 = 0.429097
Epoch 13
Validation r2 = 0.527545
Epoch 14
Validation r2 = 0.585025
Epoch 15
Validation r2 = 0.585720
Epoch 16
Validation r2 = 0.592979
Epoch 17
Validation r2 = 0.625309
Epoch 18
Validation r2 = 0.624973
Epoch 19
Validation r2 = 0.629277
Epoch 20
Validation r2 = 0.666012
Epoch 21
Validation r2 = 0.603310
Epoch 22
Validation r2 = 0.650407
Epoch 23
Validation r2 = 0.631206
Epoch 24
Validation r2 = 0.674308
Epoch 25
Validation r2 = 0.673035
Epoch 26
Validation r2 = 0.676998
Epoch 27
Validation r2 = 0.692525
Epoch 28
Validation r2 = 0.690211
Epoch 29
Validation r2 = 0.686916
Epoch 30
Validation r2 = 0.685870
Epoch 31
Validation r2 = 0.707717
Epoch 32
Validation r2 = 0.707044
Epoch 33
Validation r2 = 0.695476
Epoch 34
Validation r2 = 0.696967
Epoch 35
Validation r2 = 0.676313
Epoch 36
Validation r2 = 0.674868
Epoch 37
Validation r2 = 0.673273
Epoch 38
Validation r2 = 0.600185
Epoch 39
Validation r2 = 0.684675
Epoch 40
Validation r2 = 0.668817
Epoch 41
Validation r2 = 0.667122
Epoch 42
Validation r2 = 0.660703
Epoch 43
Validation r2 = 0.646523
Epoch 44
Validation r2 = 0.641569
Epoch 45
Validation r2 = 0.644425
Epoch 46
Validation r2 = 0.635115
Epoch 47
Validation r2 = 0.654439
Epoch 48
Validation r2 = 0.620943
Epoch 49
Validation r2 = 0.630624
Epoch 50
Validation r2 = 0.641110
Epoch 51
Validation r2 = 0.636251
Epoch 52
Validation r2 = 0.654372
Epoch 53
Validation r2 = 0.647293
Epoch 54
Validation r2 = 0.647490
Epoch 55
Validation r2 = 0.632280
Epoch 56
Validation r2 = 0.624453
Epoch 57
Validation r2 = 0.632306
Epoch 58
Validation r2 = 0.636698
Epoch 59
Validation r2 = 0.624986
Epoch 60
Validation r2 = 0.636956
Epoch 61
Validation r2 = 0.608907
Epoch 62
Validation r2 = 0.646991
Epoch 63
Validation r2 = 0.622952
Epoch 64
Validation r2 = 0.653794
Epoch 65
Validation r2 = 0.636619
Epoch 66
Validation r2 = 0.614051
Epoch 67
Validation r2 = 0.642060
Epoch 68
Validation r2 = 0.644778
Epoch 69
Validation r2 = 0.645727
Epoch 70
Validation r2 = 0.627521
Epoch 71
Validation r2 = 0.633859
Epoch 72
Validation r2 = 0.631431
Epoch 73
Validation r2 = 0.625668
Epoch 74
Validation r2 = 0.641555
Epoch 75
Validation r2 = 0.626201
Epoch 76
Validation r2 = 0.624944
Epoch 77
Validation r2 = 0.626555
Epoch 78
Validation r2 = 0.638138
Epoch 79
Validation r2 = 0.633262
Epoch 80
Validation r2 = 0.625330
Epoch 81
Validation r2 = 0.622483
Epoch 82
Validation r2 = 0.628047
Epoch 83
Validation r2 = 0.632226
Epoch 84
Validation r2 = 0.615613
Epoch 85
Validation r2 = 0.629998
Epoch 86
Validation r2 = 0.634735
Epoch 87
Validation r2 = 0.627546
Epoch 88
Validation r2 = 0.633659
Epoch 89
Validation r2 = 0.628580
Epoch 90
Validation r2 = 0.622476
Epoch 91
Validation r2 = 0.627740
Epoch 92
Validation r2 = 0.621044
Epoch 93
Validation r2 = 0.625153
Epoch 94
Validation r2 = 0.628102
Epoch 95
Validation r2 = 0.620252
Epoch 96
Validation r2 = 0.624153
Epoch 97
Validation r2 = 0.620523
Epoch 98
Validation r2 = 0.629669
Epoch 99
Validation r2 = 0.626169
Model 0 best validation r2 = 0.707717 on epoch 31
Moving model to cuda
Model 0 test mae = 0.380207
Model 0 test mse = 0.251067
Model 0 test r2 = 0.699043
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.039559
Epoch 1
Validation r2 = 0.062158
Epoch 2
Validation r2 = 0.049201
Epoch 3
Validation r2 = 0.192388
Epoch 4
Validation r2 = 0.252603
Epoch 5
Validation r2 = 0.291892
Epoch 6
Validation r2 = 0.321214
Epoch 7
Validation r2 = 0.449270
Epoch 8
Validation r2 = 0.483554
Epoch 9
Validation r2 = 0.523060
Epoch 10
Validation r2 = 0.582084
Epoch 11
Validation r2 = 0.598476
Epoch 12
Validation r2 = 0.489421
Epoch 13
Validation r2 = 0.554784
Epoch 14
Validation r2 = 0.585782
Epoch 15
Validation r2 = 0.610012
Epoch 16
Validation r2 = 0.606789
Epoch 17
Validation r2 = 0.643415
Epoch 18
Validation r2 = 0.640276
Epoch 19
Validation r2 = 0.568953
Epoch 20
Validation r2 = 0.675876
Epoch 21
Validation r2 = 0.649065
Epoch 22
Validation r2 = 0.655012
Epoch 23
Validation r2 = 0.669285
Epoch 24
Validation r2 = 0.674957
Epoch 25
Validation r2 = 0.646970
Epoch 26
Validation r2 = 0.689612
Epoch 27
Validation r2 = 0.696877
Epoch 28
Validation r2 = 0.698210
Epoch 29
Validation r2 = 0.651977
Epoch 30
Validation r2 = 0.687306
Epoch 31
Validation r2 = 0.636568
Epoch 32
Validation r2 = 0.632504
Epoch 33
Validation r2 = 0.684004
Epoch 34
Validation r2 = 0.657573
Epoch 35
Validation r2 = 0.659227
Epoch 36
Validation r2 = 0.600642
Epoch 37
Validation r2 = 0.656462
Epoch 38
Validation r2 = 0.607837
Epoch 39
Validation r2 = 0.657079
Epoch 40
Validation r2 = 0.649986
Epoch 41
Validation r2 = 0.624982
Epoch 42
Validation r2 = 0.585674
Epoch 43
Validation r2 = 0.556011
Epoch 44
Validation r2 = 0.672318
Epoch 45
Validation r2 = 0.625237
Epoch 46
Validation r2 = 0.625184
Epoch 47
Validation r2 = 0.655075
Epoch 48
Validation r2 = 0.634308
Epoch 49
Validation r2 = 0.651118
Epoch 50
Validation r2 = 0.633491
Epoch 51
Validation r2 = 0.638402
Epoch 52
Validation r2 = 0.595796
Epoch 53
Validation r2 = 0.594001
Epoch 54
Validation r2 = 0.625258
Epoch 55
Validation r2 = 0.611445
Epoch 56
Validation r2 = 0.616183
Epoch 57
Validation r2 = 0.604872
Epoch 58
Validation r2 = 0.618960
Epoch 59
Validation r2 = 0.607777
Epoch 60
Validation r2 = 0.614330
Epoch 61
Validation r2 = 0.611659
Epoch 62
Validation r2 = 0.614643
Epoch 63
Validation r2 = 0.592560
Epoch 64
Validation r2 = 0.606882
Epoch 65
Validation r2 = 0.595669
Epoch 66
Validation r2 = 0.597242
Epoch 67
Validation r2 = 0.608522
Epoch 68
Validation r2 = 0.609776
Epoch 69
Validation r2 = 0.580870
Epoch 70
Validation r2 = 0.603205
Epoch 71
Validation r2 = 0.592455
Epoch 72
Validation r2 = 0.601853
Epoch 73
Validation r2 = 0.594904
Epoch 74
Validation r2 = 0.598315
Epoch 75
Validation r2 = 0.589166
Epoch 76
Validation r2 = 0.592904
Epoch 77
Validation r2 = 0.599720
Epoch 78
Validation r2 = 0.595186
Epoch 79
Validation r2 = 0.588472
Epoch 80
Validation r2 = 0.590527
Epoch 81
Validation r2 = 0.601808
Epoch 82
Validation r2 = 0.604008
Epoch 83
Validation r2 = 0.592337
Epoch 84
Validation r2 = 0.588022
Epoch 85
Validation r2 = 0.592348
Epoch 86
Validation r2 = 0.583624
Epoch 87
Validation r2 = 0.589505
Epoch 88
Validation r2 = 0.587233
Epoch 89
Validation r2 = 0.592129
Epoch 90
Validation r2 = 0.588928
Epoch 91
Validation r2 = 0.592988
Epoch 92
Validation r2 = 0.585014
Epoch 93
Validation r2 = 0.589017
Epoch 94
Validation r2 = 0.594361
Epoch 95
Validation r2 = 0.589504
Epoch 96
Validation r2 = 0.587854
Epoch 97
Validation r2 = 0.581793
Epoch 98
Validation r2 = 0.586122
Epoch 99
Validation r2 = 0.586822
Model 1 best validation r2 = 0.698210 on epoch 28
Moving model to cuda
Model 1 test mae = 0.376746
Model 1 test mse = 0.242797
Model 1 test r2 = 0.708955
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.028112
Epoch 1
Validation r2 = 0.066191
Epoch 2
Validation r2 = 0.124005
Epoch 3
Validation r2 = 0.173887
Epoch 4
Validation r2 = 0.215297
Epoch 5
Validation r2 = 0.349899
Epoch 6
Validation r2 = 0.462147
Epoch 7
Validation r2 = 0.388989
Epoch 8
Validation r2 = 0.508791
Epoch 9
Validation r2 = 0.509892
Epoch 10
Validation r2 = 0.541413
Epoch 11
Validation r2 = 0.571884
Epoch 12
Validation r2 = 0.529092
Epoch 13
Validation r2 = 0.602553
Epoch 14
Validation r2 = 0.618188
Epoch 15
Validation r2 = 0.576511
Epoch 16
Validation r2 = 0.624310
Epoch 17
Validation r2 = 0.632245
Epoch 18
Validation r2 = 0.646092
Epoch 19
Validation r2 = 0.622539
Epoch 20
Validation r2 = 0.655227
Epoch 21
Validation r2 = 0.675479
Epoch 22
Validation r2 = 0.673566
Epoch 23
Validation r2 = 0.665161
Epoch 24
Validation r2 = 0.657304
Epoch 25
Validation r2 = 0.695983
Epoch 26
Validation r2 = 0.691896
Epoch 27
Validation r2 = 0.706356
Epoch 28
Validation r2 = 0.676646
Epoch 29
Validation r2 = 0.711439
Epoch 30
Validation r2 = 0.701795
Epoch 31
Validation r2 = 0.681214
Epoch 32
Validation r2 = 0.715352
Epoch 33
Validation r2 = 0.713100
Epoch 34
Validation r2 = 0.696505
Epoch 35
Validation r2 = 0.695172
Epoch 36
Validation r2 = 0.695706
Epoch 37
Validation r2 = 0.676445
Epoch 38
Validation r2 = 0.719512
Epoch 39
Validation r2 = 0.663335
Epoch 40
Validation r2 = 0.695421
Epoch 41
Validation r2 = 0.668262
Epoch 42
Validation r2 = 0.714376
Epoch 43
Validation r2 = 0.677475
Epoch 44
Validation r2 = 0.680626
Epoch 45
Validation r2 = 0.661337
Epoch 46
Validation r2 = 0.671306
Epoch 47
Validation r2 = 0.690855
Epoch 48
Validation r2 = 0.701003
Epoch 49
Validation r2 = 0.679652
Epoch 50
Validation r2 = 0.671685
Epoch 51
Validation r2 = 0.704373
Epoch 52
Validation r2 = 0.683499
Epoch 53
Validation r2 = 0.676134
Epoch 54
Validation r2 = 0.677454
Epoch 55
Validation r2 = 0.685019
Epoch 56
Validation r2 = 0.683015
Epoch 57
Validation r2 = 0.694244
Epoch 58
Validation r2 = 0.680128
Epoch 59
Validation r2 = 0.680036
Epoch 60
Validation r2 = 0.665865
Epoch 61
Validation r2 = 0.674220
Epoch 62
Validation r2 = 0.681601
Epoch 63
Validation r2 = 0.673259
Epoch 64
Validation r2 = 0.668721
Epoch 65
Validation r2 = 0.673065
Epoch 66
Validation r2 = 0.669045
Epoch 67
Validation r2 = 0.666908
Epoch 68
Validation r2 = 0.670395
Epoch 69
Validation r2 = 0.663746
Epoch 70
Validation r2 = 0.669195
Epoch 71
Validation r2 = 0.655162
Epoch 72
Validation r2 = 0.663858
Epoch 73
Validation r2 = 0.666194
Epoch 74
Validation r2 = 0.674324
Epoch 75
Validation r2 = 0.669054
Epoch 76
Validation r2 = 0.656251
Epoch 77
Validation r2 = 0.668018
Epoch 78
Validation r2 = 0.674681
Epoch 79
Validation r2 = 0.656019
Epoch 80
Validation r2 = 0.668094
Epoch 81
Validation r2 = 0.645127
Epoch 82
Validation r2 = 0.659226
Epoch 83
Validation r2 = 0.667257
Epoch 84
Validation r2 = 0.661453
Epoch 85
Validation r2 = 0.659967
Epoch 86
Validation r2 = 0.648104
Epoch 87
Validation r2 = 0.663845
Epoch 88
Validation r2 = 0.662783
Epoch 89
Validation r2 = 0.670093
Epoch 90
Validation r2 = 0.658439
Epoch 91
Validation r2 = 0.664984
Epoch 92
Validation r2 = 0.653409
Epoch 93
Validation r2 = 0.657737
Epoch 94
Validation r2 = 0.652782
Epoch 95
Validation r2 = 0.652267
Epoch 96
Validation r2 = 0.651702
Epoch 97
Validation r2 = 0.656566
Epoch 98
Validation r2 = 0.658110
Epoch 99
Validation r2 = 0.658051
Model 2 best validation r2 = 0.719512 on epoch 38
Moving model to cuda
Model 2 test mae = 0.382641
Model 2 test mse = 0.246476
Model 2 test r2 = 0.704546
Ensemble test mae = 0.362513
Ensemble test mse = 0.225100
Ensemble test r2 = 0.730169
1-fold cross validation
Seed 0 ==> test r2 = 0.730169
Overall test r2 = 0.730169 +/- 0.000000
