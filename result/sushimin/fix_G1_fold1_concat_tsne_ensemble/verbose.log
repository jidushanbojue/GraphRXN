Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 253 | train size = 202 | val size = 51 | test size = 64
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.584971
Epoch 1
Validation r2 = -0.326349
Epoch 2
Validation r2 = 0.012115
Epoch 3
Validation r2 = 0.008025
Epoch 4
Validation r2 = -0.023981
Epoch 5
Validation r2 = -0.044758
Epoch 6
Validation r2 = 0.032176
Epoch 7
Validation r2 = 0.039883
Epoch 8
Validation r2 = 0.029464
Epoch 9
Validation r2 = 0.006358
Epoch 10
Validation r2 = 0.076698
Epoch 11
Validation r2 = 0.089362
Epoch 12
Validation r2 = -0.011091
Epoch 13
Validation r2 = 0.091567
Epoch 14
Validation r2 = 0.092520
Epoch 15
Validation r2 = -0.124791
Epoch 16
Validation r2 = 0.070929
Epoch 17
Validation r2 = -0.004394
Epoch 18
Validation r2 = 0.096728
Epoch 19
Validation r2 = -0.123894
Epoch 20
Validation r2 = -0.090908
Epoch 21
Validation r2 = 0.137754
Epoch 22
Validation r2 = 0.128157
Epoch 23
Validation r2 = 0.155718
Epoch 24
Validation r2 = 0.201323
Epoch 25
Validation r2 = 0.089810
Epoch 26
Validation r2 = 0.103034
Epoch 27
Validation r2 = 0.225945
Epoch 28
Validation r2 = 0.265451
Epoch 29
Validation r2 = 0.263556
Epoch 30
Validation r2 = 0.285765
Epoch 31
Validation r2 = 0.232922
Epoch 32
Validation r2 = 0.178805
Epoch 33
Validation r2 = 0.240652
Epoch 34
Validation r2 = 0.299765
Epoch 35
Validation r2 = 0.299371
Epoch 36
Validation r2 = 0.323025
Epoch 37
Validation r2 = 0.296627
Epoch 38
Validation r2 = 0.235028
Epoch 39
Validation r2 = 0.305080
Epoch 40
Validation r2 = 0.360019
Epoch 41
Validation r2 = 0.357230
Epoch 42
Validation r2 = 0.376361
Epoch 43
Validation r2 = 0.377839
Epoch 44
Validation r2 = 0.322649
Epoch 45
Validation r2 = 0.297834
Epoch 46
Validation r2 = 0.367728
Epoch 47
Validation r2 = 0.403264
Epoch 48
Validation r2 = 0.399799
Epoch 49
Validation r2 = 0.417197
Epoch 50
Validation r2 = 0.375980
Epoch 51
Validation r2 = 0.325539
Epoch 52
Validation r2 = 0.377704
Epoch 53
Validation r2 = 0.449443
Epoch 54
Validation r2 = 0.441084
Epoch 55
Validation r2 = 0.450076
Epoch 56
Validation r2 = 0.473002
Epoch 57
Validation r2 = 0.438232
Epoch 58
Validation r2 = 0.396150
Epoch 59
Validation r2 = 0.403372
Epoch 60
Validation r2 = 0.452896
Epoch 61
Validation r2 = 0.489889
Epoch 62
Validation r2 = 0.505858
Epoch 63
Validation r2 = 0.509482
Epoch 64
Validation r2 = 0.510881
Epoch 65
Validation r2 = 0.499645
Epoch 66
Validation r2 = 0.478149
Epoch 67
Validation r2 = 0.458666
Epoch 68
Validation r2 = 0.473288
Epoch 69
Validation r2 = 0.504753
Epoch 70
Validation r2 = 0.530093
Epoch 71
Validation r2 = 0.539738
Epoch 72
Validation r2 = 0.544056
Epoch 73
Validation r2 = 0.546019
Epoch 74
Validation r2 = 0.540793
Epoch 75
Validation r2 = 0.533564
Epoch 76
Validation r2 = 0.529604
Epoch 77
Validation r2 = 0.537156
Epoch 78
Validation r2 = 0.543542
Epoch 79
Validation r2 = 0.548274
Epoch 80
Validation r2 = 0.550066
Epoch 81
Validation r2 = 0.551737
Epoch 82
Validation r2 = 0.549802
Epoch 83
Validation r2 = 0.549123
Epoch 84
Validation r2 = 0.554543
Epoch 85
Validation r2 = 0.559745
Epoch 86
Validation r2 = 0.564909
Epoch 87
Validation r2 = 0.568805
Epoch 88
Validation r2 = 0.570139
Epoch 89
Validation r2 = 0.570488
Epoch 90
Validation r2 = 0.570370
Epoch 91
Validation r2 = 0.565928
Epoch 92
Validation r2 = 0.563321
Epoch 93
Validation r2 = 0.569448
Epoch 94
Validation r2 = 0.574956
Epoch 95
Validation r2 = 0.580395
Epoch 96
Validation r2 = 0.583452
Epoch 97
Validation r2 = 0.584776
Epoch 98
Validation r2 = 0.584109
Epoch 99
Validation r2 = 0.585846
Model 0 best validation r2 = 0.585846 on epoch 99
Moving model to cuda
Model 0 test mae = 0.383148
Model 0 test mse = 0.259523
Model 0 test r2 = 0.696241
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.287463
Epoch 1
Validation r2 = -0.195096
Epoch 2
Validation r2 = 0.018346
Epoch 3
Validation r2 = -0.042357
Epoch 4
Validation r2 = 0.018809
Epoch 5
Validation r2 = -0.051775
Epoch 6
Validation r2 = 0.043057
Epoch 7
Validation r2 = 0.051175
Epoch 8
Validation r2 = 0.070709
Epoch 9
Validation r2 = 0.055943
Epoch 10
Validation r2 = 0.087431
Epoch 11
Validation r2 = 0.133737
Epoch 12
Validation r2 = 0.158027
Epoch 13
Validation r2 = 0.157282
Epoch 14
Validation r2 = 0.154786
Epoch 15
Validation r2 = 0.101807
Epoch 16
Validation r2 = -0.561769
Epoch 17
Validation r2 = 0.098253
Epoch 18
Validation r2 = -0.045589
Epoch 19
Validation r2 = 0.245542
Epoch 20
Validation r2 = 0.219805
Epoch 21
Validation r2 = 0.086927
Epoch 22
Validation r2 = 0.170696
Epoch 23
Validation r2 = 0.304993
Epoch 24
Validation r2 = 0.359919
Epoch 25
Validation r2 = 0.350527
Epoch 26
Validation r2 = 0.352103
Epoch 27
Validation r2 = 0.365377
Epoch 28
Validation r2 = 0.335526
Epoch 29
Validation r2 = 0.237142
Epoch 30
Validation r2 = 0.177469
Epoch 31
Validation r2 = 0.232247
Epoch 32
Validation r2 = 0.295607
Epoch 33
Validation r2 = 0.302338
Epoch 34
Validation r2 = 0.296734
Epoch 35
Validation r2 = 0.294151
Epoch 36
Validation r2 = 0.284398
Epoch 37
Validation r2 = 0.272386
Epoch 38
Validation r2 = 0.291349
Epoch 39
Validation r2 = 0.307918
Epoch 40
Validation r2 = 0.321832
Epoch 41
Validation r2 = 0.334776
Epoch 42
Validation r2 = 0.347883
Epoch 43
Validation r2 = 0.393278
Epoch 44
Validation r2 = 0.432068
Epoch 45
Validation r2 = 0.454259
Epoch 46
Validation r2 = 0.462793
Epoch 47
Validation r2 = 0.456527
Epoch 48
Validation r2 = 0.439179
Epoch 49
Validation r2 = 0.448628
Epoch 50
Validation r2 = 0.482164
Epoch 51
Validation r2 = 0.508821
Epoch 52
Validation r2 = 0.511510
Epoch 53
Validation r2 = 0.510579
Epoch 54
Validation r2 = 0.486263
Epoch 55
Validation r2 = 0.475039
Epoch 56
Validation r2 = 0.508669
Epoch 57
Validation r2 = 0.534727
Epoch 58
Validation r2 = 0.543796
Epoch 59
Validation r2 = 0.540919
Epoch 60
Validation r2 = 0.536835
Epoch 61
Validation r2 = 0.540800
Epoch 62
Validation r2 = 0.550320
Epoch 63
Validation r2 = 0.553899
Epoch 64
Validation r2 = 0.553085
Epoch 65
Validation r2 = 0.554500
Epoch 66
Validation r2 = 0.555217
Epoch 67
Validation r2 = 0.570275
Epoch 68
Validation r2 = 0.572745
Epoch 69
Validation r2 = 0.576260
Epoch 70
Validation r2 = 0.576432
Epoch 71
Validation r2 = 0.590341
Epoch 72
Validation r2 = 0.593573
Epoch 73
Validation r2 = 0.593936
Epoch 74
Validation r2 = 0.585584
Epoch 75
Validation r2 = 0.571267
Epoch 76
Validation r2 = 0.586027
Epoch 77
Validation r2 = 0.603115
Epoch 78
Validation r2 = 0.605310
Epoch 79
Validation r2 = 0.608669
Epoch 80
Validation r2 = 0.612120
Epoch 81
Validation r2 = 0.597272
Epoch 82
Validation r2 = 0.580211
Epoch 83
Validation r2 = 0.577064
Epoch 84
Validation r2 = 0.599301
Epoch 85
Validation r2 = 0.611807
Epoch 86
Validation r2 = 0.614454
Epoch 87
Validation r2 = 0.621554
Epoch 88
Validation r2 = 0.631211
Epoch 89
Validation r2 = 0.631285
Epoch 90
Validation r2 = 0.620166
Epoch 91
Validation r2 = 0.614232
Epoch 92
Validation r2 = 0.618081
Epoch 93
Validation r2 = 0.623929
Epoch 94
Validation r2 = 0.623068
Epoch 95
Validation r2 = 0.616634
Epoch 96
Validation r2 = 0.615022
Epoch 97
Validation r2 = 0.617343
Epoch 98
Validation r2 = 0.613222
Epoch 99
Validation r2 = 0.611881
Model 1 best validation r2 = 0.631285 on epoch 89
Moving model to cuda
Model 1 test mae = 0.379891
Model 1 test mse = 0.262363
Model 1 test r2 = 0.692917
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.668307
Epoch 1
Validation r2 = -0.384028
Epoch 2
Validation r2 = 0.008841
Epoch 3
Validation r2 = -0.120329
Epoch 4
Validation r2 = -0.002141
Epoch 5
Validation r2 = -0.016738
Epoch 6
Validation r2 = 0.009481
Epoch 7
Validation r2 = 0.008448
Epoch 8
Validation r2 = -0.011910
Epoch 9
Validation r2 = -0.004157
Epoch 10
Validation r2 = 0.020216
Epoch 11
Validation r2 = 0.031756
Epoch 12
Validation r2 = 0.045973
Epoch 13
Validation r2 = 0.009418
Epoch 14
Validation r2 = 0.036089
Epoch 15
Validation r2 = 0.076102
Epoch 16
Validation r2 = 0.085248
Epoch 17
Validation r2 = 0.098059
Epoch 18
Validation r2 = 0.035146
Epoch 19
Validation r2 = 0.041239
Epoch 20
Validation r2 = 0.079355
Epoch 21
Validation r2 = 0.054356
Epoch 22
Validation r2 = 0.041996
Epoch 23
Validation r2 = 0.010345
Epoch 24
Validation r2 = 0.073581
Epoch 25
Validation r2 = -0.003982
Epoch 26
Validation r2 = 0.136280
Epoch 27
Validation r2 = 0.098586
Epoch 28
Validation r2 = 0.104684
Epoch 29
Validation r2 = 0.195893
Epoch 30
Validation r2 = 0.238524
Epoch 31
Validation r2 = 0.234911
Epoch 32
Validation r2 = 0.267661
Epoch 33
Validation r2 = 0.273224
Epoch 34
Validation r2 = 0.210840
Epoch 35
Validation r2 = 0.246515
Epoch 36
Validation r2 = 0.298519
Epoch 37
Validation r2 = 0.306633
Epoch 38
Validation r2 = 0.305307
Epoch 39
Validation r2 = 0.286084
Epoch 40
Validation r2 = 0.299839
Epoch 41
Validation r2 = 0.319828
Epoch 42
Validation r2 = 0.329801
Epoch 43
Validation r2 = 0.339410
Epoch 44
Validation r2 = 0.334346
Epoch 45
Validation r2 = 0.362561
Epoch 46
Validation r2 = 0.397099
Epoch 47
Validation r2 = 0.407516
Epoch 48
Validation r2 = 0.394674
Epoch 49
Validation r2 = 0.366076
Epoch 50
Validation r2 = 0.426151
Epoch 51
Validation r2 = 0.430236
Epoch 52
Validation r2 = 0.440586
Epoch 53
Validation r2 = 0.416150
Epoch 54
Validation r2 = 0.374306
Epoch 55
Validation r2 = 0.429713
Epoch 56
Validation r2 = 0.440915
Epoch 57
Validation r2 = 0.439490
Epoch 58
Validation r2 = 0.418509
Epoch 59
Validation r2 = 0.404816
Epoch 60
Validation r2 = 0.444542
Epoch 61
Validation r2 = 0.480059
Epoch 62
Validation r2 = 0.490571
Epoch 63
Validation r2 = 0.480850
Epoch 64
Validation r2 = 0.453504
Epoch 65
Validation r2 = 0.486175
Epoch 66
Validation r2 = 0.515851
Epoch 67
Validation r2 = 0.521971
Epoch 68
Validation r2 = 0.529463
Epoch 69
Validation r2 = 0.513395
Epoch 70
Validation r2 = 0.500361
Epoch 71
Validation r2 = 0.518540
Epoch 72
Validation r2 = 0.545084
Epoch 73
Validation r2 = 0.557240
Epoch 74
Validation r2 = 0.557251
Epoch 75
Validation r2 = 0.550735
Epoch 76
Validation r2 = 0.531649
Epoch 77
Validation r2 = 0.530016
Epoch 78
Validation r2 = 0.544129
Epoch 79
Validation r2 = 0.548697
Epoch 80
Validation r2 = 0.552497
Epoch 81
Validation r2 = 0.558931
Epoch 82
Validation r2 = 0.546004
Epoch 83
Validation r2 = 0.551592
Epoch 84
Validation r2 = 0.566468
Epoch 85
Validation r2 = 0.579502
Epoch 86
Validation r2 = 0.584876
Epoch 87
Validation r2 = 0.584035
Epoch 88
Validation r2 = 0.580624
Epoch 89
Validation r2 = 0.572939
Epoch 90
Validation r2 = 0.574232
Epoch 91
Validation r2 = 0.580123
Epoch 92
Validation r2 = 0.590559
Epoch 93
Validation r2 = 0.598070
Epoch 94
Validation r2 = 0.598223
Epoch 95
Validation r2 = 0.591423
Epoch 96
Validation r2 = 0.584017
Epoch 97
Validation r2 = 0.585440
Epoch 98
Validation r2 = 0.592341
Epoch 99
Validation r2 = 0.592443
Model 2 best validation r2 = 0.598223 on epoch 94
Moving model to cuda
Model 2 test mae = 0.365808
Model 2 test mse = 0.241020
Model 2 test r2 = 0.717898
Ensemble test mae = 0.374845
Ensemble test mse = 0.249228
Ensemble test r2 = 0.708291
1-fold cross validation
Seed 0 ==> test r2 = 0.708291
Overall test r2 = 0.708291 +/- 0.000000
