Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 254 | train size = 203 | val size = 51 | test size = 63
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -4.294151
Epoch 1
Validation r2 = -0.009409
Epoch 2
Validation r2 = -0.056006
Epoch 3
Validation r2 = -0.042604
Epoch 4
Validation r2 = -0.024600
Epoch 5
Validation r2 = -0.022226
Epoch 6
Validation r2 = -0.015529
Epoch 7
Validation r2 = -0.088830
Epoch 8
Validation r2 = 0.035052
Epoch 9
Validation r2 = 0.012051
Epoch 10
Validation r2 = 0.036540
Epoch 11
Validation r2 = -0.093313
Epoch 12
Validation r2 = -0.025823
Epoch 13
Validation r2 = 0.065196
Epoch 14
Validation r2 = -0.009152
Epoch 15
Validation r2 = 0.062407
Epoch 16
Validation r2 = 0.001572
Epoch 17
Validation r2 = -0.069051
Epoch 18
Validation r2 = 0.062869
Epoch 19
Validation r2 = 0.089056
Epoch 20
Validation r2 = 0.051396
Epoch 21
Validation r2 = 0.102522
Epoch 22
Validation r2 = 0.077950
Epoch 23
Validation r2 = 0.066718
Epoch 24
Validation r2 = 0.084249
Epoch 25
Validation r2 = 0.076374
Epoch 26
Validation r2 = 0.066159
Epoch 27
Validation r2 = 0.038257
Epoch 28
Validation r2 = 0.043253
Epoch 29
Validation r2 = 0.064723
Epoch 30
Validation r2 = 0.091209
Epoch 31
Validation r2 = 0.114285
Epoch 32
Validation r2 = 0.124605
Epoch 33
Validation r2 = 0.137021
Epoch 34
Validation r2 = 0.168084
Epoch 35
Validation r2 = 0.164620
Epoch 36
Validation r2 = 0.161517
Epoch 37
Validation r2 = 0.155223
Epoch 38
Validation r2 = 0.184583
Epoch 39
Validation r2 = 0.187486
Epoch 40
Validation r2 = 0.188632
Epoch 41
Validation r2 = 0.159391
Epoch 42
Validation r2 = 0.203417
Epoch 43
Validation r2 = 0.183915
Epoch 44
Validation r2 = 0.195463
Epoch 45
Validation r2 = 0.184649
Epoch 46
Validation r2 = 0.180229
Epoch 47
Validation r2 = 0.204356
Epoch 48
Validation r2 = 0.155780
Epoch 49
Validation r2 = 0.211446
Epoch 50
Validation r2 = 0.111358
Epoch 51
Validation r2 = 0.210661
Epoch 52
Validation r2 = 0.203024
Epoch 53
Validation r2 = 0.218269
Epoch 54
Validation r2 = 0.223815
Epoch 55
Validation r2 = 0.193107
Epoch 56
Validation r2 = 0.255476
Epoch 57
Validation r2 = 0.241581
Epoch 58
Validation r2 = 0.255451
Epoch 59
Validation r2 = 0.265029
Epoch 60
Validation r2 = 0.238361
Epoch 61
Validation r2 = 0.262636
Epoch 62
Validation r2 = 0.279922
Epoch 63
Validation r2 = 0.258617
Epoch 64
Validation r2 = 0.283502
Epoch 65
Validation r2 = 0.274587
Epoch 66
Validation r2 = 0.275395
Epoch 67
Validation r2 = 0.294473
Epoch 68
Validation r2 = 0.294493
Epoch 69
Validation r2 = 0.297688
Epoch 70
Validation r2 = 0.282415
Epoch 71
Validation r2 = 0.300308
Epoch 72
Validation r2 = 0.308277
Epoch 73
Validation r2 = 0.307023
Epoch 74
Validation r2 = 0.315160
Epoch 75
Validation r2 = 0.292388
Epoch 76
Validation r2 = 0.291761
Epoch 77
Validation r2 = 0.327368
Epoch 78
Validation r2 = 0.334891
Epoch 79
Validation r2 = 0.334508
Epoch 80
Validation r2 = 0.346950
Epoch 81
Validation r2 = 0.346809
Epoch 82
Validation r2 = 0.330662
Epoch 83
Validation r2 = 0.341004
Epoch 84
Validation r2 = 0.366329
Epoch 85
Validation r2 = 0.365298
Epoch 86
Validation r2 = 0.370035
Epoch 87
Validation r2 = 0.371073
Epoch 88
Validation r2 = 0.363248
Epoch 89
Validation r2 = 0.366641
Epoch 90
Validation r2 = 0.372988
Epoch 91
Validation r2 = 0.373820
Epoch 92
Validation r2 = 0.369146
Epoch 93
Validation r2 = 0.354921
Epoch 94
Validation r2 = 0.356287
Epoch 95
Validation r2 = 0.368696
Epoch 96
Validation r2 = 0.380189
Epoch 97
Validation r2 = 0.383356
Epoch 98
Validation r2 = 0.385647
Epoch 99
Validation r2 = 0.385908
Model 0 best validation r2 = 0.385908 on epoch 99
Moving model to cuda
Model 0 test mae = 0.626659
Model 0 test mse = 0.669865
Model 0 test r2 = 0.239945
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -3.262400
Epoch 1
Validation r2 = -1.168660
Epoch 2
Validation r2 = -0.000133
Epoch 3
Validation r2 = -0.151242
Epoch 4
Validation r2 = -0.017897
Epoch 5
Validation r2 = -0.053598
Epoch 6
Validation r2 = 0.015074
Epoch 7
Validation r2 = -0.024621
Epoch 8
Validation r2 = -0.020020
Epoch 9
Validation r2 = 0.036436
Epoch 10
Validation r2 = 0.042885
Epoch 11
Validation r2 = 0.023546
Epoch 12
Validation r2 = 0.006997
Epoch 13
Validation r2 = 0.068594
Epoch 14
Validation r2 = 0.083914
Epoch 15
Validation r2 = 0.029905
Epoch 16
Validation r2 = 0.092920
Epoch 17
Validation r2 = 0.030363
Epoch 18
Validation r2 = 0.083926
Epoch 19
Validation r2 = -0.211232
Epoch 20
Validation r2 = -0.017384
Epoch 21
Validation r2 = 0.119160
Epoch 22
Validation r2 = -0.074786
Epoch 23
Validation r2 = 0.035658
Epoch 24
Validation r2 = 0.125809
Epoch 25
Validation r2 = -0.030241
Epoch 26
Validation r2 = -0.106051
Epoch 27
Validation r2 = 0.002341
Epoch 28
Validation r2 = 0.117224
Epoch 29
Validation r2 = 0.119960
Epoch 30
Validation r2 = 0.044853
Epoch 31
Validation r2 = 0.022209
Epoch 32
Validation r2 = 0.073317
Epoch 33
Validation r2 = 0.125511
Epoch 34
Validation r2 = 0.102972
Epoch 35
Validation r2 = 0.019232
Epoch 36
Validation r2 = -0.024998
Epoch 37
Validation r2 = 0.020215
Epoch 38
Validation r2 = 0.075306
Epoch 39
Validation r2 = 0.107172
Epoch 40
Validation r2 = 0.100814
Epoch 41
Validation r2 = 0.088965
Epoch 42
Validation r2 = 0.097162
Epoch 43
Validation r2 = 0.120661
Epoch 44
Validation r2 = 0.135244
Epoch 45
Validation r2 = 0.128141
Epoch 46
Validation r2 = 0.120813
Epoch 47
Validation r2 = 0.135002
Epoch 48
Validation r2 = 0.157496
Epoch 49
Validation r2 = 0.169340
Epoch 50
Validation r2 = 0.170134
Epoch 51
Validation r2 = 0.168806
Epoch 52
Validation r2 = 0.172613
Epoch 53
Validation r2 = 0.171753
Epoch 54
Validation r2 = 0.154328
Epoch 55
Validation r2 = 0.131727
Epoch 56
Validation r2 = 0.143515
Epoch 57
Validation r2 = 0.161315
Epoch 58
Validation r2 = 0.159811
Epoch 59
Validation r2 = 0.153664
Epoch 60
Validation r2 = 0.158628
Epoch 61
Validation r2 = 0.159260
Epoch 62
Validation r2 = 0.153198
Epoch 63
Validation r2 = 0.150036
Epoch 64
Validation r2 = 0.156028
Epoch 65
Validation r2 = 0.165334
Epoch 66
Validation r2 = 0.174662
Epoch 67
Validation r2 = 0.177168
Epoch 68
Validation r2 = 0.175062
Epoch 69
Validation r2 = 0.171069
Epoch 70
Validation r2 = 0.175673
Epoch 71
Validation r2 = 0.189858
Epoch 72
Validation r2 = 0.195475
Epoch 73
Validation r2 = 0.197618
Epoch 74
Validation r2 = 0.200402
Epoch 75
Validation r2 = 0.200903
Epoch 76
Validation r2 = 0.199124
Epoch 77
Validation r2 = 0.200491
Epoch 78
Validation r2 = 0.203026
Epoch 79
Validation r2 = 0.207734
Epoch 80
Validation r2 = 0.211926
Epoch 81
Validation r2 = 0.213262
Epoch 82
Validation r2 = 0.215792
Epoch 83
Validation r2 = 0.215073
Epoch 84
Validation r2 = 0.215125
Epoch 85
Validation r2 = 0.215018
Epoch 86
Validation r2 = 0.220112
Epoch 87
Validation r2 = 0.227388
Epoch 88
Validation r2 = 0.227437
Epoch 89
Validation r2 = 0.228023
Epoch 90
Validation r2 = 0.234212
Epoch 91
Validation r2 = 0.231258
Epoch 92
Validation r2 = 0.220421
Epoch 93
Validation r2 = 0.216987
Epoch 94
Validation r2 = 0.227175
Epoch 95
Validation r2 = 0.237993
Epoch 96
Validation r2 = 0.246345
Epoch 97
Validation r2 = 0.248316
Epoch 98
Validation r2 = 0.250161
Epoch 99
Validation r2 = 0.253062
Model 1 best validation r2 = 0.253062 on epoch 99
Moving model to cuda
Model 1 test mae = 0.667341
Model 1 test mse = 0.762721
Model 1 test r2 = 0.134587
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -4.938572
Epoch 1
Validation r2 = -0.891271
Epoch 2
Validation r2 = 0.014199
Epoch 3
Validation r2 = -0.263852
Epoch 4
Validation r2 = -0.095807
Epoch 5
Validation r2 = -0.163379
Epoch 6
Validation r2 = 0.015191
Epoch 7
Validation r2 = -0.023094
Epoch 8
Validation r2 = 0.002639
Epoch 9
Validation r2 = -0.141249
Epoch 10
Validation r2 = -0.013855
Epoch 11
Validation r2 = 0.023404
Epoch 12
Validation r2 = -0.045359
Epoch 13
Validation r2 = 0.030701
Epoch 14
Validation r2 = 0.040564
Epoch 15
Validation r2 = -0.036663
Epoch 16
Validation r2 = 0.013773
Epoch 17
Validation r2 = 0.068942
Epoch 18
Validation r2 = 0.063992
Epoch 19
Validation r2 = 0.080419
Epoch 20
Validation r2 = 0.076171
Epoch 21
Validation r2 = 0.039896
Epoch 22
Validation r2 = 0.071048
Epoch 23
Validation r2 = 0.118230
Epoch 24
Validation r2 = 0.111966
Epoch 25
Validation r2 = 0.135678
Epoch 26
Validation r2 = 0.156732
Epoch 27
Validation r2 = 0.099557
Epoch 28
Validation r2 = 0.143826
Epoch 29
Validation r2 = 0.191168
Epoch 30
Validation r2 = 0.192222
Epoch 31
Validation r2 = 0.202600
Epoch 32
Validation r2 = 0.192693
Epoch 33
Validation r2 = 0.203076
Epoch 34
Validation r2 = 0.211525
Epoch 35
Validation r2 = 0.207072
Epoch 36
Validation r2 = 0.191521
Epoch 37
Validation r2 = 0.186801
Epoch 38
Validation r2 = 0.188114
Epoch 39
Validation r2 = 0.194551
Epoch 40
Validation r2 = 0.183811
Epoch 41
Validation r2 = 0.176235
Epoch 42
Validation r2 = 0.183400
Epoch 43
Validation r2 = 0.186502
Epoch 44
Validation r2 = 0.182608
Epoch 45
Validation r2 = 0.187719
Epoch 46
Validation r2 = 0.179273
Epoch 47
Validation r2 = 0.194059
Epoch 48
Validation r2 = 0.187988
Epoch 49
Validation r2 = 0.204345
Epoch 50
Validation r2 = 0.144947
Epoch 51
Validation r2 = 0.203647
Epoch 52
Validation r2 = 0.208303
Epoch 53
Validation r2 = 0.217872
Epoch 54
Validation r2 = 0.216709
Epoch 55
Validation r2 = 0.220058
Epoch 56
Validation r2 = 0.234278
Epoch 57
Validation r2 = 0.226145
Epoch 58
Validation r2 = 0.239530
Epoch 59
Validation r2 = 0.156056
Epoch 60
Validation r2 = 0.245374
Epoch 61
Validation r2 = 0.209637
Epoch 62
Validation r2 = 0.252280
Epoch 63
Validation r2 = 0.233794
Epoch 64
Validation r2 = 0.212322
Epoch 65
Validation r2 = 0.270800
Epoch 66
Validation r2 = 0.242692
Epoch 67
Validation r2 = 0.261724
Epoch 68
Validation r2 = 0.275689
Epoch 69
Validation r2 = 0.230022
Epoch 70
Validation r2 = 0.242324
Epoch 71
Validation r2 = 0.282613
Epoch 72
Validation r2 = 0.275910
Epoch 73
Validation r2 = 0.287380
Epoch 74
Validation r2 = 0.278655
Epoch 75
Validation r2 = 0.251943
Epoch 76
Validation r2 = 0.262182
Epoch 77
Validation r2 = 0.294746
Epoch 78
Validation r2 = 0.286658
Epoch 79
Validation r2 = 0.282221
Epoch 80
Validation r2 = 0.298615
Epoch 81
Validation r2 = 0.264684
Epoch 82
Validation r2 = 0.264466
Epoch 83
Validation r2 = 0.293714
Epoch 84
Validation r2 = 0.300737
Epoch 85
Validation r2 = 0.290174
Epoch 86
Validation r2 = 0.300510
Epoch 87
Validation r2 = 0.302862
Epoch 88
Validation r2 = 0.269679
Epoch 89
Validation r2 = 0.270525
Epoch 90
Validation r2 = 0.298375
Epoch 91
Validation r2 = 0.314236
Epoch 92
Validation r2 = 0.309021
Epoch 93
Validation r2 = 0.314594
Epoch 94
Validation r2 = 0.310386
Epoch 95
Validation r2 = 0.295406
Epoch 96
Validation r2 = 0.297941
Epoch 97
Validation r2 = 0.313218
Epoch 98
Validation r2 = 0.322838
Epoch 99
Validation r2 = 0.322962
Model 2 best validation r2 = 0.322962 on epoch 99
Moving model to cuda
Model 2 test mae = 0.670912
Model 2 test mse = 0.740682
Model 2 test r2 = 0.159593
Ensemble test mae = 0.650619
Ensemble test mse = 0.714734
Ensemble test r2 = 0.189035
1-fold cross validation
Seed 0 ==> test r2 = 0.189035
Overall test r2 = 0.189035 +/- 0.000000
