Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,246 | train size = 996 | val size = 250 | test size = 312
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = 0.015065
Epoch 1
Validation r2 = 0.056890
Epoch 2
Validation r2 = 0.031476
Epoch 3
Validation r2 = 0.132155
Epoch 4
Validation r2 = 0.175242
Epoch 5
Validation r2 = 0.144307
Epoch 6
Validation r2 = 0.238710
Epoch 7
Validation r2 = 0.212772
Epoch 8
Validation r2 = 0.319870
Epoch 9
Validation r2 = 0.247546
Epoch 10
Validation r2 = 0.399556
Epoch 11
Validation r2 = 0.319723
Epoch 12
Validation r2 = 0.367135
Epoch 13
Validation r2 = 0.328401
Epoch 14
Validation r2 = 0.423621
Epoch 15
Validation r2 = 0.466833
Epoch 16
Validation r2 = 0.497066
Epoch 17
Validation r2 = 0.509851
Epoch 18
Validation r2 = 0.528410
Epoch 19
Validation r2 = 0.520721
Epoch 20
Validation r2 = 0.537405
Epoch 21
Validation r2 = 0.514205
Epoch 22
Validation r2 = 0.528687
Epoch 23
Validation r2 = 0.487449
Epoch 24
Validation r2 = 0.442462
Epoch 25
Validation r2 = 0.488539
Epoch 26
Validation r2 = 0.483326
Epoch 27
Validation r2 = 0.545162
Epoch 28
Validation r2 = 0.501999
Epoch 29
Validation r2 = 0.450769
Epoch 30
Validation r2 = 0.565784
Epoch 31
Validation r2 = 0.547265
Epoch 32
Validation r2 = 0.573595
Epoch 33
Validation r2 = 0.558907
Epoch 34
Validation r2 = 0.569862
Epoch 35
Validation r2 = 0.546173
Epoch 36
Validation r2 = 0.540888
Epoch 37
Validation r2 = 0.547015
Epoch 38
Validation r2 = 0.572151
Epoch 39
Validation r2 = 0.602804
Epoch 40
Validation r2 = 0.577968
Epoch 41
Validation r2 = 0.583880
Epoch 42
Validation r2 = 0.586898
Epoch 43
Validation r2 = 0.605524
Epoch 44
Validation r2 = 0.596456
Epoch 45
Validation r2 = 0.593770
Epoch 46
Validation r2 = 0.604043
Epoch 47
Validation r2 = 0.600004
Epoch 48
Validation r2 = 0.598062
Epoch 49
Validation r2 = 0.612645
Epoch 50
Validation r2 = 0.616469
Epoch 51
Validation r2 = 0.608808
Epoch 52
Validation r2 = 0.597907
Epoch 53
Validation r2 = 0.606202
Epoch 54
Validation r2 = 0.611851
Epoch 55
Validation r2 = 0.607316
Epoch 56
Validation r2 = 0.616130
Epoch 57
Validation r2 = 0.605267
Epoch 58
Validation r2 = 0.602109
Epoch 59
Validation r2 = 0.603551
Epoch 60
Validation r2 = 0.604981
Epoch 61
Validation r2 = 0.596290
Epoch 62
Validation r2 = 0.596918
Epoch 63
Validation r2 = 0.599713
Epoch 64
Validation r2 = 0.598549
Epoch 65
Validation r2 = 0.599271
Epoch 66
Validation r2 = 0.594037
Epoch 67
Validation r2 = 0.587600
Epoch 68
Validation r2 = 0.570873
Epoch 69
Validation r2 = 0.588955
Epoch 70
Validation r2 = 0.596575
Epoch 71
Validation r2 = 0.595155
Epoch 72
Validation r2 = 0.596908
Epoch 73
Validation r2 = 0.586347
Epoch 74
Validation r2 = 0.596935
Epoch 75
Validation r2 = 0.582397
Epoch 76
Validation r2 = 0.585331
Epoch 77
Validation r2 = 0.582857
Epoch 78
Validation r2 = 0.584013
Epoch 79
Validation r2 = 0.583517
Epoch 80
Validation r2 = 0.579142
Epoch 81
Validation r2 = 0.575577
Epoch 82
Validation r2 = 0.582633
Epoch 83
Validation r2 = 0.559830
Epoch 84
Validation r2 = 0.574329
Epoch 85
Validation r2 = 0.572977
Epoch 86
Validation r2 = 0.575768
Epoch 87
Validation r2 = 0.594799
Epoch 88
Validation r2 = 0.576503
Epoch 89
Validation r2 = 0.581227
Epoch 90
Validation r2 = 0.580864
Epoch 91
Validation r2 = 0.588687
Epoch 92
Validation r2 = 0.575385
Epoch 93
Validation r2 = 0.578278
Epoch 94
Validation r2 = 0.578262
Epoch 95
Validation r2 = 0.561495
Epoch 96
Validation r2 = 0.570227
Epoch 97
Validation r2 = 0.563772
Epoch 98
Validation r2 = 0.569122
Epoch 99
Validation r2 = 0.581512
Model 0 best validation r2 = 0.616469 on epoch 50
Moving model to cuda
Model 0 test mae = 0.437637
Model 0 test mse = 0.349971
Model 0 test r2 = 0.667257
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.062572
Epoch 1
Validation r2 = 0.010692
Epoch 2
Validation r2 = -0.009223
Epoch 3
Validation r2 = 0.098136
Epoch 4
Validation r2 = 0.120532
Epoch 5
Validation r2 = 0.136161
Epoch 6
Validation r2 = 0.105318
Epoch 7
Validation r2 = 0.186108
Epoch 8
Validation r2 = 0.196358
Epoch 9
Validation r2 = 0.264450
Epoch 10
Validation r2 = 0.320428
Epoch 11
Validation r2 = 0.232886
Epoch 12
Validation r2 = 0.147584
Epoch 13
Validation r2 = 0.284323
Epoch 14
Validation r2 = 0.351585
Epoch 15
Validation r2 = 0.397610
Epoch 16
Validation r2 = 0.442790
Epoch 17
Validation r2 = 0.430367
Epoch 18
Validation r2 = 0.474752
Epoch 19
Validation r2 = 0.469992
Epoch 20
Validation r2 = 0.417870
Epoch 21
Validation r2 = 0.498050
Epoch 22
Validation r2 = 0.503821
Epoch 23
Validation r2 = 0.519015
Epoch 24
Validation r2 = 0.510343
Epoch 25
Validation r2 = 0.538768
Epoch 26
Validation r2 = 0.544093
Epoch 27
Validation r2 = 0.489343
Epoch 28
Validation r2 = 0.515039
Epoch 29
Validation r2 = 0.530610
Epoch 30
Validation r2 = 0.525150
Epoch 31
Validation r2 = 0.541591
Epoch 32
Validation r2 = 0.566050
Epoch 33
Validation r2 = 0.541466
Epoch 34
Validation r2 = 0.495631
Epoch 35
Validation r2 = 0.572863
Epoch 36
Validation r2 = 0.578516
Epoch 37
Validation r2 = 0.537132
Epoch 38
Validation r2 = 0.589597
Epoch 39
Validation r2 = 0.558780
Epoch 40
Validation r2 = 0.549277
Epoch 41
Validation r2 = 0.591141
Epoch 42
Validation r2 = 0.541986
Epoch 43
Validation r2 = 0.569785
Epoch 44
Validation r2 = 0.600649
Epoch 45
Validation r2 = 0.609577
Epoch 46
Validation r2 = 0.611426
Epoch 47
Validation r2 = 0.611950
Epoch 48
Validation r2 = 0.610612
Epoch 49
Validation r2 = 0.595583
Epoch 50
Validation r2 = 0.616818
Epoch 51
Validation r2 = 0.622620
Epoch 52
Validation r2 = 0.621016
Epoch 53
Validation r2 = 0.609137
Epoch 54
Validation r2 = 0.616254
Epoch 55
Validation r2 = 0.631637
Epoch 56
Validation r2 = 0.614613
Epoch 57
Validation r2 = 0.614648
Epoch 58
Validation r2 = 0.600419
Epoch 59
Validation r2 = 0.612123
Epoch 60
Validation r2 = 0.604351
Epoch 61
Validation r2 = 0.605696
Epoch 62
Validation r2 = 0.615000
Epoch 63
Validation r2 = 0.600457
Epoch 64
Validation r2 = 0.609629
Epoch 65
Validation r2 = 0.602358
Epoch 66
Validation r2 = 0.592232
Epoch 67
Validation r2 = 0.556327
Epoch 68
Validation r2 = 0.602321
Epoch 69
Validation r2 = 0.607308
Epoch 70
Validation r2 = 0.622049
Epoch 71
Validation r2 = 0.619703
Epoch 72
Validation r2 = 0.624986
Epoch 73
Validation r2 = 0.622111
Epoch 74
Validation r2 = 0.607939
Epoch 75
Validation r2 = 0.590137
Epoch 76
Validation r2 = 0.612770
Epoch 77
Validation r2 = 0.586436
Epoch 78
Validation r2 = 0.605421
Epoch 79
Validation r2 = 0.613166
Epoch 80
Validation r2 = 0.593594
Epoch 81
Validation r2 = 0.613451
Epoch 82
Validation r2 = 0.610722
Epoch 83
Validation r2 = 0.596884
Epoch 84
Validation r2 = 0.617322
Epoch 85
Validation r2 = 0.598768
Epoch 86
Validation r2 = 0.601848
Epoch 87
Validation r2 = 0.597385
Epoch 88
Validation r2 = 0.606853
Epoch 89
Validation r2 = 0.602148
Epoch 90
Validation r2 = 0.600857
Epoch 91
Validation r2 = 0.595988
Epoch 92
Validation r2 = 0.603494
Epoch 93
Validation r2 = 0.599020
Epoch 94
Validation r2 = 0.598115
Epoch 95
Validation r2 = 0.596815
Epoch 96
Validation r2 = 0.592463
Epoch 97
Validation r2 = 0.597188
Epoch 98
Validation r2 = 0.600739
Epoch 99
Validation r2 = 0.593890
Model 1 best validation r2 = 0.631637 on epoch 55
Moving model to cuda
Model 1 test mae = 0.431800
Model 1 test mse = 0.356543
Model 1 test r2 = 0.661009
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = 0.020806
Epoch 1
Validation r2 = 0.064909
Epoch 2
Validation r2 = 0.086301
Epoch 3
Validation r2 = 0.063152
Epoch 4
Validation r2 = 0.065864
Epoch 5
Validation r2 = 0.088567
Epoch 6
Validation r2 = 0.179834
Epoch 7
Validation r2 = 0.163274
Epoch 8
Validation r2 = 0.243861
Epoch 9
Validation r2 = 0.284480
Epoch 10
Validation r2 = 0.347298
Epoch 11
Validation r2 = 0.327320
Epoch 12
Validation r2 = 0.422832
Epoch 13
Validation r2 = 0.462675
Epoch 14
Validation r2 = 0.499882
Epoch 15
Validation r2 = 0.505210
Epoch 16
Validation r2 = 0.436171
Epoch 17
Validation r2 = 0.485101
Epoch 18
Validation r2 = 0.338524
Epoch 19
Validation r2 = 0.498486
Epoch 20
Validation r2 = 0.542338
Epoch 21
Validation r2 = 0.567829
Epoch 22
Validation r2 = 0.561098
Epoch 23
Validation r2 = 0.570652
Epoch 24
Validation r2 = 0.587757
Epoch 25
Validation r2 = 0.581809
Epoch 26
Validation r2 = 0.534810
Epoch 27
Validation r2 = 0.496228
Epoch 28
Validation r2 = 0.591433
Epoch 29
Validation r2 = 0.550116
Epoch 30
Validation r2 = 0.557558
Epoch 31
Validation r2 = 0.575315
Epoch 32
Validation r2 = 0.587194
Epoch 33
Validation r2 = 0.601835
Epoch 34
Validation r2 = 0.561721
Epoch 35
Validation r2 = 0.585669
Epoch 36
Validation r2 = 0.564727
Epoch 37
Validation r2 = 0.592045
Epoch 38
Validation r2 = 0.627410
Epoch 39
Validation r2 = 0.605097
Epoch 40
Validation r2 = 0.560104
Epoch 41
Validation r2 = 0.558000
Epoch 42
Validation r2 = 0.581810
Epoch 43
Validation r2 = 0.587621
Epoch 44
Validation r2 = 0.624532
Epoch 45
Validation r2 = 0.621036
Epoch 46
Validation r2 = 0.623125
Epoch 47
Validation r2 = 0.615298
Epoch 48
Validation r2 = 0.604700
Epoch 49
Validation r2 = 0.615144
Epoch 50
Validation r2 = 0.617517
Epoch 51
Validation r2 = 0.609895
Epoch 52
Validation r2 = 0.615747
Epoch 53
Validation r2 = 0.613922
Epoch 54
Validation r2 = 0.621013
Epoch 55
Validation r2 = 0.628234
Epoch 56
Validation r2 = 0.621723
Epoch 57
Validation r2 = 0.612539
Epoch 58
Validation r2 = 0.630145
Epoch 59
Validation r2 = 0.628638
Epoch 60
Validation r2 = 0.610752
Epoch 61
Validation r2 = 0.625356
Epoch 62
Validation r2 = 0.629773
Epoch 63
Validation r2 = 0.617643
Epoch 64
Validation r2 = 0.616272
Epoch 65
Validation r2 = 0.624847
Epoch 66
Validation r2 = 0.620895
Epoch 67
Validation r2 = 0.620780
Epoch 68
Validation r2 = 0.626501
Epoch 69
Validation r2 = 0.623699
Epoch 70
Validation r2 = 0.616794
Epoch 71
Validation r2 = 0.607464
Epoch 72
Validation r2 = 0.620769
Epoch 73
Validation r2 = 0.623993
Epoch 74
Validation r2 = 0.621342
Epoch 75
Validation r2 = 0.627485
Epoch 76
Validation r2 = 0.626590
Epoch 77
Validation r2 = 0.619981
Epoch 78
Validation r2 = 0.622347
Epoch 79
Validation r2 = 0.622635
Epoch 80
Validation r2 = 0.611129
Epoch 81
Validation r2 = 0.598713
Epoch 82
Validation r2 = 0.579062
Epoch 83
Validation r2 = 0.603127
Epoch 84
Validation r2 = 0.592081
Epoch 85
Validation r2 = 0.594072
Epoch 86
Validation r2 = 0.600169
Epoch 87
Validation r2 = 0.601775
Epoch 88
Validation r2 = 0.614136
Epoch 89
Validation r2 = 0.619018
Epoch 90
Validation r2 = 0.603551
Epoch 91
Validation r2 = 0.604288
Epoch 92
Validation r2 = 0.609242
Epoch 93
Validation r2 = 0.614271
Epoch 94
Validation r2 = 0.606020
Epoch 95
Validation r2 = 0.616800
Epoch 96
Validation r2 = 0.605213
Epoch 97
Validation r2 = 0.605961
Epoch 98
Validation r2 = 0.598572
Epoch 99
Validation r2 = 0.606531
Model 2 best validation r2 = 0.630145 on epoch 58
Moving model to cuda
Model 2 test mae = 0.426338
Model 2 test mse = 0.341410
Model 2 test r2 = 0.675397
Ensemble test mae = 0.424612
Ensemble test mse = 0.338918
Ensemble test r2 = 0.677767
1-fold cross validation
Seed 0 ==> test r2 = 0.677767
Overall test r2 = 0.677767 +/- 0.000000
