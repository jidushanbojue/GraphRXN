Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 254 | train size = 203 | val size = 51 | test size = 63
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.588801
Epoch 1
Validation r2 = -0.010095
Epoch 2
Validation r2 = 0.002629
Epoch 3
Validation r2 = -0.060541
Epoch 4
Validation r2 = -0.235365
Epoch 5
Validation r2 = -0.061702
Epoch 6
Validation r2 = 0.014809
Epoch 7
Validation r2 = -0.032846
Epoch 8
Validation r2 = -0.096197
Epoch 9
Validation r2 = -0.025641
Epoch 10
Validation r2 = 0.057756
Epoch 11
Validation r2 = 0.038822
Epoch 12
Validation r2 = 0.023720
Epoch 13
Validation r2 = 0.064569
Epoch 14
Validation r2 = 0.075234
Epoch 15
Validation r2 = 0.159996
Epoch 16
Validation r2 = 0.144626
Epoch 17
Validation r2 = 0.139388
Epoch 18
Validation r2 = 0.258660
Epoch 19
Validation r2 = 0.301372
Epoch 20
Validation r2 = 0.084645
Epoch 21
Validation r2 = 0.311168
Epoch 22
Validation r2 = 0.352846
Epoch 23
Validation r2 = 0.213583
Epoch 24
Validation r2 = 0.232647
Epoch 25
Validation r2 = 0.359047
Epoch 26
Validation r2 = 0.385981
Epoch 27
Validation r2 = 0.376258
Epoch 28
Validation r2 = 0.237297
Epoch 29
Validation r2 = 0.245769
Epoch 30
Validation r2 = 0.404682
Epoch 31
Validation r2 = 0.434291
Epoch 32
Validation r2 = 0.437692
Epoch 33
Validation r2 = 0.347960
Epoch 34
Validation r2 = 0.314324
Epoch 35
Validation r2 = 0.420700
Epoch 36
Validation r2 = 0.487249
Epoch 37
Validation r2 = 0.493689
Epoch 38
Validation r2 = 0.478343
Epoch 39
Validation r2 = 0.438340
Epoch 40
Validation r2 = 0.413823
Epoch 41
Validation r2 = 0.429489
Epoch 42
Validation r2 = 0.474687
Epoch 43
Validation r2 = 0.503632
Epoch 44
Validation r2 = 0.510229
Epoch 45
Validation r2 = 0.501188
Epoch 46
Validation r2 = 0.471228
Epoch 47
Validation r2 = 0.417304
Epoch 48
Validation r2 = 0.433795
Epoch 49
Validation r2 = 0.492931
Epoch 50
Validation r2 = 0.526509
Epoch 51
Validation r2 = 0.537777
Epoch 52
Validation r2 = 0.538333
Epoch 53
Validation r2 = 0.506711
Epoch 54
Validation r2 = 0.452298
Epoch 55
Validation r2 = 0.425904
Epoch 56
Validation r2 = 0.452802
Epoch 57
Validation r2 = 0.503506
Epoch 58
Validation r2 = 0.539934
Epoch 59
Validation r2 = 0.556505
Epoch 60
Validation r2 = 0.561458
Epoch 61
Validation r2 = 0.560284
Epoch 62
Validation r2 = 0.545718
Epoch 63
Validation r2 = 0.520454
Epoch 64
Validation r2 = 0.508830
Epoch 65
Validation r2 = 0.515390
Epoch 66
Validation r2 = 0.540167
Epoch 67
Validation r2 = 0.568229
Epoch 68
Validation r2 = 0.583041
Epoch 69
Validation r2 = 0.582040
Epoch 70
Validation r2 = 0.571593
Epoch 71
Validation r2 = 0.570804
Epoch 72
Validation r2 = 0.579287
Epoch 73
Validation r2 = 0.579193
Epoch 74
Validation r2 = 0.573602
Epoch 75
Validation r2 = 0.585547
Epoch 76
Validation r2 = 0.605740
Epoch 77
Validation r2 = 0.619341
Epoch 78
Validation r2 = 0.629977
Epoch 79
Validation r2 = 0.640593
Epoch 80
Validation r2 = 0.645894
Epoch 81
Validation r2 = 0.650765
Epoch 82
Validation r2 = 0.646700
Epoch 83
Validation r2 = 0.636885
Epoch 84
Validation r2 = 0.625057
Epoch 85
Validation r2 = 0.607885
Epoch 86
Validation r2 = 0.590629
Epoch 87
Validation r2 = 0.588907
Epoch 88
Validation r2 = 0.596425
Epoch 89
Validation r2 = 0.609601
Epoch 90
Validation r2 = 0.623436
Epoch 91
Validation r2 = 0.630559
Epoch 92
Validation r2 = 0.635737
Epoch 93
Validation r2 = 0.638328
Epoch 94
Validation r2 = 0.637628
Epoch 95
Validation r2 = 0.634287
Epoch 96
Validation r2 = 0.628400
Epoch 97
Validation r2 = 0.626271
Epoch 98
Validation r2 = 0.623352
Epoch 99
Validation r2 = 0.624379
Model 0 best validation r2 = 0.650765 on epoch 81
Moving model to cuda
Model 0 test mae = 0.411069
Model 0 test mse = 0.291525
Model 0 test r2 = 0.683080
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.823228
Epoch 1
Validation r2 = -0.057134
Epoch 2
Validation r2 = -0.008714
Epoch 3
Validation r2 = -0.105893
Epoch 4
Validation r2 = -0.123092
Epoch 5
Validation r2 = -0.006504
Epoch 6
Validation r2 = -0.009048
Epoch 7
Validation r2 = -0.028769
Epoch 8
Validation r2 = -0.081052
Epoch 9
Validation r2 = -0.044134
Epoch 10
Validation r2 = 0.038343
Epoch 11
Validation r2 = 0.024466
Epoch 12
Validation r2 = 0.080191
Epoch 13
Validation r2 = 0.116081
Epoch 14
Validation r2 = 0.069071
Epoch 15
Validation r2 = 0.149006
Epoch 16
Validation r2 = 0.238899
Epoch 17
Validation r2 = -0.188179
Epoch 18
Validation r2 = 0.203435
Epoch 19
Validation r2 = 0.272884
Epoch 20
Validation r2 = 0.245402
Epoch 21
Validation r2 = 0.149999
Epoch 22
Validation r2 = 0.150403
Epoch 23
Validation r2 = 0.226845
Epoch 24
Validation r2 = 0.278600
Epoch 25
Validation r2 = 0.290020
Epoch 26
Validation r2 = 0.283330
Epoch 27
Validation r2 = 0.246846
Epoch 28
Validation r2 = 0.243046
Epoch 29
Validation r2 = 0.260426
Epoch 30
Validation r2 = 0.307070
Epoch 31
Validation r2 = 0.324586
Epoch 32
Validation r2 = 0.315326
Epoch 33
Validation r2 = 0.263066
Epoch 34
Validation r2 = 0.278153
Epoch 35
Validation r2 = 0.399224
Epoch 36
Validation r2 = 0.414881
Epoch 37
Validation r2 = 0.384691
Epoch 38
Validation r2 = 0.316748
Epoch 39
Validation r2 = 0.326822
Epoch 40
Validation r2 = 0.417428
Epoch 41
Validation r2 = 0.449346
Epoch 42
Validation r2 = 0.432589
Epoch 43
Validation r2 = 0.390658
Epoch 44
Validation r2 = 0.377869
Epoch 45
Validation r2 = 0.429316
Epoch 46
Validation r2 = 0.461139
Epoch 47
Validation r2 = 0.461667
Epoch 48
Validation r2 = 0.433029
Epoch 49
Validation r2 = 0.401639
Epoch 50
Validation r2 = 0.417041
Epoch 51
Validation r2 = 0.449867
Epoch 52
Validation r2 = 0.477428
Epoch 53
Validation r2 = 0.474878
Epoch 54
Validation r2 = 0.450403
Epoch 55
Validation r2 = 0.436884
Epoch 56
Validation r2 = 0.442918
Epoch 57
Validation r2 = 0.482914
Epoch 58
Validation r2 = 0.503373
Epoch 59
Validation r2 = 0.508317
Epoch 60
Validation r2 = 0.476377
Epoch 61
Validation r2 = 0.448579
Epoch 62
Validation r2 = 0.468260
Epoch 63
Validation r2 = 0.495957
Epoch 64
Validation r2 = 0.505658
Epoch 65
Validation r2 = 0.517636
Epoch 66
Validation r2 = 0.519985
Epoch 67
Validation r2 = 0.502719
Epoch 68
Validation r2 = 0.481755
Epoch 69
Validation r2 = 0.463047
Epoch 70
Validation r2 = 0.489086
Epoch 71
Validation r2 = 0.526965
Epoch 72
Validation r2 = 0.555778
Epoch 73
Validation r2 = 0.557246
Epoch 74
Validation r2 = 0.538673
Epoch 75
Validation r2 = 0.503575
Epoch 76
Validation r2 = 0.482637
Epoch 77
Validation r2 = 0.503988
Epoch 78
Validation r2 = 0.533372
Epoch 79
Validation r2 = 0.554816
Epoch 80
Validation r2 = 0.559066
Epoch 81
Validation r2 = 0.564614
Epoch 82
Validation r2 = 0.564234
Epoch 83
Validation r2 = 0.562101
Epoch 84
Validation r2 = 0.560538
Epoch 85
Validation r2 = 0.559791
Epoch 86
Validation r2 = 0.568575
Epoch 87
Validation r2 = 0.569407
Epoch 88
Validation r2 = 0.565734
Epoch 89
Validation r2 = 0.551942
Epoch 90
Validation r2 = 0.543199
Epoch 91
Validation r2 = 0.554247
Epoch 92
Validation r2 = 0.567214
Epoch 93
Validation r2 = 0.579516
Epoch 94
Validation r2 = 0.585254
Epoch 95
Validation r2 = 0.582424
Epoch 96
Validation r2 = 0.571723
Epoch 97
Validation r2 = 0.558817
Epoch 98
Validation r2 = 0.555866
Epoch 99
Validation r2 = 0.570045
Model 1 best validation r2 = 0.585254 on epoch 94
Moving model to cuda
Model 1 test mae = 0.445976
Model 1 test mse = 0.333571
Model 1 test r2 = 0.637371
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.580396
Epoch 1
Validation r2 = 0.006851
Epoch 2
Validation r2 = -0.107766
Epoch 3
Validation r2 = -0.015521
Epoch 4
Validation r2 = -0.074204
Epoch 5
Validation r2 = 0.029508
Epoch 6
Validation r2 = -0.043762
Epoch 7
Validation r2 = -0.171344
Epoch 8
Validation r2 = -0.024118
Epoch 9
Validation r2 = 0.083793
Epoch 10
Validation r2 = 0.099367
Epoch 11
Validation r2 = -0.037036
Epoch 12
Validation r2 = 0.013230
Epoch 13
Validation r2 = 0.168501
Epoch 14
Validation r2 = 0.230182
Epoch 15
Validation r2 = 0.130554
Epoch 16
Validation r2 = 0.102306
Epoch 17
Validation r2 = 0.272658
Epoch 18
Validation r2 = 0.250783
Epoch 19
Validation r2 = 0.118975
Epoch 20
Validation r2 = 0.238398
Epoch 21
Validation r2 = 0.314593
Epoch 22
Validation r2 = 0.230091
Epoch 23
Validation r2 = 0.130345
Epoch 24
Validation r2 = 0.223661
Epoch 25
Validation r2 = 0.319046
Epoch 26
Validation r2 = 0.352227
Epoch 27
Validation r2 = 0.319905
Epoch 28
Validation r2 = 0.232796
Epoch 29
Validation r2 = 0.279967
Epoch 30
Validation r2 = 0.370503
Epoch 31
Validation r2 = 0.395755
Epoch 32
Validation r2 = 0.384089
Epoch 33
Validation r2 = 0.298857
Epoch 34
Validation r2 = 0.313374
Epoch 35
Validation r2 = 0.440934
Epoch 36
Validation r2 = 0.457004
Epoch 37
Validation r2 = 0.428273
Epoch 38
Validation r2 = 0.336178
Epoch 39
Validation r2 = 0.357594
Epoch 40
Validation r2 = 0.418676
Epoch 41
Validation r2 = 0.458378
Epoch 42
Validation r2 = 0.466746
Epoch 43
Validation r2 = 0.454642
Epoch 44
Validation r2 = 0.428083
Epoch 45
Validation r2 = 0.417790
Epoch 46
Validation r2 = 0.437948
Epoch 47
Validation r2 = 0.457482
Epoch 48
Validation r2 = 0.482825
Epoch 49
Validation r2 = 0.507189
Epoch 50
Validation r2 = 0.523346
Epoch 51
Validation r2 = 0.525040
Epoch 52
Validation r2 = 0.492247
Epoch 53
Validation r2 = 0.428505
Epoch 54
Validation r2 = 0.402347
Epoch 55
Validation r2 = 0.467176
Epoch 56
Validation r2 = 0.511703
Epoch 57
Validation r2 = 0.516588
Epoch 58
Validation r2 = 0.512263
Epoch 59
Validation r2 = 0.494187
Epoch 60
Validation r2 = 0.458353
Epoch 61
Validation r2 = 0.442201
Epoch 62
Validation r2 = 0.464970
Epoch 63
Validation r2 = 0.499817
Epoch 64
Validation r2 = 0.535485
Epoch 65
Validation r2 = 0.555808
Epoch 66
Validation r2 = 0.561933
Epoch 67
Validation r2 = 0.559570
Epoch 68
Validation r2 = 0.538704
Epoch 69
Validation r2 = 0.517700
Epoch 70
Validation r2 = 0.522795
Epoch 71
Validation r2 = 0.544453
Epoch 72
Validation r2 = 0.559354
Epoch 73
Validation r2 = 0.562503
Epoch 74
Validation r2 = 0.564757
Epoch 75
Validation r2 = 0.570110
Epoch 76
Validation r2 = 0.571843
Epoch 77
Validation r2 = 0.569748
Epoch 78
Validation r2 = 0.574290
Epoch 79
Validation r2 = 0.590460
Epoch 80
Validation r2 = 0.606052
Epoch 81
Validation r2 = 0.613703
Epoch 82
Validation r2 = 0.614664
Epoch 83
Validation r2 = 0.615024
Epoch 84
Validation r2 = 0.611848
Epoch 85
Validation r2 = 0.608556
Epoch 86
Validation r2 = 0.603082
Epoch 87
Validation r2 = 0.601643
Epoch 88
Validation r2 = 0.597892
Epoch 89
Validation r2 = 0.596173
Epoch 90
Validation r2 = 0.598073
Epoch 91
Validation r2 = 0.604425
Epoch 92
Validation r2 = 0.611318
Epoch 93
Validation r2 = 0.619667
Epoch 94
Validation r2 = 0.627422
Epoch 95
Validation r2 = 0.629947
Epoch 96
Validation r2 = 0.637899
Epoch 97
Validation r2 = 0.644011
Epoch 98
Validation r2 = 0.648694
Epoch 99
Validation r2 = 0.653006
Model 2 best validation r2 = 0.653006 on epoch 99
Moving model to cuda
Model 2 test mae = 0.389619
Model 2 test mse = 0.269863
Model 2 test r2 = 0.706629
Ensemble test mae = 0.413454
Ensemble test mse = 0.292882
Ensemble test r2 = 0.681605
1-fold cross validation
Seed 0 ==> test r2 = 0.681605
Overall test r2 = 0.681605 +/- 0.000000
