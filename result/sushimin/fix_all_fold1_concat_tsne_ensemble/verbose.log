Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,246 | train size = 996 | val size = 250 | test size = 312
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.000532
Epoch 1
Validation r2 = -0.042519
Epoch 2
Validation r2 = 0.048730
Epoch 3
Validation r2 = 0.109034
Epoch 4
Validation r2 = 0.141226
Epoch 5
Validation r2 = 0.159885
Epoch 6
Validation r2 = 0.204533
Epoch 7
Validation r2 = 0.262003
Epoch 8
Validation r2 = 0.373885
Epoch 9
Validation r2 = 0.318545
Epoch 10
Validation r2 = 0.378080
Epoch 11
Validation r2 = 0.457395
Epoch 12
Validation r2 = 0.472093
Epoch 13
Validation r2 = 0.493521
Epoch 14
Validation r2 = 0.493727
Epoch 15
Validation r2 = 0.520222
Epoch 16
Validation r2 = 0.508037
Epoch 17
Validation r2 = 0.524507
Epoch 18
Validation r2 = 0.509236
Epoch 19
Validation r2 = 0.501663
Epoch 20
Validation r2 = 0.527600
Epoch 21
Validation r2 = 0.507215
Epoch 22
Validation r2 = 0.420598
Epoch 23
Validation r2 = 0.540514
Epoch 24
Validation r2 = 0.511037
Epoch 25
Validation r2 = 0.563367
Epoch 26
Validation r2 = 0.557708
Epoch 27
Validation r2 = 0.544110
Epoch 28
Validation r2 = 0.550223
Epoch 29
Validation r2 = 0.589537
Epoch 30
Validation r2 = 0.582475
Epoch 31
Validation r2 = 0.574402
Epoch 32
Validation r2 = 0.579386
Epoch 33
Validation r2 = 0.603762
Epoch 34
Validation r2 = 0.579676
Epoch 35
Validation r2 = 0.574161
Epoch 36
Validation r2 = 0.575670
Epoch 37
Validation r2 = 0.602489
Epoch 38
Validation r2 = 0.596677
Epoch 39
Validation r2 = 0.576696
Epoch 40
Validation r2 = 0.585060
Epoch 41
Validation r2 = 0.586444
Epoch 42
Validation r2 = 0.583229
Epoch 43
Validation r2 = 0.607010
Epoch 44
Validation r2 = 0.580762
Epoch 45
Validation r2 = 0.569508
Epoch 46
Validation r2 = 0.594540
Epoch 47
Validation r2 = 0.581110
Epoch 48
Validation r2 = 0.601220
Epoch 49
Validation r2 = 0.583450
Epoch 50
Validation r2 = 0.602691
Epoch 51
Validation r2 = 0.592783
Epoch 52
Validation r2 = 0.597015
Epoch 53
Validation r2 = 0.595564
Epoch 54
Validation r2 = 0.599051
Epoch 55
Validation r2 = 0.590268
Epoch 56
Validation r2 = 0.584670
Epoch 57
Validation r2 = 0.591099
Epoch 58
Validation r2 = 0.575170
Epoch 59
Validation r2 = 0.589823
Epoch 60
Validation r2 = 0.596078
Epoch 61
Validation r2 = 0.589356
Epoch 62
Validation r2 = 0.592610
Epoch 63
Validation r2 = 0.588119
Epoch 64
Validation r2 = 0.587852
Epoch 65
Validation r2 = 0.583911
Epoch 66
Validation r2 = 0.590945
Epoch 67
Validation r2 = 0.582024
Epoch 68
Validation r2 = 0.586947
Epoch 69
Validation r2 = 0.591078
Epoch 70
Validation r2 = 0.582259
Epoch 71
Validation r2 = 0.570028
Epoch 72
Validation r2 = 0.572898
Epoch 73
Validation r2 = 0.582181
Epoch 74
Validation r2 = 0.587978
Epoch 75
Validation r2 = 0.573930
Epoch 76
Validation r2 = 0.587771
Epoch 77
Validation r2 = 0.577212
Epoch 78
Validation r2 = 0.579023
Epoch 79
Validation r2 = 0.581119
Epoch 80
Validation r2 = 0.578727
Epoch 81
Validation r2 = 0.579490
Epoch 82
Validation r2 = 0.579394
Epoch 83
Validation r2 = 0.572229
Epoch 84
Validation r2 = 0.576245
Epoch 85
Validation r2 = 0.573751
Epoch 86
Validation r2 = 0.579862
Epoch 87
Validation r2 = 0.578154
Epoch 88
Validation r2 = 0.579614
Epoch 89
Validation r2 = 0.572335
Epoch 90
Validation r2 = 0.575535
Epoch 91
Validation r2 = 0.575046
Epoch 92
Validation r2 = 0.574570
Epoch 93
Validation r2 = 0.574151
Epoch 94
Validation r2 = 0.570616
Epoch 95
Validation r2 = 0.572350
Epoch 96
Validation r2 = 0.574295
Epoch 97
Validation r2 = 0.571166
Epoch 98
Validation r2 = 0.570456
Epoch 99
Validation r2 = 0.570312
Model 0 best validation r2 = 0.607010 on epoch 43
Moving model to cuda
Model 0 test mae = 0.424901
Model 0 test mse = 0.347375
Model 0 test r2 = 0.669726
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.073342
Epoch 1
Validation r2 = 0.089661
Epoch 2
Validation r2 = 0.113060
Epoch 3
Validation r2 = 0.131760
Epoch 4
Validation r2 = 0.215115
Epoch 5
Validation r2 = 0.311452
Epoch 6
Validation r2 = 0.297573
Epoch 7
Validation r2 = 0.475997
Epoch 8
Validation r2 = 0.479615
Epoch 9
Validation r2 = 0.486152
Epoch 10
Validation r2 = 0.491100
Epoch 11
Validation r2 = 0.513732
Epoch 12
Validation r2 = 0.502388
Epoch 13
Validation r2 = 0.526985
Epoch 14
Validation r2 = 0.538036
Epoch 15
Validation r2 = 0.525580
Epoch 16
Validation r2 = 0.527824
Epoch 17
Validation r2 = 0.540933
Epoch 18
Validation r2 = 0.512445
Epoch 19
Validation r2 = 0.524924
Epoch 20
Validation r2 = 0.541313
Epoch 21
Validation r2 = 0.564899
Epoch 22
Validation r2 = 0.544781
Epoch 23
Validation r2 = 0.542970
Epoch 24
Validation r2 = 0.581935
Epoch 25
Validation r2 = 0.572964
Epoch 26
Validation r2 = 0.596604
Epoch 27
Validation r2 = 0.563961
Epoch 28
Validation r2 = 0.581294
Epoch 29
Validation r2 = 0.601399
Epoch 30
Validation r2 = 0.550084
Epoch 31
Validation r2 = 0.578405
Epoch 32
Validation r2 = 0.574933
Epoch 33
Validation r2 = 0.600948
Epoch 34
Validation r2 = 0.577123
Epoch 35
Validation r2 = 0.581836
Epoch 36
Validation r2 = 0.581702
Epoch 37
Validation r2 = 0.562739
Epoch 38
Validation r2 = 0.596357
Epoch 39
Validation r2 = 0.580741
Epoch 40
Validation r2 = 0.560975
Epoch 41
Validation r2 = 0.557692
Epoch 42
Validation r2 = 0.593672
Epoch 43
Validation r2 = 0.568658
Epoch 44
Validation r2 = 0.568940
Epoch 45
Validation r2 = 0.602834
Epoch 46
Validation r2 = 0.558802
Epoch 47
Validation r2 = 0.551833
Epoch 48
Validation r2 = 0.569496
Epoch 49
Validation r2 = 0.572482
Epoch 50
Validation r2 = 0.574184
Epoch 51
Validation r2 = 0.566999
Epoch 52
Validation r2 = 0.565859
Epoch 53
Validation r2 = 0.571284
Epoch 54
Validation r2 = 0.578301
Epoch 55
Validation r2 = 0.559244
Epoch 56
Validation r2 = 0.572588
Epoch 57
Validation r2 = 0.567899
Epoch 58
Validation r2 = 0.551763
Epoch 59
Validation r2 = 0.578795
Epoch 60
Validation r2 = 0.571954
Epoch 61
Validation r2 = 0.556445
Epoch 62
Validation r2 = 0.573320
Epoch 63
Validation r2 = 0.559926
Epoch 64
Validation r2 = 0.573436
Epoch 65
Validation r2 = 0.566770
Epoch 66
Validation r2 = 0.555473
Epoch 67
Validation r2 = 0.560120
Epoch 68
Validation r2 = 0.559643
Epoch 69
Validation r2 = 0.568727
Epoch 70
Validation r2 = 0.556922
Epoch 71
Validation r2 = 0.568621
Epoch 72
Validation r2 = 0.556328
Epoch 73
Validation r2 = 0.567886
Epoch 74
Validation r2 = 0.563436
Epoch 75
Validation r2 = 0.556713
Epoch 76
Validation r2 = 0.567892
Epoch 77
Validation r2 = 0.564484
Epoch 78
Validation r2 = 0.561899
Epoch 79
Validation r2 = 0.567737
Epoch 80
Validation r2 = 0.562326
Epoch 81
Validation r2 = 0.561846
Epoch 82
Validation r2 = 0.563431
Epoch 83
Validation r2 = 0.555778
Epoch 84
Validation r2 = 0.563901
Epoch 85
Validation r2 = 0.562892
Epoch 86
Validation r2 = 0.561696
Epoch 87
Validation r2 = 0.565166
Epoch 88
Validation r2 = 0.566417
Epoch 89
Validation r2 = 0.562866
Epoch 90
Validation r2 = 0.570627
Epoch 91
Validation r2 = 0.561048
Epoch 92
Validation r2 = 0.564374
Epoch 93
Validation r2 = 0.570894
Epoch 94
Validation r2 = 0.559124
Epoch 95
Validation r2 = 0.568274
Epoch 96
Validation r2 = 0.566062
Epoch 97
Validation r2 = 0.568685
Epoch 98
Validation r2 = 0.563808
Epoch 99
Validation r2 = 0.564795
Model 1 best validation r2 = 0.602834 on epoch 45
Moving model to cuda
Model 1 test mae = 0.418762
Model 1 test mse = 0.324859
Model 1 test r2 = 0.691133
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.023203
Epoch 1
Validation r2 = 0.051684
Epoch 2
Validation r2 = 0.113769
Epoch 3
Validation r2 = 0.101088
Epoch 4
Validation r2 = 0.227597
Epoch 5
Validation r2 = 0.322492
Epoch 6
Validation r2 = 0.286194
Epoch 7
Validation r2 = 0.431146
Epoch 8
Validation r2 = 0.463986
Epoch 9
Validation r2 = 0.518307
Epoch 10
Validation r2 = 0.487474
Epoch 11
Validation r2 = 0.456867
Epoch 12
Validation r2 = 0.522253
Epoch 13
Validation r2 = 0.460803
Epoch 14
Validation r2 = 0.512020
Epoch 15
Validation r2 = 0.505614
Epoch 16
Validation r2 = 0.527911
Epoch 17
Validation r2 = 0.535303
Epoch 18
Validation r2 = 0.498628
Epoch 19
Validation r2 = 0.560378
Epoch 20
Validation r2 = 0.524853
Epoch 21
Validation r2 = 0.555277
Epoch 22
Validation r2 = 0.553585
Epoch 23
Validation r2 = 0.555450
Epoch 24
Validation r2 = 0.571690
Epoch 25
Validation r2 = 0.586175
Epoch 26
Validation r2 = 0.555613
Epoch 27
Validation r2 = 0.578164
Epoch 28
Validation r2 = 0.586084
Epoch 29
Validation r2 = 0.617949
Epoch 30
Validation r2 = 0.595236
Epoch 31
Validation r2 = 0.606325
Epoch 32
Validation r2 = 0.605722
Epoch 33
Validation r2 = 0.632772
Epoch 34
Validation r2 = 0.601075
Epoch 35
Validation r2 = 0.578595
Epoch 36
Validation r2 = 0.573542
Epoch 37
Validation r2 = 0.598285
Epoch 38
Validation r2 = 0.620371
Epoch 39
Validation r2 = 0.601120
Epoch 40
Validation r2 = 0.588215
Epoch 41
Validation r2 = 0.569858
Epoch 42
Validation r2 = 0.606369
Epoch 43
Validation r2 = 0.597139
Epoch 44
Validation r2 = 0.603224
Epoch 45
Validation r2 = 0.599005
Epoch 46
Validation r2 = 0.605377
Epoch 47
Validation r2 = 0.605652
Epoch 48
Validation r2 = 0.595519
Epoch 49
Validation r2 = 0.596349
Epoch 50
Validation r2 = 0.606756
Epoch 51
Validation r2 = 0.601706
Epoch 52
Validation r2 = 0.599384
Epoch 53
Validation r2 = 0.586052
Epoch 54
Validation r2 = 0.591904
Epoch 55
Validation r2 = 0.597485
Epoch 56
Validation r2 = 0.595577
Epoch 57
Validation r2 = 0.608130
Epoch 58
Validation r2 = 0.579631
Epoch 59
Validation r2 = 0.610350
Epoch 60
Validation r2 = 0.604202
Epoch 61
Validation r2 = 0.592409
Epoch 62
Validation r2 = 0.610752
Epoch 63
Validation r2 = 0.591048
Epoch 64
Validation r2 = 0.593210
Epoch 65
Validation r2 = 0.602158
Epoch 66
Validation r2 = 0.606428
Epoch 67
Validation r2 = 0.593882
Epoch 68
Validation r2 = 0.603807
Epoch 69
Validation r2 = 0.599213
Epoch 70
Validation r2 = 0.597728
Epoch 71
Validation r2 = 0.591920
Epoch 72
Validation r2 = 0.595385
Epoch 73
Validation r2 = 0.602555
Epoch 74
Validation r2 = 0.589918
Epoch 75
Validation r2 = 0.600332
Epoch 76
Validation r2 = 0.588591
Epoch 77
Validation r2 = 0.605410
Epoch 78
Validation r2 = 0.587545
Epoch 79
Validation r2 = 0.596085
Epoch 80
Validation r2 = 0.592391
Epoch 81
Validation r2 = 0.595034
Epoch 82
Validation r2 = 0.594572
Epoch 83
Validation r2 = 0.596753
Epoch 84
Validation r2 = 0.587603
Epoch 85
Validation r2 = 0.601419
Epoch 86
Validation r2 = 0.588639
Epoch 87
Validation r2 = 0.592504
Epoch 88
Validation r2 = 0.593456
Epoch 89
Validation r2 = 0.588496
Epoch 90
Validation r2 = 0.593637
Epoch 91
Validation r2 = 0.589460
Epoch 92
Validation r2 = 0.591865
Epoch 93
Validation r2 = 0.590800
Epoch 94
Validation r2 = 0.597007
Epoch 95
Validation r2 = 0.591401
Epoch 96
Validation r2 = 0.588150
Epoch 97
Validation r2 = 0.593691
Epoch 98
Validation r2 = 0.590249
Epoch 99
Validation r2 = 0.597440
Model 2 best validation r2 = 0.632772 on epoch 33
Moving model to cuda
Model 2 test mae = 0.421249
Model 2 test mse = 0.327973
Model 2 test r2 = 0.688173
Ensemble test mae = 0.402927
Ensemble test mse = 0.312405
Ensemble test r2 = 0.702975
1-fold cross validation
Seed 0 ==> test r2 = 0.702975
Overall test r2 = 0.702975 +/- 0.000000
