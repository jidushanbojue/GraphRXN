Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 336 | train size = 268 | val size = 68 | test size = 83
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.003715
Epoch 1
Validation r2 = -0.022846
Epoch 2
Validation r2 = 0.007336
Epoch 3
Validation r2 = 0.008582
Epoch 4
Validation r2 = 0.020416
Epoch 5
Validation r2 = -0.013146
Epoch 6
Validation r2 = 0.042875
Epoch 7
Validation r2 = 0.043052
Epoch 8
Validation r2 = -0.006070
Epoch 9
Validation r2 = 0.050883
Epoch 10
Validation r2 = 0.076924
Epoch 11
Validation r2 = 0.135681
Epoch 12
Validation r2 = 0.195769
Epoch 13
Validation r2 = 0.263279
Epoch 14
Validation r2 = 0.356030
Epoch 15
Validation r2 = 0.441638
Epoch 16
Validation r2 = 0.495928
Epoch 17
Validation r2 = 0.269586
Epoch 18
Validation r2 = 0.499568
Epoch 19
Validation r2 = 0.494745
Epoch 20
Validation r2 = 0.475335
Epoch 21
Validation r2 = 0.500292
Epoch 22
Validation r2 = 0.524206
Epoch 23
Validation r2 = 0.581026
Epoch 24
Validation r2 = 0.628733
Epoch 25
Validation r2 = 0.673128
Epoch 26
Validation r2 = 0.707820
Epoch 27
Validation r2 = 0.707103
Epoch 28
Validation r2 = 0.692516
Epoch 29
Validation r2 = 0.680157
Epoch 30
Validation r2 = 0.699302
Epoch 31
Validation r2 = 0.706995
Epoch 32
Validation r2 = 0.706707
Epoch 33
Validation r2 = 0.708292
Epoch 34
Validation r2 = 0.702018
Epoch 35
Validation r2 = 0.706637
Epoch 36
Validation r2 = 0.723751
Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 336 | train size = 268 | val size = 68 | test size = 83
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.002206
Epoch 1
Validation r2 = -0.034405
Epoch 2
Validation r2 = 0.014008
Epoch 3
Validation r2 = 0.005651
Epoch 4
Validation r2 = 0.031822
Epoch 5
Validation r2 = 0.010422
Epoch 6
Validation r2 = 0.065654
Epoch 7
Validation r2 = 0.057229
Epoch 8
Validation r2 = 0.036727
Epoch 9
Validation r2 = 0.069474
Epoch 10
Validation r2 = 0.121175
Epoch 11
Validation r2 = 0.187328
Epoch 12
Validation r2 = 0.272568
Epoch 13
Validation r2 = 0.348348
Epoch 14
Validation r2 = 0.408382
Epoch 15
Validation r2 = 0.471316
Epoch 16
Validation r2 = 0.515013
Epoch 17
Validation r2 = 0.528385
Epoch 18
Validation r2 = 0.587717
Epoch 19
Validation r2 = 0.612312
Epoch 20
Validation r2 = 0.634173
Epoch 21
Validation r2 = 0.644566
Epoch 22
Validation r2 = 0.661641
Epoch 23
Validation r2 = 0.693397
Epoch 24
Validation r2 = 0.694655
Epoch 25
Validation r2 = 0.698416
Epoch 26
Validation r2 = 0.720155
Epoch 27
Validation r2 = 0.702736
Epoch 28
Validation r2 = 0.703387
Epoch 29
Validation r2 = 0.710791
Epoch 30
Validation r2 = 0.714513
Epoch 31
Validation r2 = 0.724206
Epoch 32
Validation r2 = 0.726677
Epoch 33
Validation r2 = 0.735026
Epoch 34
Validation r2 = 0.727286
Epoch 35
Validation r2 = 0.740122
Epoch 36
Validation r2 = 0.750643
Epoch 37
Validation r2 = 0.720665
Epoch 38
Validation r2 = 0.729573
Epoch 39
Validation r2 = 0.737870
Epoch 40
Validation r2 = 0.718331
Epoch 41
Validation r2 = 0.724990
Epoch 42
Validation r2 = 0.736906
Epoch 43
Validation r2 = 0.717614
Epoch 44
Validation r2 = 0.719679
Epoch 45
Validation r2 = 0.751076
Epoch 46
Validation r2 = 0.751290
Epoch 47
Validation r2 = 0.716088
Epoch 48
Validation r2 = 0.727841
Epoch 49
Validation r2 = 0.719560
Epoch 50
Validation r2 = 0.723988
Epoch 51
Validation r2 = 0.716836
Epoch 52
Validation r2 = 0.721660
Epoch 53
Validation r2 = 0.719634
Epoch 54
Validation r2 = 0.695471
Epoch 55
Validation r2 = 0.721393
Epoch 56
Validation r2 = 0.708363
Epoch 57
Validation r2 = 0.690708
Epoch 58
Validation r2 = 0.710948
Epoch 59
Validation r2 = 0.693973
Epoch 60
Validation r2 = 0.696214
Epoch 61
Validation r2 = 0.679712
Epoch 62
Validation r2 = 0.699575
Epoch 63
Validation r2 = 0.681810
Epoch 64
Validation r2 = 0.694172
Epoch 65
Validation r2 = 0.698872
Epoch 66
Validation r2 = 0.690622
Epoch 67
Validation r2 = 0.672723
Epoch 68
Validation r2 = 0.669763
Epoch 69
Validation r2 = 0.697686
Epoch 70
Validation r2 = 0.670457
Epoch 71
Validation r2 = 0.694584
Epoch 72
Validation r2 = 0.680812
Epoch 73
Validation r2 = 0.681021
Epoch 74
Validation r2 = 0.694538
Epoch 75
Validation r2 = 0.663885
Epoch 76
Validation r2 = 0.701079
Epoch 77
Validation r2 = 0.692458
Epoch 78
Validation r2 = 0.649660
Epoch 79
Validation r2 = 0.701604
Epoch 80
Validation r2 = 0.694735
Epoch 81
Validation r2 = 0.668072
Epoch 82
Validation r2 = 0.695942
Epoch 83
Validation r2 = 0.708991
Epoch 84
Validation r2 = 0.704522
Epoch 85
Validation r2 = 0.687672
Epoch 86
Validation r2 = 0.711439
Epoch 87
Validation r2 = 0.712200
Epoch 88
Validation r2 = 0.689870
Epoch 89
Validation r2 = 0.686400
Epoch 90
Validation r2 = 0.712276
Epoch 91
Validation r2 = 0.711057
Epoch 92
Validation r2 = 0.687801
Epoch 93
Validation r2 = 0.706748
Epoch 94
Validation r2 = 0.702621
Epoch 95
Validation r2 = 0.694349
Epoch 96
Validation r2 = 0.703293
Epoch 97
Validation r2 = 0.713124
Epoch 98
Validation r2 = 0.684775
Epoch 99
Validation r2 = 0.703748
Model 0 best validation r2 = 0.751290 on epoch 46
Moving model to cuda
Model 0 test mae = 0.436493
Model 0 test mse = 0.359633
Model 0 test r2 = 0.592640
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.041070
Epoch 1
Validation r2 = -0.063631
Epoch 2
Validation r2 = 0.007301
Epoch 3
Validation r2 = -0.018216
Epoch 4
Validation r2 = 0.002421
Epoch 5
Validation r2 = 0.023932
Epoch 6
Validation r2 = 0.024334
Epoch 7
Validation r2 = 0.023610
Epoch 8
Validation r2 = 0.044700
Epoch 9
Validation r2 = 0.053607
Epoch 10
Validation r2 = 0.067588
Epoch 11
Validation r2 = 0.124703
Epoch 12
Validation r2 = 0.181767
Epoch 13
Validation r2 = 0.237631
Epoch 14
Validation r2 = 0.247996
Epoch 15
Validation r2 = 0.304135
Epoch 16
Validation r2 = 0.369369
Epoch 17
Validation r2 = 0.455188
Epoch 18
Validation r2 = 0.487780
Epoch 19
Validation r2 = 0.492433
Epoch 20
Validation r2 = 0.506158
Epoch 21
Validation r2 = 0.533357
Epoch 22
Validation r2 = 0.580227
Epoch 23
Validation r2 = 0.606622
Epoch 24
Validation r2 = 0.648718
Epoch 25
Validation r2 = 0.672425
Epoch 26
Validation r2 = 0.693681
Epoch 27
Validation r2 = 0.722185
Epoch 28
Validation r2 = 0.716621
Epoch 29
Validation r2 = 0.682848
Epoch 30
Validation r2 = 0.714787
Epoch 31
Validation r2 = 0.720997
Epoch 32
Validation r2 = 0.722791
Epoch 33
Validation r2 = 0.711346
Epoch 34
Validation r2 = 0.724160
Epoch 35
Validation r2 = 0.706979
Epoch 36
Validation r2 = 0.705595
Epoch 37
Validation r2 = 0.702527
Epoch 38
Validation r2 = 0.703243
Epoch 39
Validation r2 = 0.703700
Epoch 40
Validation r2 = 0.712721
Epoch 41
Validation r2 = 0.713775
Epoch 42
Validation r2 = 0.696179
Epoch 43
Validation r2 = 0.701895
Epoch 44
Validation r2 = 0.712740
Epoch 45
Validation r2 = 0.712576
Epoch 46
Validation r2 = 0.713678
Epoch 47
Validation r2 = 0.678409
Epoch 48
Validation r2 = 0.705476
Epoch 49
Validation r2 = 0.692477
Epoch 50
Validation r2 = 0.658980
Epoch 51
Validation r2 = 0.666744
Epoch 52
Validation r2 = 0.681115
Epoch 53
Validation r2 = 0.669988
Epoch 54
Validation r2 = 0.672774
Epoch 55
Validation r2 = 0.660085
Epoch 56
Validation r2 = 0.682477
Epoch 57
Validation r2 = 0.637661
Epoch 58
Validation r2 = 0.658218
Epoch 59
Validation r2 = 0.646272
Epoch 60
Validation r2 = 0.628832
Epoch 61
Validation r2 = 0.656103
Epoch 62
Validation r2 = 0.648585
Epoch 63
Validation r2 = 0.643060
Epoch 64
Validation r2 = 0.653798
Epoch 65
Validation r2 = 0.637532
Epoch 66
Validation r2 = 0.635905
Epoch 67
Validation r2 = 0.646685
Epoch 68
Validation r2 = 0.651193
Epoch 69
Validation r2 = 0.645668
Epoch 70
Validation r2 = 0.661255
Epoch 71
Validation r2 = 0.618791
Epoch 72
Validation r2 = 0.650076
Epoch 73
Validation r2 = 0.650877
Epoch 74
Validation r2 = 0.641848
Epoch 75
Validation r2 = 0.654831
Epoch 76
Validation r2 = 0.661967
Epoch 77
Validation r2 = 0.646641
Epoch 78
Validation r2 = 0.642771
Epoch 79
Validation r2 = 0.663498
Epoch 80
Validation r2 = 0.645586
Epoch 81
Validation r2 = 0.656604
Epoch 82
Validation r2 = 0.646427
Epoch 83
Validation r2 = 0.668220
Epoch 84
Validation r2 = 0.630065
Epoch 85
Validation r2 = 0.666050
Epoch 86
Validation r2 = 0.650884
Epoch 87
Validation r2 = 0.656961
Epoch 88
Validation r2 = 0.660228
Epoch 89
Validation r2 = 0.661879
Epoch 90
Validation r2 = 0.658575
Epoch 91
Validation r2 = 0.655482
Epoch 92
Validation r2 = 0.671513
Epoch 93
Validation r2 = 0.659755
Epoch 94
Validation r2 = 0.655380
Epoch 95
Validation r2 = 0.664716
Epoch 96
Validation r2 = 0.673725
Epoch 97
Validation r2 = 0.658860
Epoch 98
Validation r2 = 0.655207
Epoch 99
Validation r2 = 0.675701
Model 1 best validation r2 = 0.724160 on epoch 34
Moving model to cuda
Model 1 test mae = 0.470308
Model 1 test mse = 0.372748
Model 1 test r2 = 0.577784
Building model 2
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = -0.008150
Epoch 1
Validation r2 = -0.036499
Epoch 2
Validation r2 = 0.004948
Epoch 3
Validation r2 = -0.049689
Epoch 4
Validation r2 = 0.010894
Epoch 5
Validation r2 = 0.017317
Epoch 6
Validation r2 = 0.001263
Epoch 7
Validation r2 = 0.028522
Epoch 8
Validation r2 = 0.047764
Epoch 9
Validation r2 = 0.061423
Epoch 10
Validation r2 = 0.045093
Epoch 11
Validation r2 = 0.094856
Epoch 12
Validation r2 = 0.104044
Epoch 13
Validation r2 = 0.083531
Epoch 14
Validation r2 = 0.140113
Epoch 15
Validation r2 = 0.156176
Epoch 16
Validation r2 = 0.193305
Epoch 17
Validation r2 = 0.213254
Epoch 18
Validation r2 = 0.266766
Epoch 19
Validation r2 = 0.314995
Epoch 20
Validation r2 = 0.349212
Epoch 21
Validation r2 = 0.354296
Epoch 22
Validation r2 = 0.425079
Epoch 23
Validation r2 = 0.463564
Epoch 24
Validation r2 = 0.429577
Epoch 25
Validation r2 = 0.488632
Epoch 26
Validation r2 = 0.513811
Epoch 27
Validation r2 = 0.484969
Epoch 28
Validation r2 = 0.554037
Epoch 29
Validation r2 = 0.573126
Epoch 30
Validation r2 = 0.620405
Epoch 31
Validation r2 = 0.626279
Epoch 32
Validation r2 = 0.662287
Epoch 33
Validation r2 = 0.673283
Epoch 34
Validation r2 = 0.668399
Epoch 35
Validation r2 = 0.675253
Epoch 36
Validation r2 = 0.694698
Epoch 37
Validation r2 = 0.689242
Epoch 38
Validation r2 = 0.684433
Epoch 39
Validation r2 = 0.707555
Epoch 40
Validation r2 = 0.707367
Epoch 41
Validation r2 = 0.703031
Epoch 42
Validation r2 = 0.703764
Epoch 43
Validation r2 = 0.713686
Epoch 44
Validation r2 = 0.711462
Epoch 45
Validation r2 = 0.704234
Epoch 46
Validation r2 = 0.706574
Epoch 47
Validation r2 = 0.712480
Epoch 48
Validation r2 = 0.708639
Epoch 49
Validation r2 = 0.723074
Epoch 50
Validation r2 = 0.711737
Epoch 51
Validation r2 = 0.707001
Epoch 52
Validation r2 = 0.725120
Epoch 53
Validation r2 = 0.705186
Epoch 54
Validation r2 = 0.710351
Epoch 55
Validation r2 = 0.704283
Epoch 56
Validation r2 = 0.673865
Epoch 57
Validation r2 = 0.688082
Epoch 58
Validation r2 = 0.697504
Epoch 59
Validation r2 = 0.692394
Epoch 60
Validation r2 = 0.702480
Epoch 61
Validation r2 = 0.685866
Epoch 62
Validation r2 = 0.679541
Epoch 63
Validation r2 = 0.677937
Epoch 64
Validation r2 = 0.665396
Epoch 65
Validation r2 = 0.678118
Epoch 66
Validation r2 = 0.673087
Epoch 67
Validation r2 = 0.663521
Epoch 68
Validation r2 = 0.669975
Epoch 69
Validation r2 = 0.652577
Epoch 70
Validation r2 = 0.666482
Epoch 71
Validation r2 = 0.655076
Epoch 72
Validation r2 = 0.662295
Epoch 73
Validation r2 = 0.654885
Epoch 74
Validation r2 = 0.642498
Epoch 75
Validation r2 = 0.656050
Epoch 76
Validation r2 = 0.644256
Epoch 77
Validation r2 = 0.655720
Epoch 78
Validation r2 = 0.637869
Epoch 79
Validation r2 = 0.646098
Epoch 80
Validation r2 = 0.638635
Epoch 81
Validation r2 = 0.628328
Epoch 82
Validation r2 = 0.644167
Epoch 83
Validation r2 = 0.609319
Epoch 84
Validation r2 = 0.652248
Epoch 85
Validation r2 = 0.634836
Epoch 86
Validation r2 = 0.645935
Epoch 87
Validation r2 = 0.651492
Epoch 88
Validation r2 = 0.636266
Epoch 89
Validation r2 = 0.656424
Epoch 90
Validation r2 = 0.651285
Epoch 91
Validation r2 = 0.624579
Epoch 92
Validation r2 = 0.647978
Epoch 93
Validation r2 = 0.639007
Epoch 94
Validation r2 = 0.642306
Epoch 95
Validation r2 = 0.651275
Epoch 96
Validation r2 = 0.634627
Epoch 97
Validation r2 = 0.649299
Epoch 98
Validation r2 = 0.651241
Epoch 99
Validation r2 = 0.629825
Model 2 best validation r2 = 0.725120 on epoch 52
Moving model to cuda
Model 2 test mae = 0.458908
Model 2 test mse = 0.385075
Model 2 test r2 = 0.563822
Ensemble test mae = 0.451440
Ensemble test mse = 0.362981
Ensemble test r2 = 0.588847
1-fold cross validation
Seed 0 ==> test r2 = 0.588847
Overall test r2 = 0.588847 +/- 0.000000
