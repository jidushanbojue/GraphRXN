Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 601 | train size = 480 | val size = 121 | test size = 474
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation r2 = -0.356093
Epoch 1
Validation r2 = 0.096207
Epoch 2
Validation r2 = 0.194459
Epoch 3
Validation r2 = 0.230726
Epoch 4
Validation r2 = 0.215710
Epoch 5
Validation r2 = 0.244473
Epoch 6
Validation r2 = 0.262005
Epoch 7
Validation r2 = 0.251213
Epoch 8
Validation r2 = 0.297493
Epoch 9
Validation r2 = 0.263994
Epoch 10
Validation r2 = 0.313107
Epoch 11
Validation r2 = 0.329080
Epoch 12
Validation r2 = 0.337177
Epoch 13
Validation r2 = 0.393725
Epoch 14
Validation r2 = 0.367868
Epoch 15
Validation r2 = 0.450893
Epoch 16
Validation r2 = 0.508709
Epoch 17
Validation r2 = 0.520629
Epoch 18
Validation r2 = 0.572449
Epoch 19
Validation r2 = 0.646570
Epoch 20
Validation r2 = 0.664253
Epoch 21
Validation r2 = 0.708642
Epoch 22
Validation r2 = 0.725929
Epoch 23
Validation r2 = 0.775287
Epoch 24
Validation r2 = 0.794013
Epoch 25
Validation r2 = 0.803718
Epoch 26
Validation r2 = 0.656422
Epoch 27
Validation r2 = 0.793471
Epoch 28
Validation r2 = 0.784283
Epoch 29
Validation r2 = 0.690879
Epoch 30
Validation r2 = 0.804539
Epoch 31
Validation r2 = 0.805962
Epoch 32
Validation r2 = 0.790453
Epoch 33
Validation r2 = 0.818968
Epoch 34
Validation r2 = 0.796899
Epoch 35
Validation r2 = 0.825669
Epoch 36
Validation r2 = 0.834782
Epoch 37
Validation r2 = 0.841297
Epoch 38
Validation r2 = 0.855364
Epoch 39
Validation r2 = 0.790172
Epoch 40
Validation r2 = 0.856913
Epoch 41
Validation r2 = 0.828666
Epoch 42
Validation r2 = 0.870144
Epoch 43
Validation r2 = 0.866052
Epoch 44
Validation r2 = 0.861575
Epoch 45
Validation r2 = 0.874879
Epoch 46
Validation r2 = 0.869441
Epoch 47
Validation r2 = 0.860040
Epoch 48
Validation r2 = 0.872952
Epoch 49
Validation r2 = 0.877972
Epoch 50
Validation r2 = 0.848928
Epoch 51
Validation r2 = 0.867686
Epoch 52
Validation r2 = 0.835714
Epoch 53
Validation r2 = 0.867869
Epoch 54
Validation r2 = 0.847084
Epoch 55
Validation r2 = 0.877139
Epoch 56
Validation r2 = 0.873065
Epoch 57
Validation r2 = 0.883125
Epoch 58
Validation r2 = 0.880918
Epoch 59
Validation r2 = 0.883769
Epoch 60
Validation r2 = 0.877086
Epoch 61
Validation r2 = 0.881270
Epoch 62
Validation r2 = 0.876131
Epoch 63
Validation r2 = 0.883427
Epoch 64
Validation r2 = 0.878104
Epoch 65
Validation r2 = 0.878174
Epoch 66
Validation r2 = 0.886664
Epoch 67
Validation r2 = 0.883441
Epoch 68
Validation r2 = 0.886628
Epoch 69
Validation r2 = 0.882183
Epoch 70
Validation r2 = 0.885153
Epoch 71
Validation r2 = 0.881536
Epoch 72
Validation r2 = 0.887054
Epoch 73
Validation r2 = 0.880369
Epoch 74
Validation r2 = 0.889172
Epoch 75
Validation r2 = 0.874935
Epoch 76
Validation r2 = 0.889611
Epoch 77
Validation r2 = 0.880587
Epoch 78
Validation r2 = 0.885432
Epoch 79
Validation r2 = 0.885787
Epoch 80
Validation r2 = 0.862453
Epoch 81
Validation r2 = 0.879680
Epoch 82
Validation r2 = 0.858691
Epoch 83
Validation r2 = 0.884908
Epoch 84
Validation r2 = 0.878411
Epoch 85
Validation r2 = 0.886800
Epoch 86
Validation r2 = 0.890729
Epoch 87
Validation r2 = 0.884424
Epoch 88
Validation r2 = 0.891926
Epoch 89
Validation r2 = 0.888616
Epoch 90
Validation r2 = 0.891530
Epoch 91
Validation r2 = 0.891405
Epoch 92
Validation r2 = 0.882992
Epoch 93
Validation r2 = 0.890175
Epoch 94
Validation r2 = 0.882960
Epoch 95
Validation r2 = 0.887114
Epoch 96
Validation r2 = 0.891281
Epoch 97
Validation r2 = 0.886388
Epoch 98
Validation r2 = 0.889973
Epoch 99
Validation r2 = 0.893026
Model 0 best validation r2 = 0.893026 on epoch 99
Moving model to cuda
Model 0 test mae = 0.170647
Model 0 test mse = 0.054901
Model 0 test r2 = 0.880051
Ensemble test mae = 0.170647
Ensemble test mse = 0.054901
Ensemble test r2 = 0.880051
1-fold cross validation
Seed 0 ==> test r2 = 0.880051
Overall test r2 = 0.880051 +/- 0.000000
