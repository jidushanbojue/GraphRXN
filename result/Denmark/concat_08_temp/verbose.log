Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 601 | train size = 480 | val size = 121 | test size = 474
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.164880
Epoch 1
Validation r2 = 0.259759
Epoch 2
Validation r2 = 0.203308
Epoch 3
Validation r2 = 0.405919
Epoch 4
Validation r2 = 0.558537
Epoch 5
Validation r2 = 0.423012
Epoch 6
Validation r2 = 0.504427
Epoch 7
Validation r2 = 0.591709
Epoch 8
Validation r2 = 0.689060
Epoch 9
Validation r2 = 0.763080
Epoch 10
Validation r2 = 0.760553
Epoch 11
Validation r2 = 0.798970
Epoch 12
Validation r2 = 0.790123
Epoch 13
Validation r2 = 0.792085
Epoch 14
Validation r2 = 0.809913
Epoch 15
Validation r2 = 0.845231
Epoch 16
Validation r2 = 0.847306
Epoch 17
Validation r2 = 0.851004
Epoch 18
Validation r2 = 0.853794
Epoch 19
Validation r2 = 0.860711
Epoch 20
Validation r2 = 0.861585
Epoch 21
Validation r2 = 0.854768
Epoch 22
Validation r2 = 0.875372
Epoch 23
Validation r2 = 0.835945
Epoch 24
Validation r2 = 0.876213
Epoch 25
Validation r2 = 0.878963
Epoch 26
Validation r2 = 0.854794
Epoch 27
Validation r2 = 0.863559
Epoch 28
Validation r2 = 0.850229
Epoch 29
Validation r2 = 0.881633
Epoch 30
Validation r2 = 0.886614
Epoch 31
Validation r2 = 0.873973
Epoch 32
Validation r2 = 0.887962
Epoch 33
Validation r2 = 0.884989
Epoch 34
Validation r2 = 0.885517
Epoch 35
Validation r2 = 0.886478
Epoch 36
Validation r2 = 0.887311
Epoch 37
Validation r2 = 0.886549
Epoch 38
Validation r2 = 0.892936
Epoch 39
Validation r2 = 0.880119
Epoch 40
Validation r2 = 0.890914
Epoch 41
Validation r2 = 0.881759
Epoch 42
Validation r2 = 0.881327
Epoch 43
Validation r2 = 0.880305
Epoch 44
Validation r2 = 0.892009
Epoch 45
Validation r2 = 0.880933
Epoch 46
Validation r2 = 0.876315
Epoch 47
Validation r2 = 0.895834
Epoch 48
Validation r2 = 0.893572
Epoch 49
Validation r2 = 0.893857
Epoch 50
Validation r2 = 0.880201
Epoch 51
Validation r2 = 0.884490
Epoch 52
Validation r2 = 0.888757
Epoch 53
Validation r2 = 0.892190
Epoch 54
Validation r2 = 0.889057
Epoch 55
Validation r2 = 0.887665
Epoch 56
Validation r2 = 0.895384
Epoch 57
Validation r2 = 0.887969
Epoch 58
Validation r2 = 0.894930
Epoch 59
Validation r2 = 0.887504
Epoch 60
Validation r2 = 0.888417
Epoch 61
Validation r2 = 0.889047
Epoch 62
Validation r2 = 0.891062
Epoch 63
Validation r2 = 0.892916
Epoch 64
Validation r2 = 0.889565
Epoch 65
Validation r2 = 0.893540
Epoch 66
Validation r2 = 0.896588
Epoch 67
Validation r2 = 0.889587
Epoch 68
Validation r2 = 0.894181
Epoch 69
Validation r2 = 0.892325
Epoch 70
Validation r2 = 0.890073
Epoch 71
Validation r2 = 0.891976
Epoch 72
Validation r2 = 0.895244
Epoch 73
Validation r2 = 0.892749
Epoch 74
Validation r2 = 0.888470
Epoch 75
Validation r2 = 0.893802
Epoch 76
Validation r2 = 0.888549
Epoch 77
Validation r2 = 0.889792
Epoch 78
Validation r2 = 0.884296
Epoch 79
Validation r2 = 0.890404
Epoch 80
Validation r2 = 0.881824
Epoch 81
Validation r2 = 0.888933
Epoch 82
Validation r2 = 0.889067
Epoch 83
Validation r2 = 0.893161
Epoch 84
Validation r2 = 0.891160
Epoch 85
Validation r2 = 0.889417
Epoch 86
Validation r2 = 0.895631
Epoch 87
Validation r2 = 0.896845
Epoch 88
Validation r2 = 0.891887
Epoch 89
Validation r2 = 0.888572
Epoch 90
Validation r2 = 0.891529
Epoch 91
Validation r2 = 0.892666
Epoch 92
Validation r2 = 0.891319
Epoch 93
Validation r2 = 0.890413
Epoch 94
Validation r2 = 0.891927
Epoch 95
Validation r2 = 0.890465
Epoch 96
Validation r2 = 0.894224
Epoch 97
Validation r2 = 0.893562
Epoch 98
Validation r2 = 0.889885
Epoch 99
Validation r2 = 0.897901
Model 0 best validation r2 = 0.897901 on epoch 99
Moving model to cuda
Model 0 test mae = 0.160448
Model 0 test mse = 0.050304
Model 0 test r2 = 0.890094
Ensemble test mae = 0.160448
Ensemble test mse = 0.050304
Ensemble test r2 = 0.890094
1-fold cross validation
Seed 0 ==> test r2 = 0.890094
Overall test r2 = 0.890094 +/- 0.000000
