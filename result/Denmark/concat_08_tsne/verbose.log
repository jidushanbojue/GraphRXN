Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 601 | train size = 480 | val size = 121 | test size = 474
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.083517
Epoch 1
Validation r2 = 0.215794
Epoch 2
Validation r2 = 0.252416
Epoch 3
Validation r2 = 0.241341
Epoch 4
Validation r2 = 0.335552
Epoch 5
Validation r2 = 0.488705
Epoch 6
Validation r2 = 0.516201
Epoch 7
Validation r2 = 0.624938
Epoch 8
Validation r2 = 0.718295
Epoch 9
Validation r2 = 0.709604
Epoch 10
Validation r2 = 0.777319
Epoch 11
Validation r2 = 0.811196
Epoch 12
Validation r2 = 0.817474
Epoch 13
Validation r2 = 0.828645
Epoch 14
Validation r2 = 0.809389
Epoch 15
Validation r2 = 0.859017
Epoch 16
Validation r2 = 0.836826
Epoch 17
Validation r2 = 0.833572
Epoch 18
Validation r2 = 0.863219
Epoch 19
Validation r2 = 0.859262
Epoch 20
Validation r2 = 0.858932
Epoch 21
Validation r2 = 0.867594
Epoch 22
Validation r2 = 0.874802
Epoch 23
Validation r2 = 0.822024
Epoch 24
Validation r2 = 0.848255
Epoch 25
Validation r2 = 0.868121
Epoch 26
Validation r2 = 0.868457
Epoch 27
Validation r2 = 0.868531
Epoch 28
Validation r2 = 0.868220
Epoch 29
Validation r2 = 0.854776
Epoch 30
Validation r2 = 0.870815
Epoch 31
Validation r2 = 0.860314
Epoch 32
Validation r2 = 0.860790
Epoch 33
Validation r2 = 0.863835
Epoch 34
Validation r2 = 0.841182
Epoch 35
Validation r2 = 0.864203
Epoch 36
Validation r2 = 0.867886
Epoch 37
Validation r2 = 0.872127
Epoch 38
Validation r2 = 0.878119
Epoch 39
Validation r2 = 0.866323
Epoch 40
Validation r2 = 0.868593
Epoch 41
Validation r2 = 0.873455
Epoch 42
Validation r2 = 0.865078
Epoch 43
Validation r2 = 0.875296
Epoch 44
Validation r2 = 0.869216
Epoch 45
Validation r2 = 0.882329
Epoch 46
Validation r2 = 0.854994
Epoch 47
Validation r2 = 0.880086
Epoch 48
Validation r2 = 0.864992
Epoch 49
Validation r2 = 0.882602
Epoch 50
Validation r2 = 0.870665
Epoch 51
Validation r2 = 0.870870
Epoch 52
Validation r2 = 0.884455
Epoch 53
Validation r2 = 0.868085
Epoch 54
Validation r2 = 0.879919
Epoch 55
Validation r2 = 0.872991
Epoch 56
Validation r2 = 0.886937
Epoch 57
Validation r2 = 0.882573
Epoch 58
Validation r2 = 0.885592
Epoch 59
Validation r2 = 0.884127
Epoch 60
Validation r2 = 0.876755
Epoch 61
Validation r2 = 0.881572
Epoch 62
Validation r2 = 0.883241
Epoch 63
Validation r2 = 0.888120
Epoch 64
Validation r2 = 0.883875
Epoch 65
Validation r2 = 0.882267
Epoch 66
Validation r2 = 0.888447
Epoch 67
Validation r2 = 0.882526
Epoch 68
Validation r2 = 0.889426
Epoch 69
Validation r2 = 0.889361
Epoch 70
Validation r2 = 0.885843
Epoch 71
Validation r2 = 0.887367
Epoch 72
Validation r2 = 0.890549
Epoch 73
Validation r2 = 0.889313
Epoch 74
Validation r2 = 0.885300
Epoch 75
Validation r2 = 0.888573
Epoch 76
Validation r2 = 0.883594
Epoch 77
Validation r2 = 0.887058
Epoch 78
Validation r2 = 0.882298
Epoch 79
Validation r2 = 0.888390
Epoch 80
Validation r2 = 0.879617
Epoch 81
Validation r2 = 0.889272
Epoch 82
Validation r2 = 0.888121
Epoch 83
Validation r2 = 0.889701
Epoch 84
Validation r2 = 0.888477
Epoch 85
Validation r2 = 0.886502
Epoch 86
Validation r2 = 0.892354
Epoch 87
Validation r2 = 0.893863
Epoch 88
Validation r2 = 0.888688
Epoch 89
Validation r2 = 0.885819
Epoch 90
Validation r2 = 0.890697
Epoch 91
Validation r2 = 0.890325
Epoch 92
Validation r2 = 0.888288
Epoch 93
Validation r2 = 0.889377
Epoch 94
Validation r2 = 0.890863
Epoch 95
Validation r2 = 0.888535
Epoch 96
Validation r2 = 0.892934
Epoch 97
Validation r2 = 0.890887
Epoch 98
Validation r2 = 0.887802
Epoch 99
Validation r2 = 0.896109
Model 0 best validation r2 = 0.896109 on epoch 99
Moving model to cuda
Model 0 test mae = 0.160695
Model 0 test mse = 0.049302
Model 0 test r2 = 0.892283
Ensemble test mae = 0.160695
Ensemble test mse = 0.049302
Ensemble test r2 = 0.892283
1-fold cross validation
Seed 0 ==> test r2 = 0.892283
Overall test r2 = 0.892283 +/- 0.000000
