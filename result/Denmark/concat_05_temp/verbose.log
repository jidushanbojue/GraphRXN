Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 601 | train size = 480 | val size = 121 | test size = 474
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=900, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,202,901
Moving model to cuda
Epoch 0
Validation r2 = 0.226623
Epoch 1
Validation r2 = 0.273426
Epoch 2
Validation r2 = 0.329799
Epoch 3
Validation r2 = 0.424121
Epoch 4
Validation r2 = 0.460643
Epoch 5
Validation r2 = 0.509505
Epoch 6
Validation r2 = 0.619666
Epoch 7
Validation r2 = 0.668928
Epoch 8
Validation r2 = 0.662354
Epoch 9
Validation r2 = 0.714828
Epoch 10
Validation r2 = 0.733875
Epoch 11
Validation r2 = 0.751294
Epoch 12
Validation r2 = 0.789716
Epoch 13
Validation r2 = 0.794437
Epoch 14
Validation r2 = 0.819461
Epoch 15
Validation r2 = 0.830120
Epoch 16
Validation r2 = 0.834612
Epoch 17
Validation r2 = 0.841981
Epoch 18
Validation r2 = 0.846478
Epoch 19
Validation r2 = 0.852308
Epoch 20
Validation r2 = 0.865483
Epoch 21
Validation r2 = 0.851860
Epoch 22
Validation r2 = 0.870261
Epoch 23
Validation r2 = 0.864705
Epoch 24
Validation r2 = 0.872366
Epoch 25
Validation r2 = 0.877361
Epoch 26
Validation r2 = 0.874768
Epoch 27
Validation r2 = 0.880063
Epoch 28
Validation r2 = 0.874813
Epoch 29
Validation r2 = 0.876641
Epoch 30
Validation r2 = 0.885028
Epoch 31
Validation r2 = 0.880493
Epoch 32
Validation r2 = 0.885429
Epoch 33
Validation r2 = 0.860101
Epoch 34
Validation r2 = 0.879229
Epoch 35
Validation r2 = 0.883424
Epoch 36
Validation r2 = 0.877810
Epoch 37
Validation r2 = 0.888105
Epoch 38
Validation r2 = 0.876297
Epoch 39
Validation r2 = 0.886626
Epoch 40
Validation r2 = 0.874035
Epoch 41
Validation r2 = 0.884155
Epoch 42
Validation r2 = 0.867030
Epoch 43
Validation r2 = 0.876310
Epoch 44
Validation r2 = 0.869087
Epoch 45
Validation r2 = 0.880928
Epoch 46
Validation r2 = 0.884443
Epoch 47
Validation r2 = 0.882650
Epoch 48
Validation r2 = 0.881423
Epoch 49
Validation r2 = 0.891197
Epoch 50
Validation r2 = 0.873923
Epoch 51
Validation r2 = 0.891500
Epoch 52
Validation r2 = 0.891041
Epoch 53
Validation r2 = 0.882111
Epoch 54
Validation r2 = 0.889157
Epoch 55
Validation r2 = 0.891275
Epoch 56
Validation r2 = 0.882952
Epoch 57
Validation r2 = 0.888673
Epoch 58
Validation r2 = 0.882904
Epoch 59
Validation r2 = 0.891015
Epoch 60
Validation r2 = 0.887727
Epoch 61
Validation r2 = 0.891054
Epoch 62
Validation r2 = 0.889181
Epoch 63
Validation r2 = 0.892692
Epoch 64
Validation r2 = 0.890116
Epoch 65
Validation r2 = 0.882661
Epoch 66
Validation r2 = 0.892191
Epoch 67
Validation r2 = 0.887158
Epoch 68
Validation r2 = 0.885740
Epoch 69
Validation r2 = 0.891035
Epoch 70
Validation r2 = 0.881020
Epoch 71
Validation r2 = 0.889897
Epoch 72
Validation r2 = 0.889900
Epoch 73
Validation r2 = 0.882029
Epoch 74
Validation r2 = 0.890050
Epoch 75
Validation r2 = 0.888549
Epoch 76
Validation r2 = 0.890165
Epoch 77
Validation r2 = 0.887176
Epoch 78
Validation r2 = 0.892019
Epoch 79
Validation r2 = 0.891606
Epoch 80
Validation r2 = 0.891678
Epoch 81
Validation r2 = 0.892146
Epoch 82
Validation r2 = 0.887407
Epoch 83
Validation r2 = 0.888243
Epoch 84
Validation r2 = 0.890832
Epoch 85
Validation r2 = 0.887943
Epoch 86
Validation r2 = 0.887685
Epoch 87
Validation r2 = 0.888535
Epoch 88
Validation r2 = 0.886045
Epoch 89
Validation r2 = 0.891294
Epoch 90
Validation r2 = 0.889670
Epoch 91
Validation r2 = 0.887496
Epoch 92
Validation r2 = 0.890908
Epoch 93
Validation r2 = 0.889961
Epoch 94
Validation r2 = 0.892978
Epoch 95
Validation r2 = 0.891663
Epoch 96
Validation r2 = 0.886374
Epoch 97
Validation r2 = 0.889944
Epoch 98
Validation r2 = 0.890885
Epoch 99
Validation r2 = 0.887788
Model 0 best validation r2 = 0.892978 on epoch 94
Moving model to cuda
Model 0 test mae = 0.164374
Model 0 test mse = 0.054764
Model 0 test r2 = 0.880002
Ensemble test mae = 0.164374
Ensemble test mse = 0.054764
Ensemble test r2 = 0.880002
1-fold cross validation
Seed 0 ==> test r2 = 0.880002
Overall test r2 = 0.880002 +/- 0.000000
